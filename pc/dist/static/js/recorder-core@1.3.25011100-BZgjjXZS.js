import{h as Re}from"./dayjs@1.11.13-BIiDHjGT.js";var Ce={exports:{}};(function(oe){(function(le){var W1=typeof window=="object"&&!!window.document,q1=W1?window:Object;(function(a1,S1){var J1=function(){},l1=function(n){return typeof n=="number"},i1=function(n){return JSON.stringify(n)},G=function(n){return new w1(n)},T1=G.LM="2025-01-11 09:28",H1="https://github.com/xiangyuecn/Recorder",d1="Recorder",R1="getUserMedia",N1="srcSampleRate",o1="sampleRate",v1="bitRate",A1="catch",k1=a1[d1];if(k1&&k1.LM==T1)return k1.CLog(k1.i18n.$T("K8zP::重复导入{1}",0,d1),3);G.IsOpen=function(){var n=G.Stream;if(n){var o=m1(n),r=o[0];if(r){var p=r.readyState;return p=="live"||p==r.LIVE}}return!1},G.BufferSize=4096,G.Destroy=function(){for(var n in n1(d1+" Destroy"),M1(),Y)Y[n]()};var Y={};G.BindDestroy=function(n,o){Y[n]=o},G.Support=function(){if(!S1)return!1;var n=navigator.mediaDevices||{};return n[R1]||(n=navigator)[R1]||(n[R1]=n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia),!!n[R1]&&(G.Scope=n,!!G.GetContext())},G.GetContext=function(n){if(!S1)return null;var o=window.AudioContext;if(o||(o=window.webkitAudioContext),!o)return null;var r=G.Ctx,p=0;return r||(r=G.Ctx=new o,p=1,G.NewCtxs=G.NewCtxs||[],G.BindDestroy("Ctx",function(){var s=G.Ctx;s&&s.close&&(r1(s),G.Ctx=0);var g=G.NewCtxs;G.NewCtxs=[];for(var A=0;A<g.length;A++)r1(g[A])})),n&&r.close&&(p||(r._useC||r1(r),r=new o),r._useC=1,G.NewCtxs.push(r)),r},G.CloseNewCtx=function(n){if(n&&n.close){r1(n);for(var o=G.NewCtxs||[],r=o.length,p=0;p<o.length;p++)if(o[p]==n){o.splice(p,1);break}n1(C("mSxV::剩{1}个GetContext未close",0,r+"-1="+o.length),o.length?3:0)}};var r1=function(n){if(n&&n.close&&!n._isC&&(n._isC=1,n.state!="closed"))try{n.close()}catch(o){n1("ctx close err",1,o)}},u1=G.ResumeCtx=function(n,o,r,p){var s=0,g=0,A=0,q=0,O="EventListener",L="ResumeCtx ",k=function(l,i){g&&t(),s||(s=1,l&&p(l,q),i&&r(q)),i&&(!n._LsSC&&n["add"+O]&&n["add"+O]("statechange",e),n._LsSC=1,A=1)},t=function(l){if(!l||!g){g=l?1:0;for(var i=["focus","mousedown","mouseup","touchstart","touchend"],a=0;a<i.length;a++)window[(l?"add":"remove")+O](i[a],e,!0)}},e=function(){var l=n.state,i=h1(l);if(!s&&!o(i?++q:q))return k();i?(A&&n1(L+"sc "+l,3),t(1),n.resume().then(function(){A&&n1(L+"sc "+n.state),k(0,1)})[A1](function(a){n1(L+"error",1,a),h1(n.state)||k(a.message||"error")})):l=="closed"?(A&&!n._isC&&n1(L+"sc "+l,1),k("ctx closed")):k(0,1)};e()},h1=G.CtxSpEnd=function(n){return n=="suspended"||n=="interrupted"},g1=function(n){var o=n.state,r="ctx.state="+o;return h1(o)&&(r+=C("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),r},b1="ConnectEnableWebM";G[b1]=!0;var s1="ConnectEnableWorklet";G[s1]=!1;var X=function(n){var o=n.BufferSize||G.BufferSize,r=n.Stream,p=r._c,s=p[o1],g={},A=m1(r),q=A[0],O=null,L="";if(q&&q.getSettings){var k=(O=q.getSettings())[o1];k&&k!=s&&(L=C("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,k,s))}r._ts=O,n1(L+"Stream TrackSet: "+i1(O),L?3:0);var t,e,l,i=function(P){var I=r._m=p.createMediaStreamSource(r),y=p.destination,w="createMediaStreamDestination";p[w]&&(y=r._d=p[w]()),I.connect(P),P.connect(y)},a="",_=r._call,v=function(P,I){for(var y in _){if(I!=s){g.index=0;var w=(g=G.SampleData([P],I,s,g,{_sum:1})).data,x=g._sum}else{g={};for(var D=P.length,w=new Int16Array(D),x=0,N=0;N<D;N++){var B=Math.max(-1,Math.min(1,P[N]));B=B<0?32768*B:32767*B,w[N]=B,x+=Math.abs(B)}}for(var E in _)_[E](w,x);return}},u="ScriptProcessor",c="audioWorklet",b=d1+" "+c,h="RecProc",d="MediaRecorder",m=d+".WebM.PCM",f=p.createScriptProcessor||p.createJavaScriptNode,S=C("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,c),T=function(){e=r.isWorklet=!1,L1(r),n1(C("7TU0::Connect采用老的{1}，",0,u)+j.get(C(G[s1]?"JwCL::但已设置{1}尝试启用{2}":"VGjB::可设置{1}尝试启用{2}",2),[d1+"."+s1+"=true",c])+a+S,3);var P=r._p=f.call(p,o,1,1);i(P),P.onaudioprocess=function(I){var y=I.inputBuffer.getChannelData(0);v(y,s)}},R=function(){t=r.isWebM=!1,y1(r),e=r.isWorklet=!f||G[s1];var P=window.AudioWorkletNode;if(e&&p[c]&&P){var I=function(){return e&&r._na},y=r._na=function(){l!==""&&(clearTimeout(l),l=setTimeout(function(){l=0,I()&&(n1(C("MxX1::{1}未返回任何音频，恢复使用{2}",0,c,u),3),f&&T())},500))},w=function(){if(I()){var D=r._n=new P(p,h,{processorOptions:{bufferSize:o}});i(D),D.port.onmessage=function(N){l&&(clearTimeout(l),l=""),I()?v(N.data.val,s):e||n1(C("XUap::{1}多余回调",0,c),3)},n1(C("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,c,d1+"."+s1+"=false",u)+a+S,3)}},x=function(){if(I())if(p[h])w();else{var D,N,B=(N="class "+h+" extends AudioWorkletProcessor{",N+="constructor "+(D=function(E){return E.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,b)})(function(E){DEL_super(E);var H=this,F=E.processorOptions.bufferSize;H.bufferSize=F,H.buffer=new Float32Array(2*F),H.pos=0,H.port.onmessage=function(z){z.data.kill&&(H.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",E)}),N+="process "+D(function(E,H,F){var z=this,K=z.bufferSize,U=z.buffer,J=z.pos;if((E=(E[0]||[])[0]||[]).length){U.set(E,J);var Z=~~((J+=E.length)/K)*K;if(Z){this.port.postMessage({val:U.slice(0,Z)});var e1=U.subarray(Z,J);(U=new Float32Array(2*K)).set(e1),J=e1.length,z.buffer=U}z.pos=J}return!z.kill}),N=(N+='}try{registerProcessor("'+h+'", '+h+')}catch(e){$C.error("'+b+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(N))));p[c].addModule(B).then(function(E){I()&&(p[h]=1,w(),l&&y())})[A1](function(E){n1(c+".addModule Error",1,E),I()&&T()})}};u1(p,function(){return I()},x,x)}else T()};(function(){var P=window[d],I="ondataavailable",y="audio/webm; codecs=pcm";t=r.isWebM=G[b1];var w=P&&I in P.prototype&&P.isTypeSupported(y);if(a=w?"":C("VwPd::（此浏览器不支持{1}）",0,m),!t||!w)return R();var x=function(){return t&&r._ra};r._ra=function(){l!==""&&(clearTimeout(l),l=setTimeout(function(){x()&&(n1(C("vHnb::{1}未返回任何音频，降级使用{2}",0,d,c),3),R())},500))};var D=Object.assign({mimeType:y},G.ConnectWebMOptions),N=r._r=new P(r,D),B=r._rd={};N[I]=function(E){var H=new FileReader;H.onloadend=function(){if(x()){var F=C1(new Uint8Array(H.result),B);if(!F)return;if(F==-1)return void R();l&&(clearTimeout(l),l=""),v(F,B.webmSR)}else t||n1(C("O9P7::{1}多余回调",0,d),3)},H.readAsArrayBuffer(E.data)};try{N.start(~~(o/48)),n1(C("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,m,d1+"."+b1+"=false",c,u))}catch(E){n1("mr start err",1,E),R()}})()},E1=function(n){n._na&&n._na(),n._ra&&n._ra()},L1=function(n){n._na=null,n._n&&(n._n.port.postMessage({kill:!0}),n._n.disconnect(),n._n=null)},y1=function(n){if(n._ra=null,n._r){try{n._r.stop()}catch(o){n1("mr stop err",1,o)}n._r=null}},M1=function(n){var o=(n=n||G)==G,r=n.Stream;r&&(r._m&&(r._m.disconnect(),r._m=null),!r._RC&&r._c&&G.CloseNewCtx(r._c),r._RC=null,r._c=null,r._d&&(I1(r._d.stream),r._d=null),r._p&&(r._p.disconnect(),r._p.onaudioprocess=r._p=null),L1(r),y1(r),o&&I1(r)),n.Stream=0},I1=G.StopS_=function(n){for(var o=m1(n),r=0;r<o.length;r++){var p=o[r];p.stop&&p.stop()}n.stop&&n.stop()},m1=function(n){var o=0,r=0,p=[];n.getAudioTracks&&(o=n.getAudioTracks(),r=n.getVideoTracks()),o||(o=n.audioTracks,r=n.videoTracks);for(var s=0,g=o?o.length:0;s<g;s++)p.push(o[s]);for(var s=0,g=r?r.length:0;s<g;s++)p.push(r[s]);return p};G.SampleData=function(n,o,r,p,s){var g="SampleData";p||(p={});var A=p.index||0,q=p.offset||0,O=p.raisePrev||0,L=p.filter;if(L&&L.fn&&(L.sr&&L.sr!=o||L.srn&&L.srn!=r)&&(L=null,n1(C("d48C::{1}的filter采样率变了，重设滤波",0,g),3)),!L)if(r<=o){var k=3*o/4<r?0:r/2*3/4;L={fn:k?G.IIRFilter(!0,o,k):0}}else{var k=3*r/4<o?0:o/2*3/4;L={fn:k?G.IIRFilter(!0,r,k):0}}L.sr=o,L.srn=r;var t=L.fn,e=p.frameNext||[];s||(s={});var l=s.frameSize||1;s.frameType&&(l=s.frameType=="mp3"?1152:1);var i=s._sum,a=0,_=n.length;_+1<A&&n1(C("tlbC::{1}似乎传入了未重置chunk {2}",0,g,A+">"+_),3);for(var v=0,u=A;u<_;u++)v+=n[u].length;var c=o/r;if(1<c)v=Math.max(0,v-Math.floor(q)),v=Math.floor(v/c);else if(c<1){var b=1/c;v=Math.floor(v*b)}v+=e.length;for(var h=new Int16Array(v),d=0,u=0;u<e.length;u++)h[d]=e[u],d++;for(;A<_;A++){var m=n[A],f=m instanceof Float32Array,u=q,S=m.length,T=t&&t.Embed,R=0,P=0,I=0,y=0;if(c<1){for(var w=d+u,x=O,D=0;D<S;D++){var N=m[D];f&&(N=(N=Math.max(-1,Math.min(1,N)))<0?32768*N:32767*N);var B=Math.floor(w);w+=b;for(var E=Math.floor(w),H=(N-x)/(E-B),F=1;B<E;B++,F++){var z=Math.floor(x+F*H);T?(I=z,y=T.b0*I+T.b1*T.x1+T.b0*T.x2-T.a1*T.y1-T.a2*T.y2,T.x2=T.x1,T.x1=I,T.y2=T.y1,T.y1=y,z=y):z=t?t(z):z,32767<z?z=32767:z<-32768&&(z=-32768),i&&(a+=Math.abs(z)),h[B]=z,d++}x=O=N,u+=b}q=u%1}else{for(var D=0,K=0;D<S;D++,K++){if(K<S){var N=m[K];f&&(N=(N=Math.max(-1,Math.min(1,N)))<0?32768*N:32767*N),T?(I=N,y=T.b0*I+T.b1*T.x1+T.b0*T.x2-T.a1*T.y1-T.a2*T.y2,T.x2=T.x1,T.x1=I,T.y2=T.y1,T.y1=y):y=t?t(N):N}if(R=P,P=y,K!=0){var U=Math.floor(u);if(D==U){var J=Math.ceil(u),Z=u-U,e1=R,p1=J<S?P:e1,W=e1+(p1-e1)*Z;32767<W?W=32767:W<-32768&&(W=-32768),i&&(a+=Math.abs(W)),h[d]=W,d++,u+=c}}else D--}q=Math.max(0,u-S)}}c<1&&d+1==v&&(v--,h=new Int16Array(h.buffer.slice(0,2*v))),d-1!=v&&d!=v&&n1(g+" idx:"+d+" != size:"+v,3),e=null;var t1=v%l;if(0<t1){var c1=2*(v-t1);e=new Int16Array(h.buffer.slice(c1)),h=new Int16Array(h.buffer.slice(0,c1))}var Q={index:A,offset:q,raisePrev:O,filter:L,frameNext:e,sampleRate:r,data:h};return i&&(Q._sum=a),Q},G.IIRFilter=function(n,o,r){var p=2*Math.PI*r/o,s=Math.sin(p),g=Math.cos(p),A=s/2,q=1+A,O=-2*g/q,L=(1-A)/q;if(n)var k=(1-g)/2/q,t=(1-g)/q;else var k=(1+g)/2/q,t=-(1+g)/q;var e=0,l=0,i=0,a=0,_=0,v=function(u){return i=k*u+t*e+k*l-O*a-L*_,l=e,e=u,_=a,a=i};return v.Embed={x1:0,x2:0,y1:0,y2:0,b0:k,b1:t,a1:O,a2:L},v},G.PowerLevel=function(n,o){var r=n/o||0;return r<1251?Math.round(r/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(r/1e4)/Math.log(10)))))},G.PowerDBFS=function(n){var o=Math.max(.1,n||0);return o=Math.min(o,32767),o=20*Math.log(o/32767)/Math.log(10),Math.max(-100,Math.round(o))},G.CLog=function(n,o){if(typeof console=="object"){var r=new Date,p=("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3),s=this&&this.envIn&&this.envCheck&&this.id,g=["["+p+" "+d1+(s?":"+s:"")+"]"+n],A=arguments,q=G.CLog,O=2,L=q.log||console.log;for(l1(o)?L=o==1?q.error||console.error:o==3?q.warn||console.warn:L:O=1;O<A.length;O++)g.push(A[O]);P1?L&&L("[IsLoser]"+g[0],1<g.length?g:""):L.apply(console,g)}};var n1=function(){G.CLog.apply(this,arguments)},P1=!0;try{P1=!console.log.apply}catch{}var M=0;function w1(n){var o=this;o.id=++M,f1();var r={type:"mp3",onProcess:J1};for(var p in n)r[p]=n[p];var s=(o.set=r)[v1],g=r[o1];(s&&!l1(s)||g&&!l1(g))&&o.CLog(C.G("IllegalArgs-1",[C("VtS4::{1}和{2}必须是数值",0,o1,v1)]),1,n),r[v1]=+s||16,r[o1]=+g||16e3,o.state=0,o._S=9,o.Sync={O:9,C:9}}G.Sync={O:9,C:9},G.prototype=w1.prototype={CLog:n1,_streamStore:function(){return this.set.sourceStream?this:G},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var n=this._streamGet();return n&&n._c},open:function(n,o){var r=this,p=r.set,s=r._streamStore(),g=0;n=n||J1;var A=function(m,f){f=!!f,r.CLog(C("5tWi::录音open失败：")+m+",isUserNotAllow:"+f,1),g&&G.CloseNewCtx(g),o&&o(m,f)};r._streamTag=R1;var q=function(){r.CLog("open ok, id:"+r.id+" stream:"+r._streamTag),n(),r._SO=0},O=s.Sync,L=++O.O,k=O.C;if(r._O=r._O_=L,r._SO=r._S,S1){var t=r.envCheck({envName:"H5",canProcess:!0});if(t)A(C("A5bm::不能录音：")+t);else{var e,l=function(){(e=p.runningContext)||(e=g=G.GetContext(!0))};if(p.sourceStream){if(r._streamTag="set.sourceStream",!G.GetContext())return void A(C("1iU7::不支持此浏览器从流中获取录音"));l(),M1(s);var i=r.Stream=p.sourceStream;i._c=e,i._RC=p.runningContext,i._call={};try{X(s)}catch(m){return M1(s),void A(C("BTW2::从流中打开录音失败：")+m.message)}q()}else{var a=function(m,f){try{window.top.a}catch{return void A(C("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'))}_(1,m)&&(/Found/i.test(m)?A(f+C("jBa9::，无可用麦克风")):A(f))},_=function(m,f){if(/Permission|Allow/i.test(f))m&&A(C("gyO5::用户拒绝了录音权限"),!0);else{if(window.isSecureContext!==!1)return 1;m&&A(C("oWNo::浏览器禁止不安全页面录音，可开启https解决"))}};if(G.IsOpen())q();else if(G.Support()){l();var v,u,c=function(m){setTimeout(function(){m._call={};var f=G.Stream;f&&(M1(),m._call=f._call),(G.Stream=m)._c=e,m._RC=p.runningContext,function(){if(k!=O.C||!r._O){var S=C("dFm8::open被取消");return L==O.O?r.close():S=C("VtJO::open被中断"),A(S),!0}}()||(G.IsOpen()?(f&&r.CLog(C("upb8::发现同时多次调用open"),1),X(s),q()):A(C("Q1GA::录音功能无效：无音频流")))},100)},b=function(m){var f=m.name||m.message||m.code+":"+m,S="";h==1&&_(0,f)&&(S=C("KxE2::，将尝试禁用回声消除后重试"));var T=C("xEQR::请求录音权限错误"),R=C("bDOG::无法录音：");r.CLog(T+S+"|"+m,S||u?3:1,m),S?(v=f,u=m,d(1)):u?(r.CLog(T+"|"+u,1,u),a(v,R+u)):a(f,R+m)},h=0,d=function(m){h++;var f="audioTrackSet",S="autoGainControl",T="echoCancellation",R="noiseSuppression",P=JSON.parse(i1(p[f]||!0));r.CLog("open... "+h+" "+f+":"+i1(P)),m&&(typeof P!="object"&&(P={}),P[S]=!1,P[T]=!1,P[R]=!1),P[o1]&&r.CLog(C("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,f+"."+o1),3);var I={audio:P,video:p.videoTrackSet||!1};try{var y=G.Scope[R1](I,c,b)}catch(w){r.CLog(R1,3,w),I={audio:!0,video:!1},y=G.Scope[R1](I,c,b)}r.CLog(R1+"("+i1(I)+") "+g1(e)+C("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,"audioTrackSet:{echoCancellation,noiseSuppression,autoGainControl}",f)+"("+H1+") LM:"+T1+" UA:"+navigator.userAgent),y&&y.then&&y.then(c)[A1](b)};d()}else a("",C("COxc::此浏览器不支持录音"))}}}else A(C.G("NonBrowser-1",["open"])+C("EMJq::，可尝试使用RecordApp解决方案")+"("+H1+"/tree/master/app-support-sample)")},close:function(n){n=n||J1;var o=this,r=o._streamStore();o._stop();var p=" stream:"+o._streamTag,s=r.Sync;if(o._O=0,o._O_!=s.O)return o.CLog(C("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+p,3),void n();s.C++,M1(r),o.CLog("close,"+p),n()},mock:function(n,o){var r=this;return r._stop(),r.isMock=1,r.mockEnvInfo=null,r.buffers=[n],r.recSize=n.length,r._setSrcSR(o),r._streamTag="mock",r},_setSrcSR:function(n){var o=this.set,r=o[o1];n<r?o[o1]=n:r=0,this[N1]=n,this.CLog(N1+": "+n+" set."+o1+": "+o[o1]+(r?" "+C("UHvm::忽略")+": "+r:""),r?3:0)},envCheck:function(n){var o,r=this.set,p="CPU_BE";if(o||G[p]||typeof Int8Array!="function"||new Int8Array(new Int32Array([1]).buffer)[0]||(f1(p),o=C("Essp::不支持{1}架构",0,p)),!o){var s=r.type,g=this[s+"_envCheck"];r.takeoffEncodeChunk&&(g?n.canProcess||(o=C("7uMV::{1}环境不支持实时处理",0,n.envName)):o=C("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,s)+(this[s]?"":C("LG7e::(未加载编码器)"))),!o&&g&&(o=this[s+"_envCheck"](n,r))}return o||""},envStart:function(n,o){var r=this,p=r.set;if(r.isMock=n?1:0,r.mockEnvInfo=n,r.buffers=[],r.recSize=0,n&&(r._streamTag="env$"+n.envName),r.state=1,r.envInLast=0,r.envInFirst=0,r.envInFix=0,r.envInFixTs=[],r._setSrcSR(o),r.engineCtx=0,r[p.type+"_start"]){var s=r.engineCtx=r[p.type+"_start"](p);s&&(s.pcmDatas=[],s.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(n,o){var r=this,p=r.set,s=r.engineCtx;if(r.state==1){var g=r[N1],A=n.length,q=G.PowerLevel(o,A),O=r.buffers,L=O.length;O.push(n);var k=O,t=L,e=Date.now(),l=Math.round(A/g*1e3);r.envInLast=e,r.buffers.length==1&&(r.envInFirst=e-l);var i=r.envInFixTs;i.splice(0,0,{t:e,d:l});for(var a=e,_=0,v=0;v<i.length;v++){var u=i[v];if(3e3<e-u.t){i.length=v;break}a=u.t,_+=u.d}var c=i[1],b=e-a,h=b-_;if(b/3<h&&(c&&1e3<b||6<=i.length)){var d=e-c.t-l;if(l/5<d){var m=!p.disableEnvInFix;if(r.CLog("["+e+"]"+j.get(C(m?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[d]),3),r.envInFix+=d,m){var f=new Int16Array(d*g/1e3);A+=f.length,O.push(f)}}}var S=r.recSize,T=A,R=S+T;if(r.recSize=R,s){var P=G.SampleData(O,g,p[o1],s.chunkInfo);s.chunkInfo=P,S=s.pcmSize,T=P.data.length,R=S+T,s.pcmSize=R,O=s.pcmDatas,L=O.length,O.push(P.data),g=P[o1]}var I=Math.round(R/g*1e3),y=O.length,w=k.length,x=function(){for(var H=D?0:-T,F=O[0]==null,z=L;z<y;z++){var K=O[z];K==null?F=1:(H+=K.length,s&&K.length&&r[p.type+"_encode"](s,K))}if(F&&s){var z=t;for(k[0]&&(z=0);z<w;z++)k[z]=null}F&&(H=D?T:0,O[0]=null),s?s.pcmSize+=H:r.recSize+=H},D=0,N="rec.set.onProcess";try{D=(D=p.onProcess(O,q,I,g,L,x))===!0}catch{}var B=Date.now()-e;if(10<B&&1e3<r.envInFirst-e&&r.CLog(N+C("2ghS::低性能，耗时{1}ms",0,B),3),D){for(var E=0,v=L;v<y;v++)O[v]==null?E=1:O[v]=new Int16Array(0);E?r.CLog(C("ufqH::未进入异步前不能清除buffers"),3):s?s.pcmSize-=T:r.recSize-=T}else x()}else r.state||r.CLog("envIn at state=0",3)},start:function(){var n=this,o=1;if(n.set.sourceStream?n.Stream||(o=0):G.IsOpen()||(o=0),o){var r=n._streamCtx();if(n.CLog(C("kLDN::start 开始录音，")+g1(r)+" stream:"+n._streamTag),n._stop(),n.envStart(null,r[o1]),n.state=3,n._SO&&n._SO+1!=n._S)n.CLog(C("Bp2y::start被中断"),3);else{n._SO=0;var p=function(){n.state==3&&(n.state=1,n.resume())},s="AudioContext resume: ",g=n._streamGet();g._call[n.id]=function(){n.CLog(s+r.state+"|stream ok"),p()},u1(r,function(A){return A&&n.CLog(s+"wait..."),n.state==3},function(A){A&&n.CLog(s+r.state),p()},function(A){n.CLog(s+r.state+C("upkE::，可能无法录音：")+A,1),p()})}}else n.CLog(C("6WmN::start失败：未open"),1)},pause:function(){var n=this,o=n._streamGet();n.state&&(n.state=2,n.CLog("pause"),o&&delete o._call[n.id])},resume:function(){var n=this,o=n._streamGet(),r="resume(wait ctx)";if(n.state==3)n.CLog(r);else if(n.state){n.state=1,n.CLog("resume"),n.envResume(),o&&(o._call[n.id]=function(s,g){n.state==1&&n.envIn(s,g)},E1(o));var p=n._streamCtx();p&&u1(p,function(s){return s&&n.CLog(r+"..."),n.state==1},function(s){s&&n.CLog(r+p.state),E1(o)},function(s){n.CLog(r+p.state+"[err]"+s,1)})}},_stop:function(n){var o=this,r=o.set;o.isMock||o._S++,o.state&&(o.pause(),o.state=0),!n&&o[r.type+"_stop"]&&(o[r.type+"_stop"](o.engineCtx),o.engineCtx=0)},stop:function(n,o,r){var p,s=this,g=s.set,A=s.envInLast-s.envInFirst,q=A&&s.buffers.length;s.CLog(C("Xq4s::stop 和start时差:")+(A?A+"ms "+C("3CQP::补偿:")+s.envInFix+"ms envIn:"+q+" fps:"+(q/A*1e3).toFixed(1):"-")+" stream:"+s._streamTag+" ("+H1+") LM:"+T1);var O=function(){s._stop(),r&&s.close()},L=function(u){s.CLog(C("u8JG::结束录音失败：")+u,1),o&&o(u),O()},k=function(u,c,b){var h="arraybuffer",d="dataType",m="DefaultDataType",f=s[d]||G[m]||"blob",S=d+"="+f,T=u instanceof ArrayBuffer,R=0,P=T?u.byteLength:u.size;if(f==h?T||(R=1):f=="blob"?typeof Blob!="function"?R=C.G("NonBrowser-1",[S])+C("1skY::，请设置{1}",0,d1+"."+m+'="'+h+'"'):(T&&(u=new Blob([u],{type:c})),u instanceof Blob||(R=1),c=u.type||c):R=C.G("NotSupport-1",[S]),s.CLog(C("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-p,b,P)+" "+S+","+c),R)L(R!=1?R:C("Vkbd::{1}编码器返回的不是{2}",0,g.type,f)+", "+S);else{if(g.takeoffEncodeChunk)s.CLog(C("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(P<Math.max(50,b/5))return void L(C("Sz2H::生成的{1}无效",0,g.type));n&&n(u,b,c),O()}};if(!s.isMock){var t=s.state==3;if(!s.state||t)return void L(C("wf9t::未开始录音")+(t?C("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""))}s._stop(!0);var e=s.recSize;if(e)if(s[g.type]){if(s.isMock){var l=s.envCheck(s.mockEnvInfo||{envName:"mock",canProcess:!1});if(l)return void L(C("AxOH::录音错误：")+l)}var i=s.engineCtx;if(s[g.type+"_complete"]&&i){var a=Math.round(i.pcmSize/g[o1]*1e3);return p=Date.now(),void s[g.type+"_complete"](i,function(u,c){k(u,c,a)},L)}if(p=Date.now(),s.buffers[0]){var _=G.SampleData(s.buffers,s[N1],g[o1]);g[o1]=_[o1];var v=_.data,a=Math.round(v.length/g[o1]*1e3);s.CLog(C("CxeT::采样:{1} 花:{2}ms",0,e+"->"+v.length,Date.now()-p)),setTimeout(function(){p=Date.now(),s[g.type](v,function(c,b){k(c,b,a)},function(c){L(c)})})}else L(C("xkKd::音频buffers被释放"))}else L(C("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,g.type,d1));else L(C("Ltz3::未采集到录音"))}};var C1=function(n,o){o.pos||(o.pos=[0],o.tracks={},o.bytes=[]);var r=o.tracks,p=[o.pos[0]],s=function(){o.pos[0]=p[0]},g=o.bytes.length,A=new Uint8Array(g+n.length);if(A.set(o.bytes),A.set(n,g),o.bytes=A,!o._ht){if(V(A,p),$(A,p),!x1(V(A,p),[24,83,128,103]))return;for(V(A,p);p[0]<A.length;){var q=V(A,p),O=$(A,p),L=[0],k=0;if(!O)return;if(x1(q,[22,84,174,107])){for(;L[0]<O.length;){var t=V(O,L),e=$(O,L),l=[0],i={channels:0,sampleRate:0};if(x1(t,[174]))for(;l[0]<e.length;){var a=V(e,l),_=$(e,l),v=[0];if(x1(a,[215])){var u=_1(_);i.number=u,r[u]=i}else if(x1(a,[131])){var u=_1(_);u==1?i.type="video":u==2?(i.type="audio",k||(o.track0=i),i.idx=k++):i.type="Type-"+u}else if(x1(a,[134])){for(var c="",b=0;b<_.length;b++)c+=String.fromCharCode(_[b]);i.codec=c}else if(x1(a,[225]))for(;v[0]<_.length;){var h=V(_,v),d=$(_,v);if(x1(h,[181])){var u=0,m=new Uint8Array(d.reverse()).buffer;d.length==4?u=new Float32Array(m)[0]:d.length==8?u=new Float64Array(m)[0]:n1("WebM Track !Float",1,d),i[o1]=Math.round(u)}else x1(h,[98,100])?i.bitDepth=_1(d):x1(h,[159])&&(i.channels=_1(d))}}}o._ht=1,n1("WebM Tracks",r),s();break}}}var f=o.track0;if(f){var S=f[o1];if(o.webmSR=S,f.bitDepth==16&&/FLOAT/i.test(f.codec)&&(f.bitDepth=32,n1("WebM 16->32 bit",3)),S<8e3||f.bitDepth!=32||f.channels<1||!/(\b|_)PCM\b/i.test(f.codec))return o.bytes=[],o.bad||n1("WebM Track Unexpected",3,o),-(o.bad=1);for(var T=[],R=0;p[0]<A.length;){var t=V(A,p),e=$(A,p);if(!e)break;if(x1(t,[163])){var P=15&e[0],i=r[P];if(!i)return n1("WebM !Track"+P,1,r),-1;if(i.idx===0){for(var I=new Uint8Array(e.length-4),b=4;b<e.length;b++)I[b-4]=e[b];T.push(I),R+=I.length}}s()}if(R){var y=new Uint8Array(A.length-o.pos[0]);y.set(A.subarray(o.pos[0])),o.bytes=y,o.pos[0]=0;for(var I=new Uint8Array(R),b=0,w=0;b<T.length;b++)I.set(T[b],w),w+=T[b].length;var m=new Float32Array(I.buffer);if(1<f.channels){for(var x=[],b=0;b<m.length;)x.push(m[b]),b+=f.channels;m=new Float32Array(x)}return m}}},x1=function(n,o){if(!n||n.length!=o.length)return!1;if(n.length==1)return n[0]==o[0];for(var r=0;r<n.length;r++)if(n[r]!=o[r])return!1;return!0},_1=function(n){for(var o="",r=0;r<n.length;r++){var p=n[r];o+=(p<16?"0":"")+p.toString(16)}return parseInt(o,16)||0},V=function(n,o,r){var p=o[0];if(!(p>=n.length)){var s=n[p],g=("0000000"+s.toString(2)).substr(-8),A=/^(0*1)(\d*)$/.exec(g);if(A){var q=A[1].length,O=[];if(!(p+q>n.length)){for(var L=0;L<q;L++)O[L]=n[p],p++;return r&&(O[0]=parseInt(A[2]||"0",2)),o[0]=p,O}}}},$=function(n,o){var r=V(n,o,1);if(r){var p=_1(r),s=o[0],g=[];if(p<2147483647){if(s+p>n.length)return;for(var A=0;A<p;A++)g[A]=n[s],s++}return o[0]=s,g}},j=G.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(n,o){var r=d1+".i18n.put: ",p=n.overwrite;p=p==null||p;var s=n.lang;if(!(s=j.alias[s]||s))throw new Error(r+"set.lang?");var g=j.locales[s];g||(g={},j.locales[s]=g);for(var A,q=/^([\w\-]+):/,O=0;O<o.length;O++){var L=o[O];if(A=q.exec(L)){var k=A[1],L=L.substr(k.length+1);!p&&g[k]||(g[k]=L)}else n1(r+"'key:'? "+L,3,n)}},get:function(){return j.v_G.apply(null,arguments)},v_G:function(n,o,r){o=o||[],r=r||j.lang,r=j.alias[r]||r;var p=j.locales[r],s=p&&p[n]||"";return s||r=="zh"?(j.lastLang=r,s=="=Empty"?"":s.replace(/\{(\d+)(\!?)\}/g,function(g,A,q){return g=o[(A=+A||0)-1],(A<1||A>o.length)&&(g="{?}",n1("i18n["+n+"] no {"+A+"}: "+s,3)),q?"":g})):r=="en"?j.v_G(n,o,"zh"):j.v_G(n,o,"en")},$T:function(){return j.v_T.apply(null,arguments)},v_T:function(){for(var n,o=arguments,r="",p=[],s=0,g=d1+".i18n.$T:",A=/^([\w\-]*):/,q=0;q<o.length;q++){var O=o[q];if(q==0){if(n=A.exec(O),!(r=n&&n[1]))throw new Error(g+"0 'key:'?");O=O.substr(r.length+1)}if(s===-1)p.push(O);else{if(s)throw new Error(g+" bad args");if(O===0)s=-1;else if(l1(O)){if(O<1)throw new Error(g+" bad args");s=O}else{var L=q==1?"en":q?"":"zh";if((n=A.exec(O))&&(L=n[1]||L,O=O.substr(n[1].length+1)),!n||!L)throw new Error(g+q+" 'lang:'?");j.put({lang:L,overwrite:!1},[r+":"+O])}}}return r?0<s?r:j.v_G(r,p):""}},C=j.$T;C.G=j.get,C("NonBrowser-1::非浏览器环境，不支持{1}",1),C("IllegalArgs-1::参数错误：{1}",1),C("NeedImport-2::调用{1}需要先导入{2}",2),C("NotSupport-1::不支持：{1}",1),G.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var f1=G.Traffic=function(n){if(S1){n=n?"/"+d1+"/Report/"+n:"";var o=G.TrafficImgUrl;if(o){var r=G.Traffic,p=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],s=p[1]||"http://file/",g=(p[0]||s)+n;if(o.indexOf("//")==0&&(o=/^https:/i.test(g)?"https:"+o:"http:"+o),n&&(o=o+"&cu="+encodeURIComponent(s+n)),!r[g]){r[g]=1;var A=new Image;A.src=o,n1("Traffic Analysis Image: "+(n||d1+".TrafficImgUrl="+G.TrafficImgUrl))}}}};k1&&(n1(C("8HO5::覆盖导入{1}",0,d1),1),k1.Destroy()),a1[d1]=G})(q1,W1),oe.exports&&(oe.exports=q1.Recorder)})(),function(le){var W1=typeof window=="object"&&!!window.document,q1=(W1?window:Object).Recorder,a1=q1.i18n;(function(S1,J1,l1,i1){var G="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",T1="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";S1.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return l1("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,G,T1)}};var H1,d1=function(Y){var r1=Y.bitRate,u1=Y.sampleRate,h1=u1;if((" "+T1+",").indexOf(" "+r1+",")==-1&&S1.CLog(l1("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+r1,T1),3),(" "+G+",").indexOf(" "+u1+",")==-1){for(var g1=G.split(", "),b1=[],s1=0;s1<g1.length;s1++)b1.push({v:+g1[s1],s:Math.abs(g1[s1]-u1)});b1.sort(function(X,E1){return X.s-E1.s}),h1=b1[0].v,Y.sampleRate=h1,S1.CLog(l1("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,h1,u1,G),3)}},R1=function(){return l1.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},N1=i1&&typeof Worker=="function";S1.prototype.mp3=function(Y,r1,u1){var h1=this,g1=h1.set,b1=Y.length;if(S1.lamejs){if(N1){var s1=h1.mp3_start(g1);if(s1){if(s1.isW)return h1.mp3_encode(s1,Y),void h1.mp3_complete(s1,r1,u1,1);h1.mp3_stop(s1)}}d1(g1);var X=new S1.lamejs.Mp3Encoder(1,g1.sampleRate,g1.bitRate),E1=new Int8Array(5e5),L1=0,y1=0,M1=0,I1=function(){try{if(y1<b1)var m1=X.encodeBuffer(Y.subarray(y1,y1+57600));else{M1=1;var m1=X.flush()}}catch(C1){if(!M1)try{X.flush()}catch{}return void u1("MP3 Encoder: "+C1.message)}var n1=m1.length;if(0<n1){if(L1+n1>E1.length){var P1=new Int8Array(E1.length+Math.max(5e5,n1));P1.set(E1.subarray(0,L1)),E1=P1}E1.set(m1,L1),L1+=n1}if(y1<b1)y1+=57600,setTimeout(I1);else{var M=[E1.buffer.slice(0,L1)],w1=A1.fn(M,L1,b1,g1.sampleRate);k1(w1,g1),r1(M[0]||new ArrayBuffer(0),"audio/mp3")}};I1()}else u1(R1())},S1.BindDestroy("mp3Worker",function(){H1&&(S1.CLog("mp3Worker Destroy"),H1.terminate(),H1=null)}),S1.prototype.mp3_envCheck=function(Y,r1){var u1="";return r1.takeoffEncodeChunk&&(v1()||(u1=l1("yhUs::当前浏览器版本太低，无法实时处理"))),u1||S1.lamejs||(u1=R1()),u1},S1.prototype.mp3_start=function(Y){return v1(Y)};var o1={id:0},v1=function(Y,r1){var u1,h1=function(I1){var m1=I1.data,n1=u1.wkScope.wk_ctxs,P1=u1.wkScope.wk_lame,M=u1.wkScope.wk_mp3TrimFix,w1=n1[m1.id];if(m1.action=="init")n1[m1.id]={sampleRate:m1.sampleRate,bitRate:m1.bitRate,takeoff:m1.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new P1.Mp3Encoder(1,m1.sampleRate,m1.bitRate)};else if(!w1)return;var C1=function($){var j=$.length;if(w1.mOffset+j>w1.memory.length){var C=new Int8Array(w1.memory.length+Math.max(5e5,j));C.set(w1.memory.subarray(0,w1.mOffset)),w1.memory=C}w1.memory.set($,w1.mOffset),w1.mOffset+=j};switch(m1.action){case"stop":if(!w1.isCp)try{w1.encObj.flush()}catch{}w1.encObj=null,delete n1[m1.id];break;case"encode":if(w1.isCp)break;w1.pcmSize+=m1.pcm.length;try{var x1=w1.encObj.encodeBuffer(m1.pcm)}catch($){w1.err=$}x1&&0<x1.length&&(w1.takeoff?s1.onmessage({action:"takeoff",id:m1.id,chunk:x1}):C1(x1));break;case"complete":w1.isCp=1;try{var x1=w1.encObj.flush()}catch($){w1.err=$}if(x1&&0<x1.length&&(w1.takeoff?s1.onmessage({action:"takeoff",id:m1.id,chunk:x1}):C1(x1)),w1.err){s1.onmessage({action:m1.action,id:m1.id,err:"MP3 Encoder: "+w1.err.message});break}var _1=[w1.memory.buffer.slice(0,w1.mOffset)],V=M.fn(_1,w1.mOffset,w1.pcmSize,w1.sampleRate);s1.onmessage({action:m1.action,id:m1.id,blob:_1[0]||new ArrayBuffer(0),meta:V})}},g1=function(I1){s1.onmessage=function(m1){var n1=m1;I1&&(n1=m1.data);var P1=o1[n1.id];P1&&(n1.action=="takeoff"?P1.set.takeoffEncodeChunk(new Uint8Array(n1.chunk.buffer)):(P1.call&&P1.call(n1),P1.call=null))}},b1=function(){var I1={worker:s1,set:Y};return Y?(I1.id=++o1.id,o1[I1.id]=I1,d1(Y),s1.postMessage({action:"init",id:I1.id,sampleRate:Y.sampleRate,bitRate:Y.bitRate,takeoff:!!Y.takeoffEncodeChunk,x:new Int16Array(5)})):s1.postMessage({x:new Int16Array(5)}),I1},s1=H1;if(r1||!N1)return S1.CLog(l1("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),s1={postMessage:function(I1){h1({data:I1})}},u1={wkScope:{wk_ctxs:{},wk_lame:S1.lamejs,wk_mp3TrimFix:A1}},g1(),b1();try{if(!s1){var X=(h1+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage"),E1=");wk_lame();self.onmessage="+(X=X.replace(/[\w\$]+\.wkScope/g,"wkScope"));E1+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",E1+=",wk_mp3TrimFix:{rm:"+A1.rm+",fn:"+A1.fn+"} }";var L1=S1.lamejs.toString(),y1=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",L1,E1],{type:"text/javascript"}));s1=new Worker(y1),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(y1)},1e4),g1(1)}var M1=b1();return M1.isW=1,H1=s1,M1}catch{return s1&&s1.terminate(),v1(Y,1)}};S1.prototype.mp3_stop=function(Y){if(Y&&Y.worker){Y.worker.postMessage({action:"stop",id:Y.id}),Y.worker=null,delete o1[Y.id];var r1=-1;for(var u1 in o1)r1++;r1&&S1.CLog(l1("fT6M::mp3 worker剩{1}个未stop",0,r1),3)}},S1.prototype.mp3_encode=function(Y,r1){Y&&Y.worker&&Y.worker.postMessage({action:"encode",id:Y.id,pcm:r1})},S1.prototype.mp3_complete=function(Y,r1,u1,h1){var g1=this;Y&&Y.worker?(Y.call=function(b1){h1&&g1.mp3_stop(Y),b1.err?u1(b1.err):(k1(b1.meta,Y.set),r1(b1.blob,"audio/mp3"))},Y.worker.postMessage({action:"complete",id:Y.id})):u1(l1("mPxH::mp3编码器未start"))},S1.mp3ReadMeta=function(Y,r1){var u1=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,h1=new Uint8Array(Y[0]||[]);if(h1.length<4)return null;var g1=function($,j){return("0000000"+((j||h1)[$]||0).toString(2)).substr(-8)},b1=g1(0)+g1(1),s1=g1(2)+g1(3);if(!/^1{11}/.test(b1))return null;var X={"00":2.5,10:2,11:1}[b1.substr(11,2)],E1={"01":3}[b1.substr(13,2)],L1={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]}[X];L1&&(L1=L1[u1(s1.substr(4,2),2)]);var y1=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][X==1?1:0][u1(s1.substr(0,4),2)];if(!(X&&E1&&y1&&L1))return null;for(var M1=Math.round(8*r1/y1),I1=E1==1?384:E1==2||X==1?1152:576,m1=I1/L1*1e3,n1=Math.floor(I1*y1/8/L1*1e3),P1=0,M=0,w1=0;w1<Y.length;w1++){var C1=Y[w1];if(M+=C1.byteLength,n1+3<=M){var x1=new Uint8Array(C1),_1=C1.byteLength-(M-(n1+3)+1),V=g1(_1,x1);P1=V.charAt(6)=="1";break}}return P1&&n1++,{version:X,layer:E1,sampleRate:L1,bitRate:y1,duration:M1,size:r1,hasPadding:P1,frameSize:n1,frameDurationFloat:m1}};var A1={rm:S1.mp3ReadMeta,fn:function(Y,r1,u1,h1){var g1=this.rm(Y,r1);if(!g1)return{size:r1,err:"mp3 unknown format"};var b1=Math.round(u1/h1*1e3),s1=Math.floor((g1.duration-b1)/g1.frameDurationFloat);if(0<s1){var X=s1*g1.frameSize-(g1.hasPadding?1:0);r1-=X;for(var E1=0,L1=[],y1=0;y1<Y.length;y1++){var M1=Y[y1];if(X<=0)break;X>=M1.byteLength?(X-=M1.byteLength,L1.push(M1),Y.splice(y1,1),y1--):(Y[y1]=M1.slice(X),E1=M1,X=0)}var I1=this.rm(Y,r1);if(!I1){E1&&(Y[0]=E1);for(var y1=0;y1<L1.length;y1++)Y.splice(y1,0,L1[y1]);g1.err="mp3 fix error: 已还原，错误原因不明"}var m1=g1.trimFix={};m1.remove=s1,m1.removeDuration=Math.round(s1*g1.frameDurationFloat),m1.duration=Math.round(8*r1/g1.bitRate)}return g1}},k1=function(Y,r1){var u1="MP3 Info: ";(Y.sampleRate&&Y.sampleRate!=r1.sampleRate||Y.bitRate&&Y.bitRate!=r1.bitRate)&&(S1.CLog(u1+l1("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+r1.bitRate+"kbps "+r1.sampleRate+"hz","set:"+Y.bitRate+"kbps "+Y.sampleRate+"hz"),3,r1),r1.sampleRate=Y.sampleRate,r1.bitRate=Y.bitRate);var h1=Y.trimFix;h1?(u1+=l1("iMSm::Fix移除{1}帧",0,h1.remove)+" "+h1.removeDuration+"ms -> "+h1.duration+"ms",2<h1.remove&&(Y.err=(Y.err?Y.err+", ":"")+l1("b9zm::移除帧数过多"))):u1+=(Y.duration||"-")+"ms",Y.err?S1.CLog(u1,Y.size?1:0,Y.err,Y):S1.CLog(u1,Y)}})(q1,0,a1.$T,W1)}(),function(le){function W1(){var q1=function(V){return Math.log(V)/Math.log(10)},a1=function(V){throw new Error("abort("+V+")")};function S1(V){return new Int8Array(V)}function J1(V){return new Int16Array(V)}function l1(V){return new Int32Array(V)}function i1(V){return new Float32Array(V)}function G(V){return new Float64Array(V)}function T1(V){if(V.length==1)return i1(V[0]);var $=V[0];V=V.slice(1);for(var j=[],C=0;C<$;C++)j.push(T1(V));return j}function H1(V){if(V.length==1)return l1(V[0]);var $=V[0];V=V.slice(1);for(var j=[],C=0;C<$;C++)j.push(H1(V));return j}function d1(V){if(V.length==1)return J1(V[0]);var $=V[0];V=V.slice(1);for(var j=[],C=0;C<$;C++)j.push(d1(V));return j}function R1(V){if(V.length==1)return new Array(V[0]);var $=V[0];V=V.slice(1);for(var j=[],C=0;C<$;C++)j.push(R1(V));return j}var N1={fill:function(V,$,j,C){if(arguments.length==2)for(var f1=0;f1<V.length;f1++)V[f1]=$;else for(var f1=$;f1<j;f1++)V[f1]=C}},o1={arraycopy:function(V,$,j,C,f1){for(var n=$+f1;$<n;)j[C++]=V[$++]}},v1={};function A1(V){this.ordinal=V}v1.SQRT2=1.4142135623730951,v1.FAST_LOG10=function(V){return q1(V)},v1.FAST_LOG10_X=function(V,$){return q1(V)*$},A1.short_block_allowed=new A1(0),A1.short_block_coupled=new A1(1),A1.short_block_dispensed=new A1(2),A1.short_block_forced=new A1(3);var k1={};function Y(V){this.ordinal=V}function r1(V){var $=V;this.ordinal=function(){return $}}function u1(){var V=null;function $(e){this.bits=0|e}this.qupvt=null,this.setModules=function(e){this.qupvt=e,V=e};var j=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function C(e,l,i,a,_,v){var u=.5946/l;for(e>>=1;e--!=0;)_[v++]=u>i[a++]?0:1,_[v++]=u>i[a++]?0:1}function f1(e,l,i,a,_,v){var u=(e>>=1)%2;for(e>>=1;e--!=0;){var c,b,h,d,m,f,S,T;c=i[a++]*l,b=i[a++]*l,m=0|c,h=i[a++]*l,f=0|b,d=i[a++]*l,S=0|h,c+=V.adj43[m],T=0|d,b+=V.adj43[f],_[v++]=0|c,h+=V.adj43[S],_[v++]=0|b,d+=V.adj43[T],_[v++]=0|h,_[v++]=0|d}u!=0&&(c=i[a++]*l,b=i[a++]*l,m=0|c,f=0|b,c+=V.adj43[m],b+=V.adj43[f],_[v++]=0|c,_[v++]=0|b)}var n=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function o(e,l,i,a){var _=function(c,b,h){var d=0,m=0;do{var f=c[b++],S=c[b++];d<f&&(d=f),m<S&&(m=S)}while(b<h);return d<m&&(d=m),d}(e,l,i);switch(_){case 0:return _;case 1:return function(c,b,h,d){var m=0,f=X.ht[1].hlen;do{var S=2*c[b+0]+c[b+1];b+=2,m+=f[S]}while(b<h);return d.bits+=m,1}(e,l,i,a);case 2:case 3:return function(c,b,h,d,m){var f,S,T=0,R=X.ht[d].xlen;S=d==2?X.table23:X.table56;do{var P=c[b+0]*R+c[b+1];b+=2,T+=S[P]}while(b<h);return(f=65535&T)<(T>>=16)&&(T=f,d++),m.bits+=T,d}(e,l,i,n[_-1],a);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(c,b,h,d,m){var f=0,S=0,T=0,R=X.ht[d].xlen,P=X.ht[d].hlen,I=X.ht[d+1].hlen,y=X.ht[d+2].hlen;do{var w=c[b+0]*R+c[b+1];b+=2,f+=P[w],S+=I[w],T+=y[w]}while(b<h);var x=d;return S<f&&(f=S,x++),T<f&&(f=T,x=d+2),m.bits+=f,x}(e,l,i,n[_-1],a);default:var v,u;for(M1.IXMAX_VAL<_&&a1(),_-=15,v=24;v<32&&!(X.ht[v].linmax>=_);v++);for(u=v-8;u<24&&!(X.ht[u].linmax>=_);u++);return function(c,b,h,d,m,f){var S,T=65536*X.ht[d].xlen+X.ht[m].xlen,R=0;do{var P=c[b++],I=c[b++];P!=0&&(14<P&&(P=15,R+=T),P*=16),I!=0&&(14<I&&(I=15,R+=T),P+=I),R+=X.largetbl[P]}while(b<h);return(S=65535&R)<(R>>=16)&&(R=S,d=m),f.bits+=R,d}(e,l,i,u,v,a)}}function r(e,l,i,a,_,v,u,c){for(var b=l.big_values,h=2;h<M.SBMAX_l+1;h++){var d=e.scalefac_band.l[h];if(b<=d)break;var m=_[h-2]+l.count1bits;if(i.part2_3_length<=m)break;var f=new $(m),S=o(a,d,b,f);m=f.bits,i.part2_3_length<=m||(i.assign(l),i.part2_3_length=m,i.region0_count=v[h-2],i.region1_count=h-2-v[h-2],i.table_select[0]=u[h-2],i.table_select[1]=c[h-2],i.table_select[2]=S)}}this.noquant_count_bits=function(e,l,i){var a=l.l3_enc,_=Math.min(576,l.max_nonzero_coeff+2>>1<<1);for(i!=null&&(i.sfb_count1=0);1<_&&!(a[_-1]|a[_-2]);_-=2);l.count1=_;for(var v=0,u=0;3<_;_-=4){var c;if(1<(2147483647&(a[_-1]|a[_-2]|a[_-3]|a[_-4])))break;c=2*(2*(2*a[_-4]+a[_-3])+a[_-2])+a[_-1],v+=X.t32l[c],u+=X.t33l[c]}var b=v;if(l.count1table_select=0,u<v&&(b=u,l.count1table_select=1),l.count1bits=b,(l.big_values=_)==0)return b;if(l.block_type==M.SHORT_TYPE)(v=3*e.scalefac_band.s[3])>l.big_values&&(v=l.big_values),u=l.big_values;else if(l.block_type==M.NORM_TYPE){if(v=l.region0_count=e.bv_scf[_-2],u=l.region1_count=e.bv_scf[_-1],u=e.scalefac_band.l[v+u+2],v=e.scalefac_band.l[v+1],u<_){var h=new $(b);l.table_select[2]=o(a,u,_,h),b=h.bits}}else l.region0_count=7,l.region1_count=M.SBMAX_l-1-7-1,v=e.scalefac_band.l[8],(u=_)<v&&(v=u);if(v=Math.min(v,_),u=Math.min(u,_),0<v){var h=new $(b);l.table_select[0]=o(a,0,v,h),b=h.bits}if(v<u){var h=new $(b);l.table_select[1]=o(a,v,u,h),b=h.bits}if(e.use_best_huffman==2&&a1(),i!=null&&l.block_type==M.NORM_TYPE){for(var d=0;e.scalefac_band.l[d]<l.big_values;)d++;i.sfb_count1=d}return b},this.count_bits=function(e,l,i,a){var _=i.l3_enc,v=M1.IXMAX_VAL/V.IPOW20(i.global_gain);return i.xrpow_max>v?M1.LARGE_BITS:(function(u,c,b,h,d){var m,f,S,T=0,R=0,P=0,I=0,y=c,w=0,x=y,D=0,N=u,B=0;for(S=d!=null&&h.global_gain==d.global_gain,f=h.block_type==M.SHORT_TYPE?38:21,m=0;m<=f;m++){var E=-1;if((S||h.block_type==M.NORM_TYPE)&&(E=h.global_gain-(h.scalefac[m]+(h.preflag!=0?V.pretab[m]:0)<<h.scalefac_scale+1)-8*h.subblock_gain[h.window[m]]),S&&d.step[m]==E)R!=0&&(f1(R,b,N,B,x,D),R=0),P!=0&&a1();else{var H,F=h.width[m];if(T+h.width[m]>h.max_nonzero_coeff&&(H=h.max_nonzero_coeff-T+1,N1.fill(c,h.max_nonzero_coeff,576,0),(F=H)<0&&(F=0),m=f+1),R==0&&P==0&&(x=y,D=w,N=u,B=I),d!=null&&0<d.sfb_count1&&m>=d.sfb_count1&&0<d.step[m]&&E>=d.step[m]?(R!=0&&(f1(R,b,N,B,x,D),R=0,x=y,D=w,N=u,B=I),P+=F):(P!=0&&(C(P,b,N,B,x,D),P=0,x=y,D=w,N=u,B=I),R+=F),F<=0){P!=0&&a1(),R!=0&&a1();break}}m<=f&&(w+=h.width[m],I+=h.width[m],T+=h.width[m])}R!=0&&(f1(R,b,N,B,x,D),R=0),P!=0&&a1()}(l,_,V.IPOW20(i.global_gain),i,a),2&e.substep_shaping&&a1(),this.noquant_count_bits(e,i,a))},this.best_huffman_divide=function(e,l){var i=new I1,a=l.l3_enc,_=l1(23),v=l1(23),u=l1(23),c=l1(23);if(l.block_type!=M.SHORT_TYPE||e.mode_gr!=1){i.assign(l),l.block_type==M.NORM_TYPE&&(function(S,T,R,P,I,y,w){for(var x=T.big_values,D=0;D<=22;D++)P[D]=M1.LARGE_BITS;for(var D=0;D<16;D++){var N=S.scalefac_band.l[D+1];if(x<=N)break;var B=0,E=new $(B),H=o(R,0,N,E);B=E.bits;for(var F=0;F<8;F++){var z=S.scalefac_band.l[D+F+2];if(x<=z)break;var K=B;E=new $(K);var U=o(R,N,z,E);K=E.bits,P[D+F]>K&&(P[D+F]=K,I[D+F]=D,y[D+F]=H,w[D+F]=U)}}}(e,l,a,_,v,u,c),r(e,i,l,a,_,v,u,c));var b=i.big_values;if(!(b==0||1<(a[b-2]|a[b-1])||576<(b=l.count1+2))){i.assign(l),i.count1=b;for(var h=0,d=0;b>i.big_values;b-=4){var m=2*(2*(2*a[b-4]+a[b-3])+a[b-2])+a[b-1];h+=X.t32l[m],d+=X.t33l[m]}if(i.big_values=b,i.count1table_select=0,d<h&&(h=d,i.count1table_select=1),i.count1bits=h,i.block_type==M.NORM_TYPE)r(e,i,l,a,_,v,u,c);else{if(i.part2_3_length=h,h=e.scalefac_band.l[8],b<h&&(h=b),0<h){var f=new $(i.part2_3_length);i.table_select[0]=o(a,0,h,f),i.part2_3_length=f.bits}if(h<b){var f=new $(i.part2_3_length);i.table_select[1]=o(a,h,b,f),i.part2_3_length=f.bits}l.part2_3_length>i.part2_3_length&&l.assign(i)}}}};var p=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],s=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],g=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],A=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];u1.slen1_tab=g,u1.slen2_tab=A,this.best_scalefac_store=function(e,l,i,a){var _,v,u,c,b=a.tt[l][i],h=0;for(_=u=0;_<b.sfbmax;_++){var d=b.width[_];for(u+=d,c=-d;c<0&&b.l3_enc[c+u]==0;c++);c==0&&(b.scalefac[_]=h=-2)}if(b.scalefac_scale==0&&b.preflag==0){var m=0;for(_=0;_<b.sfbmax;_++)0<b.scalefac[_]&&(m|=b.scalefac[_]);if(!(1&m)&&m!=0){for(_=0;_<b.sfbmax;_++)0<b.scalefac[_]&&(b.scalefac[_]>>=1);b.scalefac_scale=h=1}}if(b.preflag==0&&b.block_type!=M.SHORT_TYPE&&e.mode_gr==2){for(_=11;_<M.SBPSY_l&&!(b.scalefac[_]<V.pretab[_]&&b.scalefac[_]!=-2);_++);if(_==M.SBPSY_l){for(_=11;_<M.SBPSY_l;_++)0<b.scalefac[_]&&(b.scalefac[_]-=V.pretab[_]);b.preflag=h=1}}for(v=0;v<4;v++)a.scfsi[i][v]=0;for(e.mode_gr==2&&l==1&&a.tt[0][i].block_type!=M.SHORT_TYPE&&a.tt[1][i].block_type!=M.SHORT_TYPE&&(function(f,S){for(var T,R=S.tt[1][f],P=S.tt[0][f],I=0;I<X.scfsi_band.length-1;I++){for(T=X.scfsi_band[I];T<X.scfsi_band[I+1]&&!(P.scalefac[T]!=R.scalefac[T]&&0<=R.scalefac[T]);T++);if(T==X.scfsi_band[I+1]){for(T=X.scfsi_band[I];T<X.scfsi_band[I+1];T++)R.scalefac[T]=-1;S.scfsi[f][I]=1}}var y=0,w=0;for(T=0;T<11;T++)R.scalefac[T]!=-1&&(w++,y<R.scalefac[T]&&(y=R.scalefac[T]));for(var x=0,D=0;T<M.SBPSY_l;T++)R.scalefac[T]!=-1&&(D++,x<R.scalefac[T]&&(x=R.scalefac[T]));for(var I=0;I<16;I++)if(y<p[I]&&x<s[I]){var N=g[I]*w+A[I]*D;R.part2_length>N&&(R.part2_length=N,R.scalefac_compress=I)}}(i,a),h=0),_=0;_<b.sfbmax;_++)b.scalefac[_]==-2&&(b.scalefac[_]=0);h!=0&&(e.mode_gr==2?this.scale_bitcount(b):this.scale_bitcount_lsf(e,b))};var q=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],O=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],L=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(e){var l,i,a,_=0,v=0,u=e.scalefac;if(e.block_type==M.SHORT_TYPE)a=q,e.mixed_block_flag!=0&&(a=O);else if(a=L,e.preflag==0){for(i=11;i<M.SBPSY_l&&!(u[i]<V.pretab[i]);i++);if(i==M.SBPSY_l)for(e.preflag=1,i=11;i<M.SBPSY_l;i++)u[i]-=V.pretab[i]}for(i=0;i<e.sfbdivide;i++)_<u[i]&&(_=u[i]);for(;i<e.sfbmax;i++)v<u[i]&&(v=u[i]);for(e.part2_length=M1.LARGE_BITS,l=0;l<16;l++)_<p[l]&&v<s[l]&&e.part2_length>a[l]&&(e.part2_length=a[l],e.scalefac_compress=l);return e.part2_length==M1.LARGE_BITS};var k=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(e,l){var i,a,_,v,u,c,b,h,d=l1(4),m=l.scalefac;for(i=l.preflag!=0?2:0,b=0;b<4;b++)d[b]=0;if(l.block_type==M.SHORT_TYPE){a=1;var f=V.nr_of_sfb_block[i][a];for(_=h=0;_<4;_++)for(v=f[_]/3,b=0;b<v;b++,h++)for(u=0;u<3;u++)m[3*h+u]>d[_]&&(d[_]=m[3*h+u])}else{a=0;var f=V.nr_of_sfb_block[i][a];for(_=h=0;_<4;_++)for(v=f[_],b=0;b<v;b++,h++)m[h]>d[_]&&(d[_]=m[h])}for(c=!1,_=0;_<4;_++)d[_]>k[i][_]&&(c=!0);if(!c){var S,T,R,P;for(l.sfb_partition_table=V.nr_of_sfb_block[i][a],_=0;_<4;_++)l.slen[_]=t[d[_]];switch(S=l.slen[0],T=l.slen[1],R=l.slen[2],P=l.slen[3],i){case 0:l.scalefac_compress=(5*S+T<<4)+(R<<2)+P;break;case 1:l.scalefac_compress=400+(5*S+T<<2)+R;break;case 2:l.scalefac_compress=500+3*S+T}}if(!c)for(l.part2_length=0,_=0;_<4;_++)l.part2_length+=l.slen[_]*l.sfb_partition_table[_];return c};var t=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var l=2;l<=576;l+=2){for(var i,a=0;e.scalefac_band.l[++a]<l;);for(i=j[a][0];e.scalefac_band.l[i+1]>l;)i--;for(i<0&&(i=j[a][0]),e.bv_scf[l-2]=i,i=j[a][1];e.scalefac_band.l[i+e.bv_scf[l-2]+2]>l;)i--;i<0&&(i=j[a][1]),e.bv_scf[l-1]=i}}}function h1(){}function g1(){this.setModules=function($,j,C){};var V=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.updateMusicCRC=function($,j,C,f1){for(var n=0;n<f1;++n)$[0]=(o=j[C+n],r=(r=$[0])>>8^V[255&(r^o)]);var o,r}}function b1(){var V=this,$=null,j=null;this.setModules=function(t,e,l,i){$=l,j=i};var C=null,f1=0,n=0,o=0;function r(t,e,l){for(;0<l;){var i;o==0&&(o=8,n++,t.header[t.w_ptr].write_timing==f1&&(a=t,o1.arraycopy(a.header[a.w_ptr].buf,0,C,n,a.sideinfo_len),n+=a.sideinfo_len,f1+=8*a.sideinfo_len,a.w_ptr=a.w_ptr+1&C1.MAX_HEADER_BUF-1),C[n]=0),i=Math.min(l,o),l-=i,o-=i,C[n]|=e>>l<<o,f1+=i}var a}function p(t,e){var l,i=t.internal_flags;if(8<=e&&(r(i,76,8),e-=8),8<=e&&(r(i,65,8),e-=8),8<=e&&(r(i,77,8),e-=8),8<=e&&(r(i,69,8),e-=8),32<=e){var a=$.getLameShortVersion();if(32<=e)for(l=0;l<a.length&&8<=e;++l)e-=8,r(i,a.charCodeAt(l),8)}for(;1<=e;e-=1)r(i,i.ancillary_flag,1),i.ancillary_flag^=t.disable_reservoir?0:1}function s(t,e,l){for(var i=t.header[t.h_ptr].ptr;0<l;){var a=Math.min(l,8-(7&i));l-=a,t.header[t.h_ptr].buf[i>>3]|=e>>l<<8-(7&i)-a,i+=a}t.header[t.h_ptr].ptr=i}function g(t,e){var l,i=X.ht[e.count1table_select+32],a=0,_=e.big_values,v=e.big_values;for(l=(e.count1-e.big_values)/4;0<l;--l){var u=0,c=0;e.l3_enc[_+0]!=0&&(c+=8,e.xr[v+0]<0&&u++),e.l3_enc[_+1]!=0&&(c+=4,u*=2,e.xr[v+1]<0&&u++),e.l3_enc[_+2]!=0&&(c+=2,u*=2,e.xr[v+2]<0&&u++),e.l3_enc[_+3]!=0&&(c++,u*=2,e.xr[v+3]<0&&u++),_+=4,v+=4,r(t,u+i.table[c],i.hlen[c]),a+=i.hlen[c]}return a}function A(t,e,l,i,a){var _=X.ht[e],v=0;if(e==0)return v;for(var u=l;u<i;u+=2){var c=0,b=0,h=_.xlen,d=_.xlen,m=0,f=a.l3_enc[u],S=a.l3_enc[u+1];if(f!=0&&(a.xr[u]<0&&m++,c--),15<e){if(14<f){var T=f-15;m|=T<<1,b=h,f=15}if(14<S){var R=S-15;m<<=h,m|=R,b+=h,S=15}d=16}S!=0&&(m<<=1,a.xr[u+1]<0&&m++,c--),f=f*d+S,b-=c,c+=_.hlen[f],r(t,_.table[f],c),r(t,m,b),v+=c+b}return v}function q(t,e){var l=3*t.scalefac_band.s[3];l>e.big_values&&(l=e.big_values);var i=A(t,e.table_select[0],0,l,e);return i+=A(t,e.table_select[1],l,e.big_values,e)}function O(t,e){var l,i,a,_;l=e.big_values;var v=e.region0_count+1;return a=t.scalefac_band.l[v],v+=e.region1_count+1,_=t.scalefac_band.l[v],l<a&&(a=l),l<_&&(_=l),i=A(t,e.table_select[0],0,a,e),i+=A(t,e.table_select[1],a,_,e),i+=A(t,e.table_select[2],_,l,e)}function L(){this.total=0}function k(t,e){var l,i,a,_=t.internal_flags;return _.w_ptr,(a=_.h_ptr-1)==-1&&(a=C1.MAX_HEADER_BUF-1),l=_.header[a].write_timing-f1,0<=(e.total=l)&&a1(),i=V.getframebits(t),l+=i,e.total+=i,e.total%8!=0?e.total=1+e.total/8:e.total=e.total/8,e.total+=n+1,l}this.getframebits=function(t){var e,l=t.internal_flags;e=l.bitrate_index!=0?X.bitrate_table[t.version][l.bitrate_index]:t.brate;var i=0|72e3*(t.version+1)*e/t.out_samplerate+l.padding;return 8*i},this.flush_bitstream=function(t){var e,l,i=t.internal_flags;i.h_ptr-1,e=i.l3_side,(l=k(t,new L))<0||(p(t,l),i.ResvSize=0,e.main_data_begin=0,i.findReplayGain&&a1(),i.findPeakSample&&a1())},this.format_bitstream=function(t){var e,l=t.internal_flags;e=l.l3_side;var i=this.getframebits(t);p(t,e.resvDrain_pre),function(v,u){var c,b,h,d=v.internal_flags;if(c=d.l3_side,d.header[d.h_ptr].ptr=0,N1.fill(d.header[d.h_ptr].buf,0,d.sideinfo_len,0),v.out_samplerate<16e3?s(d,4094,12):s(d,4095,12),s(d,v.version,1),s(d,1,2),s(d,v.error_protection?0:1,1),s(d,d.bitrate_index,4),s(d,d.samplerate_index,2),s(d,d.padding,1),s(d,v.extension,1),s(d,v.mode.ordinal(),2),s(d,d.mode_ext,2),s(d,v.copyright,1),s(d,v.original,1),s(d,v.emphasis,2),v.error_protection&&s(d,0,16),v.version==1){for(s(d,c.main_data_begin,9),d.channels_out==2?s(d,c.private_bits,3):s(d,c.private_bits,5),h=0;h<d.channels_out;h++){var m;for(m=0;m<4;m++)s(d,c.scfsi[h][m],1)}for(b=0;b<2;b++)for(h=0;h<d.channels_out;h++){var f=c.tt[b][h];s(d,f.part2_3_length+f.part2_length,12),s(d,f.big_values/2,9),s(d,f.global_gain,8),s(d,f.scalefac_compress,4),f.block_type!=M.NORM_TYPE?(s(d,1,1),s(d,f.block_type,2),s(d,f.mixed_block_flag,1),f.table_select[0]==14&&(f.table_select[0]=16),s(d,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),s(d,f.table_select[1],5),s(d,f.subblock_gain[0],3),s(d,f.subblock_gain[1],3),s(d,f.subblock_gain[2],3)):(s(d,0,1),f.table_select[0]==14&&(f.table_select[0]=16),s(d,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),s(d,f.table_select[1],5),f.table_select[2]==14&&(f.table_select[2]=16),s(d,f.table_select[2],5),s(d,f.region0_count,4),s(d,f.region1_count,3)),s(d,f.preflag,1),s(d,f.scalefac_scale,1),s(d,f.count1table_select,1)}}else for(s(d,c.main_data_begin,8),s(d,c.private_bits,d.channels_out),h=b=0;h<d.channels_out;h++){var f=c.tt[b][h];s(d,f.part2_3_length+f.part2_length,12),s(d,f.big_values/2,9),s(d,f.global_gain,8),s(d,f.scalefac_compress,9),f.block_type!=M.NORM_TYPE?(s(d,1,1),s(d,f.block_type,2),s(d,f.mixed_block_flag,1),f.table_select[0]==14&&(f.table_select[0]=16),s(d,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),s(d,f.table_select[1],5),s(d,f.subblock_gain[0],3),s(d,f.subblock_gain[1],3),s(d,f.subblock_gain[2],3)):(s(d,0,1),f.table_select[0]==14&&(f.table_select[0]=16),s(d,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),s(d,f.table_select[1],5),f.table_select[2]==14&&(f.table_select[2]=16),s(d,f.table_select[2],5),s(d,f.region0_count,4),s(d,f.region1_count,3)),s(d,f.scalefac_scale,1),s(d,f.count1table_select,1)}v.error_protection&&a1();var S=d.h_ptr;d.h_ptr=S+1&C1.MAX_HEADER_BUF-1,d.header[d.h_ptr].write_timing=d.header[S].write_timing+u,d.h_ptr,d.w_ptr}(t,i);var a=8*l.sideinfo_len;if(a+=function(v){var u,c,b,h,d=0,m=v.internal_flags,f=m.l3_side;if(v.version==1)for(u=0;u<2;u++)for(c=0;c<m.channels_out;c++){var S=f.tt[u][c],T=u1.slen1_tab[S.scalefac_compress],R=u1.slen2_tab[S.scalefac_compress];for(b=h=0;b<S.sfbdivide;b++)S.scalefac[b]!=-1&&(r(m,S.scalefac[b],T),h+=T);for(;b<S.sfbmax;b++)S.scalefac[b]!=-1&&(r(m,S.scalefac[b],R),h+=R);S.block_type==M.SHORT_TYPE?h+=q(m,S):h+=O(m,S),h+=g(m,S),d+=h}else for(c=u=0;c<m.channels_out;c++){var P,I,S=f.tt[u][c],y=0;if(I=b=h=0,S.block_type==M.SHORT_TYPE){for(;I<4;I++){var w=S.sfb_partition_table[I]/3,x=S.slen[I];for(P=0;P<w;P++,b++)r(m,Math.max(S.scalefac[3*b+0],0),x),r(m,Math.max(S.scalefac[3*b+1],0),x),r(m,Math.max(S.scalefac[3*b+2],0),x),y+=3*x}h+=q(m,S)}else{for(;I<4;I++){var w=S.sfb_partition_table[I],x=S.slen[I];for(P=0;P<w;P++,b++)r(m,Math.max(S.scalefac[b],0),x),y+=x}h+=O(m,S)}h+=g(m,S),d+=y+h}return d}(t),p(t,e.resvDrain_post),a+=e.resvDrain_post,e.main_data_begin+=(i-a)/8,k(t,new L),l.ResvSize,8*e.main_data_begin!=l.ResvSize&&(l.ResvSize=8*e.main_data_begin),1e9<f1){var _;for(_=0;_<C1.MAX_HEADER_BUF;++_)l.header[_].write_timing-=f1;f1=0}return 0},this.copy_buffer=function(t,e,l,i,a){var _=n+1;if(_<=0)return 0;if(i!=0&&i<_)return-1;if(o1.arraycopy(C,0,e,l,_),n=-1,(o=0)!=a){var v=l1(1);v[0]=t.nMusicCRC,j.updateMusicCRC(v,e,l,_),t.nMusicCRC=v[0],0<_&&(t.VBR_seek_table.nBytesWritten+=_),t.decode_on_the_fly&&a1()}return _},this.init_bit_stream_w=function(t){C=S1(_1.LAME_MAXMP3BUFFER),t.h_ptr=t.w_ptr=0,t.header[t.h_ptr].write_timing=0,n=-1,f1=o=0}}function s1(V,$,j,C){this.xlen=V,this.linmax=$,this.table=j,this.hlen=C}k1.MAX_VALUE=34028235e31,Y.vbr_off=new Y(0),Y.vbr_mt=new Y(1),Y.vbr_rh=new Y(2),Y.vbr_abr=new Y(3),Y.vbr_mtrh=new Y(4),Y.vbr_default=Y.vbr_mtrh,r1.STEREO=new r1(0),r1.JOINT_STEREO=new r1(1),r1.DUAL_CHANNEL=new r1(2),r1.MONO=new r1(3),r1.NOT_SET=new r1(4),h1.STEPS_per_dB=100,h1.MAX_dB=120,h1.GAIN_NOT_ENOUGH_SAMPLES=-24601,h1.GAIN_ANALYSIS_ERROR=0,h1.GAIN_ANALYSIS_OK=1,h1.INIT_GAIN_ANALYSIS_ERROR=0,h1.INIT_GAIN_ANALYSIS_OK=1,h1.MAX_ORDER=h1.YULE_ORDER=10,h1.MAX_SAMPLES_PER_WINDOW=(h1.MAX_SAMP_FREQ=48e3)*(h1.RMS_WINDOW_TIME_NUMERATOR=1)/(h1.RMS_WINDOW_TIME_DENOMINATOR=20)+1,g1.NUMTOCENTRIES=100,g1.MAXFRAMESIZE=2880,b1.EQ=function(V,$){return Math.abs(V)>Math.abs($)?Math.abs(V-$)<=1e-6*Math.abs(V):Math.abs(V-$)<=1e-6*Math.abs($)},b1.NEQ=function(V,$){return!b1.EQ(V,$)};var X={};function E1(V){this.bits=V}function L1(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function y1(V,$,j,C){this.l=l1(1+M.SBMAX_l),this.s=l1(1+M.SBMAX_s),this.psfb21=l1(1+M.PSFB21),this.psfb12=l1(1+M.PSFB12);var f1=this.l,n=this.s;arguments.length==4&&(this.arrL=V,this.arrS=$,this.arr21=j,this.arr12=C,o1.arraycopy(this.arrL,0,f1,0,Math.min(this.arrL.length,this.l.length)),o1.arraycopy(this.arrS,0,n,0,Math.min(this.arrS.length,this.s.length)),o1.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),o1.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function M1(){var V=null,$=null,j=null;this.setModules=function(t,e,l){V=t,$=e,j=l},this.IPOW20=function(t){return A[t]};var C=2220446049250313e-31,f1=M1.IXMAX_VAL,n=f1+2,o=M1.Q_MAX,r=M1.Q_MAX2,p=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var s=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=s,this.sfBandIndex=[new y1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new y1([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var g=i1(o+r+1),A=i1(o),q=i1(n),O=i1(n);function L(t,e){var l=j.ATHformula(e,t);return l-=p,l=Math.pow(10,l/10+t.ATHlower)}function k(t){this.s=t}this.adj43=O,this.iteration_init=function(t){var e,l=t.internal_flags,i=l.l3_side;if(l.iteration_init_init==0){for(l.iteration_init_init=1,i.main_data_begin=0,function(b){for(var h=b.internal_flags.ATH.l,d=b.internal_flags.ATH.psfb21,m=b.internal_flags.ATH.s,f=b.internal_flags.ATH.psfb12,S=b.internal_flags,T=b.out_samplerate,R=0;R<M.SBMAX_l;R++){var P=S.scalefac_band.l[R],I=S.scalefac_band.l[R+1];h[R]=k1.MAX_VALUE;for(var y=P;y<I;y++){var w=y*T/1152,x=L(b,w);h[R]=Math.min(h[R],x)}}for(var R=0;R<M.PSFB21;R++){var P=S.scalefac_band.psfb21[R],I=S.scalefac_band.psfb21[R+1];d[R]=k1.MAX_VALUE;for(var y=P;y<I;y++){var w=y*T/1152,x=L(b,w);d[R]=Math.min(d[R],x)}}for(var R=0;R<M.SBMAX_s;R++){var P=S.scalefac_band.s[R],I=S.scalefac_band.s[R+1];m[R]=k1.MAX_VALUE;for(var y=P;y<I;y++){var w=y*T/384,x=L(b,w);m[R]=Math.min(m[R],x)}m[R]*=S.scalefac_band.s[R+1]-S.scalefac_band.s[R]}for(var R=0;R<M.PSFB12;R++){var P=S.scalefac_band.psfb12[R],I=S.scalefac_band.psfb12[R+1];f[R]=k1.MAX_VALUE;for(var y=P;y<I;y++){var w=y*T/384,x=L(b,w);f[R]=Math.min(f[R],x)}f[R]*=S.scalefac_band.s[13]-S.scalefac_band.s[12]}b.noATH&&a1(),S.ATH.floor=10*q1(L(b,-1))}(t),q[0]=0,e=1;e<n;e++)q[e]=Math.pow(e,4/3);for(e=0;e<n-1;e++)O[e]=e+1-Math.pow(.5*(q[e]+q[e+1]),.75);for(O[e]=.5,e=0;e<o;e++)A[e]=Math.pow(2,-.1875*(e-210));for(e=0;e<=o+r;e++)g[e]=Math.pow(2,.25*(e-210-r));var a,_,v,u;for(V.huffman_init(l),32<=(e=t.exp_nspsytune>>2&63)&&(e-=64),a=Math.pow(10,e/4/10),32<=(e=t.exp_nspsytune>>8&63)&&(e-=64),_=Math.pow(10,e/4/10),32<=(e=t.exp_nspsytune>>14&63)&&(e-=64),v=Math.pow(10,e/4/10),32<=(e=t.exp_nspsytune>>20&63)&&(e-=64),u=v*Math.pow(10,e/4/10),e=0;e<M.SBMAX_l;e++)c=e<=6?a:e<=13?_:e<=20?v:u,l.nsPsy.longfact[e]=c;for(e=0;e<M.SBMAX_s;e++){var c;c=e<=5?a:e<=10?_:e<=11?v:u,l.nsPsy.shortfact[e]=c}}},this.on_pe=function(t,e,l,i,a,_){var v,u,c=t.internal_flags,b=0,h=l1(2),d=new E1(b),m=$.ResvMaxBits(t,i,d,_),f=(b=d.bits)+m;for(C1.MAX_BITS_PER_GRANULE<f&&(f=C1.MAX_BITS_PER_GRANULE),u=v=0;u<c.channels_out;++u)l[u]=Math.min(C1.MAX_BITS_PER_CHANNEL,b/c.channels_out),h[u]=0|l[u]*e[a][u]/700-l[u],h[u]>3*i/4&&(h[u]=3*i/4),h[u]<0&&(h[u]=0),h[u]+l[u]>C1.MAX_BITS_PER_CHANNEL&&(h[u]=Math.max(0,C1.MAX_BITS_PER_CHANNEL-l[u])),v+=h[u];if(m<v)for(u=0;u<c.channels_out;++u)h[u]=m*h[u]/v;for(u=0;u<c.channels_out;++u)l[u]+=h[u],m-=h[u];for(u=v=0;u<c.channels_out;++u)v+=l[u];return C1.MAX_BITS_PER_GRANULE<v&&a1(),f},this.athAdjust=function(t,e,l){var i=90.30873362,a=v1.FAST_LOG10_X(e,10),_=t*t,v=0;return a-=l,1e-20<_&&(v=1+v1.FAST_LOG10_X(_,10/i)),v<0&&(v=0),a*=v,a+=l+i-94.82444863,Math.pow(10,.1*a)},this.calc_xmin=function(t,e,l,i){var a,_=0,v=t.internal_flags,u=0,c=0,b=v.ATH,h=l.xr,d=t.VBR==Y.vbr_mtrh?1:0,m=v.masking_lower;for(t.VBR!=Y.vbr_mtrh&&t.VBR!=Y.vbr_mt||(m=1),a=0;a<l.psy_lmax;a++){for(w=t.VBR==Y.vbr_rh||t.VBR==Y.vbr_mtrh?athAdjust(b.adjust,b.l[a],b.floor):b.adjust*b.l[a],P=l.width[a],x=w/P,D=C,B=P>>1,N=0;E=h[u]*h[u],N+=E,D+=E<x?E:x,H=h[++u]*h[u],N+=H,D+=H<x?H:x,u++,0<--B;);if(w<N&&c++,a==M.SBPSY_l&&a1(),d!=0&&(w=D),!t.ATHonly){var f=e.en.l[a];0<f&&(F=N*e.thm.l[a]*m/f,d!=0&&(F*=v.nsPsy.longfact[a]),w<F&&(w=F))}i[_++]=d!=0?w:w*v.nsPsy.longfact[a]}var S=575;if(l.block_type!=M.SHORT_TYPE)for(var T=576;T--!=0&&b1.EQ(h[T],0);)S=T;l.max_nonzero_coeff=S;for(var R=l.sfb_smin;a<l.psymax;R++,a+=3){var P,I,y;for(y=t.VBR==Y.vbr_rh||t.VBR==Y.vbr_mtrh?athAdjust(b.adjust,b.s[R],b.floor):b.adjust*b.s[R],P=l.width[a],I=0;I<3;I++){var w,x,D,N=0,B=P>>1;x=y/P,D=C;do{var E,H;E=h[u]*h[u],N+=E,D+=E<x?E:x,H=h[++u]*h[u],N+=H,D+=H<x?H:x,u++}while(0<--B);if(y<N&&c++,R==M.SBPSY_s&&a1(),w=d!=0?D:y,!t.ATHonly&&!t.ATHshort){var F,f=e.en.s[R][I];0<f&&(F=N*e.thm.s[R][I]*m/f,d!=0&&(F*=v.nsPsy.shortfact[R]),w<F&&(w=F))}i[_++]=d!=0?w:w*v.nsPsy.shortfact[R]}t.useTemporal&&(i[_-3]>i[_-3+1]&&(i[_-3+1]+=(i[_-3]-i[_-3+1])*v.decay),i[_-3+1]>i[_-3+2]&&(i[_-3+2]+=(i[_-3+1]-i[_-3+2])*v.decay))}return c},this.calc_noise_core=function(t,e,l,i){var a=0,_=e.s,v=t.l3_enc;if(_>t.count1)for(;l--!=0;)c=t.xr[_],_++,a+=c*c,c=t.xr[_],_++,a+=c*c;else if(_>t.big_values){var u=i1(2);for(u[0]=0,u[1]=i;l--!=0;)c=Math.abs(t.xr[_])-u[v[_]],_++,a+=c*c,c=Math.abs(t.xr[_])-u[v[_]],_++,a+=c*c}else for(;l--!=0;){var c;c=Math.abs(t.xr[_])-q[v[_]]*i,_++,a+=c*c,c=Math.abs(t.xr[_])-q[v[_]]*i,_++,a+=c*c}return e.s=_,a},this.calc_noise=function(t,e,l,i,a){var _,v,u=0,c=0,b=0,h=0,d=0,m=-20,f=0,S=t.scalefac,T=0;for(i.over_SSD=0,_=0;_<t.psymax;_++){var R,P=t.global_gain-(S[T++]+(t.preflag!=0?s[_]:0)<<t.scalefac_scale+1)-8*t.subblock_gain[t.window[_]],I=0;if(a!=null&&a.step[_]==P)I=a.noise[_],f+=t.width[_],l[u++]=I/e[c++],I=a.noise_log[_];else{var y,w=g[P+M1.Q_MAX2];v=t.width[_]>>1,f+t.width[_]>t.max_nonzero_coeff&&(y=t.max_nonzero_coeff-f+1,v=0<y?y>>1:0);var x=new k(f);I=this.calc_noise_core(t,x,v,w),f=x.s,a!=null&&(a.step[_]=P,a.noise[_]=I),I=l[u++]=I/e[c++],I=v1.FAST_LOG10(Math.max(I,1e-20)),a!=null&&(a.noise_log[_]=I)}a!=null&&(a.global_gain=t.global_gain),d+=I,0<I&&(R=Math.max(0|10*I+.5,1),i.over_SSD+=R*R,b++,h+=I),m=Math.max(m,I)}return i.over_count=b,i.tot_noise=d,i.over_noise=h,i.max_noise=m,b}}function I1(){this.xr=i1(576),this.l3_enc=l1(576),this.scalefac=l1(m1.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=l1(3),this.subblock_gain=l1(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=l1(m1.SFBMAX),this.window=l1(m1.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=l1(4),this.max_nonzero_coeff=0;var V=this;function $(j){return new Int32Array(j)}this.assign=function(j){var C;V.xr=(C=j.xr,new Float32Array(C)),V.l3_enc=$(j.l3_enc),V.scalefac=$(j.scalefac),V.xrpow_max=j.xrpow_max,V.part2_3_length=j.part2_3_length,V.big_values=j.big_values,V.count1=j.count1,V.global_gain=j.global_gain,V.scalefac_compress=j.scalefac_compress,V.block_type=j.block_type,V.mixed_block_flag=j.mixed_block_flag,V.table_select=$(j.table_select),V.subblock_gain=$(j.subblock_gain),V.region0_count=j.region0_count,V.region1_count=j.region1_count,V.preflag=j.preflag,V.scalefac_scale=j.scalefac_scale,V.count1table_select=j.count1table_select,V.part2_length=j.part2_length,V.sfb_lmax=j.sfb_lmax,V.sfb_smin=j.sfb_smin,V.psy_lmax=j.psy_lmax,V.sfbmax=j.sfbmax,V.psymax=j.psymax,V.sfbdivide=j.sfbdivide,V.width=$(j.width),V.window=$(j.window),V.count1bits=j.count1bits,V.sfb_partition_table=j.sfb_partition_table.slice(0),V.slen=$(j.slen),V.max_nonzero_coeff=j.max_nonzero_coeff}}X.t1HB=[1,1,1,0],X.t2HB=[1,2,1,3,1,1,3,2,0],X.t3HB=[3,2,1,1,1,1,3,2,0],X.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],X.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],X.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],X.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],X.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],X.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],X.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],X.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],X.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],X.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],X.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],X.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],X.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],X.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],X.t1l=[1,4,3,5],X.t2l=[1,4,7,4,5,7,6,7,8],X.t3l=[2,3,7,4,4,7,6,7,8],X.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],X.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],X.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],X.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],X.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],X.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],X.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],X.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],X.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],X.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],X.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],X.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],X.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],X.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],X.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],X.ht=[new s1(0,0,null,null),new s1(2,0,X.t1HB,X.t1l),new s1(3,0,X.t2HB,X.t2l),new s1(3,0,X.t3HB,X.t3l),new s1(0,0,null,null),new s1(4,0,X.t5HB,X.t5l),new s1(4,0,X.t6HB,X.t6l),new s1(6,0,X.t7HB,X.t7l),new s1(6,0,X.t8HB,X.t8l),new s1(6,0,X.t9HB,X.t9l),new s1(8,0,X.t10HB,X.t10l),new s1(8,0,X.t11HB,X.t11l),new s1(8,0,X.t12HB,X.t12l),new s1(16,0,X.t13HB,X.t13l),new s1(0,0,null,X.t16_5l),new s1(16,0,X.t15HB,X.t15l),new s1(1,1,X.t16HB,X.t16l),new s1(2,3,X.t16HB,X.t16l),new s1(3,7,X.t16HB,X.t16l),new s1(4,15,X.t16HB,X.t16l),new s1(6,63,X.t16HB,X.t16l),new s1(8,255,X.t16HB,X.t16l),new s1(10,1023,X.t16HB,X.t16l),new s1(13,8191,X.t16HB,X.t16l),new s1(4,15,X.t24HB,X.t24l),new s1(5,31,X.t24HB,X.t24l),new s1(6,63,X.t24HB,X.t24l),new s1(7,127,X.t24HB,X.t24l),new s1(8,255,X.t24HB,X.t24l),new s1(9,511,X.t24HB,X.t24l),new s1(11,2047,X.t24HB,X.t24l),new s1(13,8191,X.t24HB,X.t24l),new s1(0,0,X.t32HB,X.t32l),new s1(0,0,X.t33HB,X.t33l)],X.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],X.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],X.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],X.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],X.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],X.scfsi_band=[0,6,11,16,21],M1.Q_MAX=257,M1.Q_MAX2=116,M1.LARGE_BITS=1e5,M1.IXMAX_VAL=8206;var m1={};function n1(){var V,$;this.rv=null,this.qupvt=null;var j,C=new function(){this.setModules=function(p,s){}};function f1(p){this.ordinal=p}function n(p){for(var s=0;s<p.sfbmax;s++)if(p.scalefac[s]+p.subblock_gain[p.window[s]]==0)return!1;return!0}function o(p,s,g,A,q){var O;switch(p){default:case 9:0<s.over_count?(O=g.over_SSD<=s.over_SSD,g.over_SSD==s.over_SSD&&(O=g.bits<s.bits)):O=g.max_noise<0&&10*g.max_noise+g.bits<=10*s.max_noise+s.bits;break;case 0:O=g.over_count<s.over_count||g.over_count==s.over_count&&g.over_noise<s.over_noise||g.over_count==s.over_count&&b1.EQ(g.over_noise,s.over_noise)&&g.tot_noise<s.tot_noise;break;case 8:a1();case 1:O=g.max_noise<s.max_noise;break;case 2:O=g.tot_noise<s.tot_noise;break;case 3:O=g.tot_noise<s.tot_noise&&g.max_noise<s.max_noise;break;case 4:O=g.max_noise<=0&&.2<s.max_noise||g.max_noise<=0&&s.max_noise<0&&s.max_noise>g.max_noise-.2&&g.tot_noise<s.tot_noise||g.max_noise<=0&&0<s.max_noise&&s.max_noise>g.max_noise-.2&&g.tot_noise<s.tot_noise+s.over_noise||0<g.max_noise&&-.05<s.max_noise&&s.max_noise>g.max_noise-.1&&g.tot_noise+g.over_noise<s.tot_noise+s.over_noise||0<g.max_noise&&-.1<s.max_noise&&s.max_noise>g.max_noise-.15&&g.tot_noise+g.over_noise+g.over_noise<s.tot_noise+s.over_noise+s.over_noise;break;case 5:O=g.over_noise<s.over_noise||b1.EQ(g.over_noise,s.over_noise)&&g.tot_noise<s.tot_noise;break;case 6:O=g.over_noise<s.over_noise||b1.EQ(g.over_noise,s.over_noise)&&(g.max_noise<s.max_noise||b1.EQ(g.max_noise,s.max_noise)&&g.tot_noise<=s.tot_noise);break;case 7:O=g.over_count<s.over_count||g.over_noise<s.over_noise}return s.over_count==0&&(O=O&&g.bits<s.bits),O}function r(p,s,g,A,q){var O=p.internal_flags;(function(k,t,e,l,i){var a,_=k.internal_flags;a=t.scalefac_scale==0?1.2968395546510096:1.6817928305074292;for(var v=0,u=0;u<t.sfbmax;u++)v<e[u]&&(v=e[u]);var c=_.noise_shaping_amp;switch(c==3&&a1(),c){case 2:break;case 1:1<v?v=Math.pow(v,.5):v*=.95;break;case 0:default:1<v?v=1:v*=.95}for(var b=0,u=0;u<t.sfbmax;u++){var h,d=t.width[u];if(b+=d,!(e[u]<v)){for(2&_.substep_shaping&&a1(),t.scalefac[u]++,h=-d;h<0;h++)l[b+h]*=a,l[b+h]>t.xrpow_max&&(t.xrpow_max=l[b+h]);if(_.noise_shaping_amp==2)return}}})(p,s,g,A);var L=n(s);return!(L||(L=O.mode_gr==2?j.scale_bitcount(s):j.scale_bitcount_lsf(O,s))&&(1<O.noise_shaping&&(N1.fill(O.pseudohalf,0),s.scalefac_scale==0?(function(k,t){for(var e=0,l=0;l<k.sfbmax;l++){var i=k.width[l],a=k.scalefac[l];if(k.preflag!=0&&(a+=$.pretab[l]),e+=i,(1&a)!=0){a++;for(var _=-i;_<0;_++)t[e+_]*=1.2968395546510096,t[e+_]>k.xrpow_max&&(k.xrpow_max=t[e+_])}k.scalefac[l]=a>>1}k.preflag=0,k.scalefac_scale=1}(s,A),L=!1):s.block_type==M.SHORT_TYPE&&0<O.subblock_gain&&(L=function(k,t,e){var l,i=t.scalefac;for(l=0;l<t.sfb_lmax;l++)if(16<=i[l])return!0;for(var a=0;a<3;a++){var _=0,v=0;for(l=t.sfb_lmax+a;l<t.sfbdivide;l+=3)_<i[l]&&(_=i[l]);for(;l<t.sfbmax;l+=3)v<i[l]&&(v=i[l]);if(!(_<16&&v<8)){if(7<=t.subblock_gain[a])return!0;t.subblock_gain[a]++;var u=k.scalefac_band.l[t.sfb_lmax];for(l=t.sfb_lmax+a;l<t.sfbmax;l+=3){var c=t.width[l],b=i[l];if(0<=(b-=4>>t.scalefac_scale))i[l]=b,u+=3*c;else{i[l]=0;var h=210+(b<<t.scalefac_scale+1);m=$.IPOW20(h),u+=c*(a+1);for(var d=-c;d<0;d++)e[u+d]*=m,e[u+d]>t.xrpow_max&&(t.xrpow_max=e[u+d]);u+=c*(3-a-1)}}var m=$.IPOW20(202);u+=t.width[l]*(a+1);for(var d=-t.width[l];d<0;d++)e[u+d]*=m,e[u+d]>t.xrpow_max&&(t.xrpow_max=e[u+d])}}return!1}(O,s,A)||n(s))),L||(L=O.mode_gr==2?j.scale_bitcount(s):j.scale_bitcount_lsf(O,s)),L))}this.setModules=function(p,s,g,A){V=s,this.rv=s,$=g,this.qupvt=g,j=A,C.setModules($,j)},this.init_xrpow=function(p,s,g){var A=0,q=0|s.max_nonzero_coeff;if(s.xrpow_max=0,N1.fill(g,q,576,0),1e-20<(A=function(k,t,e,l){for(var i=l=0;i<=e;++i){var a=Math.abs(k.xr[i]);l+=a,t[i]=Math.sqrt(a*Math.sqrt(a)),t[i]>k.xrpow_max&&(k.xrpow_max=t[i])}return l}(s,g,q,A))){var O=0;2&p.substep_shaping&&(O=1);for(var L=0;L<s.psymax;L++)p.pseudohalf[L]=O;return!0}return N1.fill(s.l3_enc,0,576,0),!1},this.init_outer_loop=function(p,s){s.part2_3_length=0,s.big_values=0,s.count1=0,s.global_gain=210,s.scalefac_compress=0,s.table_select[0]=0,s.table_select[1]=0,s.table_select[2]=0,s.subblock_gain[0]=0,s.subblock_gain[1]=0,s.subblock_gain[2]=0,s.subblock_gain[3]=0,s.region0_count=0,s.region1_count=0,s.preflag=0,s.scalefac_scale=0,s.count1table_select=0,s.part2_length=0,s.sfb_lmax=M.SBPSY_l,s.sfb_smin=M.SBPSY_s,s.psy_lmax=p.sfb21_extra?M.SBMAX_l:M.SBPSY_l,s.psymax=s.psy_lmax,s.sfbmax=s.sfb_lmax,s.sfbdivide=11;for(var g=0;g<M.SBMAX_l;g++)s.width[g]=p.scalefac_band.l[g+1]-p.scalefac_band.l[g],s.window[g]=3;if(s.block_type==M.SHORT_TYPE){var A=i1(576);s.sfb_smin=0,(s.sfb_lmax=0)!=s.mixed_block_flag&&a1(),s.psymax=s.sfb_lmax+3*((p.sfb21_extra?M.SBMAX_s:M.SBPSY_s)-s.sfb_smin),s.sfbmax=s.sfb_lmax+3*(M.SBPSY_s-s.sfb_smin),s.sfbdivide=s.sfbmax-18,s.psy_lmax=s.sfb_lmax;var q=p.scalefac_band.l[s.sfb_lmax];o1.arraycopy(s.xr,0,A,0,576);for(var g=s.sfb_smin;g<M.SBMAX_s;g++)for(var O=p.scalefac_band.s[g],L=p.scalefac_band.s[g+1],k=0;k<3;k++)for(var t=O;t<L;t++)s.xr[q++]=A[3*t+k];for(var e=s.sfb_lmax,g=s.sfb_smin;g<M.SBMAX_s;g++)s.width[e]=s.width[e+1]=s.width[e+2]=p.scalefac_band.s[g+1]-p.scalefac_band.s[g],s.window[e]=0,s.window[e+1]=1,s.window[e+2]=2,e+=3}s.count1bits=0,s.sfb_partition_table=$.nr_of_sfb_block[0][0],s.slen[0]=0,s.slen[1]=0,s.slen[2]=0,s.slen[3]=0,s.max_nonzero_coeff=575,N1.fill(s.scalefac,0),function(l,i){var a=l.ATH,_=i.xr;if(i.block_type!=M.SHORT_TYPE)for(var v=!1,u=M.PSFB21-1;0<=u&&!v;u--){var c=l.scalefac_band.psfb21[u],b=l.scalefac_band.psfb21[u+1],h=$.athAdjust(a.adjust,a.psfb21[u],a.floor);1e-12<l.nsPsy.longfact[21]&&(h*=l.nsPsy.longfact[21]);for(var d=b-1;c<=d;d--){if(!(Math.abs(_[d])<h)){v=!0;break}_[d]=0}}else for(var m=0;m<3;m++)for(var v=!1,u=M.PSFB12-1;0<=u&&!v;u--){var c=3*l.scalefac_band.s[12]+(l.scalefac_band.s[13]-l.scalefac_band.s[12])*m+(l.scalefac_band.psfb12[u]-l.scalefac_band.psfb12[0]),b=c+(l.scalefac_band.psfb12[u+1]-l.scalefac_band.psfb12[u]),f=$.athAdjust(a.adjust,a.psfb12[u],a.floor);1e-12<l.nsPsy.shortfact[12]&&(f*=l.nsPsy.shortfact[12]);for(var d=b-1;c<=d;d--){if(!(Math.abs(_[d])<f)){v=!0;break}_[d]=0}}}(p,s)},f1.BINSEARCH_NONE=new f1(0),f1.BINSEARCH_UP=new f1(1),f1.BINSEARCH_DOWN=new f1(2),this.outer_loop=function(p,s,g,A,q,O){var L=p.internal_flags,k=new I1,t=i1(576),e=i1(m1.SFBMAX),l=new L1,i=new function(){this.global_gain=0,this.sfb_count1=0,this.step=l1(39),this.noise=i1(39),this.noise_log=i1(39)},a=9999999,_=!1;if(function(d,m,f,S,T){var R,P=d.CurrentStep[S],I=!1,y=d.OldValue[S],w=f1.BINSEARCH_NONE;for(m.global_gain=y,f-=m.part2_length;;){var x;if(R=j.count_bits(d,T,m,null),P==1||R==f)break;f<R?(w==f1.BINSEARCH_DOWN&&(I=!0),I&&(P/=2),w=f1.BINSEARCH_UP,x=P):(w==f1.BINSEARCH_UP&&(I=!0),I&&(P/=2),w=f1.BINSEARCH_DOWN,x=-P),m.global_gain+=x,m.global_gain<0&&a1(),255<m.global_gain&&a1()}for(;f<R&&m.global_gain<255;)m.global_gain++,R=j.count_bits(d,T,m,null);d.CurrentStep[S]=4<=y-m.global_gain?4:2,d.OldValue[S]=m.global_gain,m.part2_3_length=R}(L,s,O,q,A),L.noise_shaping==0)return 100;$.calc_noise(s,g,e,l,i),l.bits=s.part2_3_length,k.assign(s);var v=0;for(o1.arraycopy(A,0,t,0,576);!_;){do{var u,c=new L1,b=255;if(u=2&L.substep_shaping?20:3,L.sfb21_extra&&a1(),!r(p,k,e,A))break;k.scalefac_scale!=0&&(b=254);var h=O-k.part2_length;if(h<=0)break;for(;(k.part2_3_length=j.count_bits(L,A,k,i))>h&&k.global_gain<=b;)k.global_gain++;if(k.global_gain>b)break;if(l.over_count==0){for(;(k.part2_3_length=j.count_bits(L,A,k,i))>a&&k.global_gain<=b;)k.global_gain++;if(k.global_gain>b)break}if($.calc_noise(k,g,e,c,i),c.bits=k.part2_3_length,(o(s.block_type!=M.SHORT_TYPE?p.quant_comp:p.quant_comp_short,l,c)?1:0)!=0)a=s.part2_3_length,l=c,s.assign(k),v=0,o1.arraycopy(A,0,t,0,576);else if(L.full_outer_loop==0){if(++v>u&&l.over_count==0)break;L.noise_shaping_amp,L.noise_shaping_amp}}while(k.global_gain+k.scalefac_scale<255);L.noise_shaping_amp==3?a1():_=!0}return p.VBR==Y.vbr_rh||p.VBR==Y.vbr_mtrh?o1.arraycopy(t,0,A,0,576):1&L.substep_shaping&&a1(),l.over_count},this.iteration_finish_one=function(p,s,g){var A=p.l3_side,q=A.tt[s][g];j.best_scalefac_store(p,s,g,A),p.use_best_huffman==1&&j.best_huffman_divide(p,q),V.ResvAdjust(p,q)}}function P1(){this.thm=new w1,this.en=new w1}function M(){var V=M.MPG_MD_MS_LR,$=null,j=this.psy=null,C=null;this.setModules=function(n,o,r,p){$=n,this.psy=o,j=o,C=p};var f1=new function(){var n=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*v1.SQRT2*.5/2384e-9,.017876148*v1.SQRT2*.5/2384e-9,.003134727*v1.SQRT2*.5/2384e-9,.002457142*v1.SQRT2*.5/2384e-9,971317e-9*v1.SQRT2*.5/2384e-9,218868e-9*v1.SQRT2*.5/2384e-9,101566e-9*v1.SQRT2*.5/2384e-9,13828e-9*v1.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],o=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],r=o[M.SHORT_TYPE],p=o[M.SHORT_TYPE],s=o[M.SHORT_TYPE],g=o[M.SHORT_TYPE],A=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function q(k,t,e){for(var l,i,a,_=10,v=t+238-14-286,u=-15;u<0;u++){var c,b,h;c=n[_+-10],b=k[v+-224]*c,h=k[t+224]*c,c=n[_+-9],b+=k[v+-160]*c,h+=k[t+160]*c,c=n[_+-8],b+=k[v+-96]*c,h+=k[t+96]*c,c=n[_+-7],b+=k[v+-32]*c,h+=k[t+32]*c,c=n[_+-6],b+=k[v+32]*c,h+=k[t+-32]*c,c=n[_+-5],b+=k[v+96]*c,h+=k[t+-96]*c,c=n[_+-4],b+=k[v+160]*c,h+=k[t+-160]*c,c=n[_+-3],b+=k[v+224]*c,h+=k[t+-224]*c,c=n[_+-2],b+=k[t+-256]*c,h-=k[v+256]*c,c=n[_+-1],b+=k[t+-192]*c,h-=k[v+192]*c,c=n[_+0],b+=k[t+-128]*c,h-=k[v+128]*c,c=n[_+1],b+=k[t+-64]*c,h-=k[v+64]*c,c=n[_+2],b+=k[t+0]*c,h-=k[v+0]*c,c=n[_+3],b+=k[t+64]*c,h-=k[v+-64]*c,c=n[_+4],b+=k[t+128]*c,h-=k[v+-128]*c,c=n[_+5],b+=k[t+192]*c,h-=k[v+-192]*c,b*=n[_+6],c=h-b,e[30+2*u]=h+b,e[31+2*u]=n[_+7]*c,_+=18,t--,v++}h=k[t+-16]*n[_+-10],b=k[t+-32]*n[_+-2],h+=(k[t+-48]-k[t+16])*n[_+-9],b+=k[t+-96]*n[_+-1],h+=(k[t+-80]+k[t+48])*n[_+-8],b+=k[t+-160]*n[_+0],h+=(k[t+-112]-k[t+80])*n[_+-7],b+=k[t+-224]*n[_+1],h+=(k[t+-144]+k[t+112])*n[_+-6],b-=k[t+32]*n[_+2],h+=(k[t+-176]-k[t+144])*n[_+-5],b-=k[t+96]*n[_+3],h+=(k[t+-208]+k[t+176])*n[_+-4],b-=k[t+160]*n[_+4],h+=(k[t+-240]-k[t+208])*n[_+-3],b-=k[t+224],l=b-h,i=b+h,h=e[14],b=e[15]-h,e[31]=i+h,e[30]=l+b,e[15]=l-b,e[14]=i-h,a=e[28]-e[0],e[0]+=e[28],e[28]=a*n[_+-36+7],a=e[29]-e[1],e[1]+=e[29],e[29]=a*n[_+-36+7],a=e[26]-e[2],e[2]+=e[26],e[26]=a*n[_+-72+7],a=e[27]-e[3],e[3]+=e[27],e[27]=a*n[_+-72+7],a=e[24]-e[4],e[4]+=e[24],e[24]=a*n[_+-108+7],a=e[25]-e[5],e[5]+=e[25],e[25]=a*n[_+-108+7],a=e[22]-e[6],e[6]+=e[22],e[22]=a*v1.SQRT2,a=e[23]-e[7],e[7]+=e[23],e[23]=a*v1.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],a=e[6],e[6]=e[31]-a,e[31]=e[31]+a,a=e[7],e[7]=e[30]-a,e[30]=e[30]+a,a=e[22],e[22]=e[15]-a,e[15]=e[15]+a,a=e[23],e[23]=e[14]-a,e[14]=e[14]+a,a=e[20]-e[8],e[8]+=e[20],e[20]=a*n[_+-180+7],a=e[21]-e[9],e[9]+=e[21],e[21]=a*n[_+-180+7],a=e[18]-e[10],e[10]+=e[18],e[18]=a*n[_+-216+7],a=e[19]-e[11],e[11]+=e[19],e[19]=a*n[_+-216+7],a=e[16]-e[12],e[12]+=e[16],e[16]=a*n[_+-252+7],a=e[17]-e[13],e[13]+=e[17],e[17]=a*n[_+-252+7],a=-e[20]+e[24],e[20]+=e[24],e[24]=a*n[_+-216+7],a=-e[21]+e[25],e[21]+=e[25],e[25]=a*n[_+-216+7],a=e[4]-e[8],e[4]+=e[8],e[8]=a*n[_+-216+7],a=e[5]-e[9],e[5]+=e[9],e[9]=a*n[_+-216+7],a=e[0]-e[12],e[0]+=e[12],e[12]=a*n[_+-72+7],a=e[1]-e[13],e[1]+=e[13],e[13]=a*n[_+-72+7],a=e[16]-e[28],e[16]+=e[28],e[28]=a*n[_+-72+7],a=-e[17]+e[29],e[17]+=e[29],e[29]=a*n[_+-72+7],a=v1.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=a,a=v1.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=a,a=v1.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=a-e[18],a=v1.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=a-e[19],a=e[2],e[19]-=e[3],e[3]-=a,e[2]=e[31]-a,e[31]+=a,a=e[3],e[11]-=e[19],e[18]-=a,e[3]=e[30]-a,e[30]+=a,a=e[18],e[27]-=e[11],e[19]-=a,e[18]=e[15]-a,e[15]+=a,a=e[19],e[10]-=a,e[19]=e[14]-a,e[14]+=a,a=e[10],e[11]-=a,e[10]=e[23]-a,e[23]+=a,a=e[11],e[26]-=a,e[11]=e[22]-a,e[22]+=a,a=e[26],e[27]-=a,e[26]=e[7]-a,e[7]+=a,a=e[27],e[27]=e[6]-a,e[6]+=a,a=v1.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=a,a=v1.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=a,a=v1.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=a,a=v1.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=a,a=-v1.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=a-e[8],a=-v1.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=a-e[9],a=-v1.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=a-e[25],a=-v1.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=a-e[24],a=e[24]-e[16],e[24]=a,a=e[20]-a,e[20]=a,a=e[28]-a,e[28]=a,a=e[25]-e[17],e[25]=a,a=e[21]-a,e[21]=a,a=e[29]-a,e[29]=a,a=e[17]-e[1],e[17]=a,a=e[9]-a,e[9]=a,a=e[25]-a,e[25]=a,a=e[5]-a,e[5]=a,a=e[21]-a,e[21]=a,a=e[13]-a,e[13]=a,a=e[29]-a,e[29]=a,a=e[1]-e[0],e[1]=a,a=e[16]-a,e[16]=a,a=e[17]-a,e[17]=a,a=e[8]-a,e[8]=a,a=e[9]-a,e[9]=a,a=e[24]-a,e[24]=a,a=e[25]-a,e[25]=a,a=e[4]-a,e[4]=a,a=e[5]-a,e[5]=a,a=e[20]-a,e[20]=a,a=e[21]-a,e[21]=a,a=e[12]-a,e[12]=a,a=e[13]-a,e[13]=a,a=e[28]-a,e[28]=a,a=e[29]-a,e[29]=a,a=e[0],e[0]+=e[31],e[31]-=a,a=e[1],e[1]+=e[30],e[30]-=a,a=e[16],e[16]+=e[15],e[15]-=a,a=e[17],e[17]+=e[14],e[14]-=a,a=e[8],e[8]+=e[23],e[23]-=a,a=e[9],e[9]+=e[22],e[22]-=a,a=e[24],e[24]+=e[7],e[7]-=a,a=e[25],e[25]+=e[6],e[6]-=a,a=e[4],e[4]+=e[27],e[27]-=a,a=e[5],e[5]+=e[26],e[26]-=a,a=e[20],e[20]+=e[11],e[11]-=a,a=e[21],e[21]+=e[10],e[10]-=a,a=e[12],e[12]+=e[19],e[19]-=a,a=e[13],e[13]+=e[18],e[18]-=a,a=e[28],e[28]+=e[3],e[3]-=a,a=e[29],e[29]+=e[2],e[2]-=a}function O(k,t){for(var e=0;e<3;e++){var l,i,a,_,v,u;_=k[t+6]*o[M.SHORT_TYPE][0]-k[t+15],l=k[t+0]*o[M.SHORT_TYPE][2]-k[t+9],i=_+l,a=_-l,_=k[t+15]*o[M.SHORT_TYPE][0]+k[t+6],l=k[t+9]*o[M.SHORT_TYPE][2]+k[t+0],v=_+l,u=-_+l,l=2069978111953089e-26*(k[t+3]*o[M.SHORT_TYPE][1]-k[t+12]),_=2069978111953089e-26*(k[t+12]*o[M.SHORT_TYPE][1]+k[t+3]),k[t+0]=190752519173728e-25*i+l,k[t+15]=190752519173728e-25*-v+_,a=.8660254037844387*a*1907525191737281e-26,v=.5*v*1907525191737281e-26+_,k[t+3]=a-v,k[t+6]=a+v,i=.5*i*1907525191737281e-26-l,u=.8660254037844387*u*1907525191737281e-26,k[t+9]=i+u,k[t+12]=i-u,t++}}function L(k,t,e){var l,i,a,_,v,u,c,b,h,d,m,f,S,T,R,P,I,y;a=e[17]-e[9],v=e[15]-e[11],u=e[14]-e[12],c=e[0]+e[8],b=e[1]+e[7],h=e[2]+e[6],d=e[3]+e[5],k[t+17]=c+h-d-(b-e[4]),i=(c+h-d)*p[19]+(b-e[4]),l=(a-v-u)*p[18],k[t+5]=l+i,k[t+6]=l-i,_=(e[16]-e[10])*p[18],b=b*p[19]+e[4],l=a*p[12]+_+v*p[13]+u*p[14],i=-c*p[16]+b-h*p[17]+d*p[15],k[t+1]=l+i,k[t+2]=l-i,l=a*p[13]-_-v*p[14]+u*p[12],i=-c*p[17]+b-h*p[15]+d*p[16],k[t+9]=l+i,k[t+10]=l-i,l=a*p[14]-_+v*p[12]-u*p[13],i=c*p[15]-b+h*p[16]-d*p[17],k[t+13]=l+i,k[t+14]=l-i,m=e[8]-e[0],S=e[6]-e[2],T=e[5]-e[3],R=e[17]+e[9],P=e[16]+e[10],I=e[15]+e[11],y=e[14]+e[12],k[t+0]=R+I+y+(P+e[13]),l=(R+I+y)*p[19]-(P+e[13]),i=(m-S+T)*p[18],k[t+11]=l+i,k[t+12]=l-i,f=(e[7]-e[1])*p[18],P=e[13]-P*p[19],l=R*p[15]-P+I*p[16]+y*p[17],i=m*p[14]+f+S*p[12]+T*p[13],k[t+3]=l+i,k[t+4]=l-i,l=-R*p[17]+P-I*p[15]-y*p[16],i=m*p[13]+f-S*p[14]-T*p[12],k[t+7]=l+i,k[t+8]=l-i,l=-R*p[16]+P-I*p[17]-y*p[15],i=m*p[12]-f+S*p[13]-T*p[14],k[t+15]=l+i,k[t+16]=l-i}this.mdct_sub48=function(k,t,e){for(var l=t,i=286,a=0;a<k.channels_out;a++){for(var _=0;_<k.mode_gr;_++){for(var v,u=k.l3_side.tt[_][a],c=u.xr,b=0,h=k.sb_sample[a][1-_],d=0,m=0;m<9;m++)for(q(l,i,h[d]),q(l,i+32,h[d+1]),d+=2,i+=64,v=1;v<32;v+=2)h[d-1][v]*=-1;for(v=0;v<32;v++,b+=18){var f=u.block_type,S=k.sb_sample[a][_],T=k.sb_sample[a][1-_];if(u.mixed_block_flag!=0&&v<2&&(f=0),k.amp_filter[v]<1e-12)N1.fill(c,b+0,b+18,0);else if(k.amp_filter[v]<1&&a1(),f==M.SHORT_TYPE){for(var m=-3;m<0;m++){var R=o[M.SHORT_TYPE][m+3];c[b+3*m+9]=S[9+m][A[v]]*R-S[8-m][A[v]],c[b+3*m+18]=S[14-m][A[v]]*R+S[15+m][A[v]],c[b+3*m+10]=S[15+m][A[v]]*R-S[14-m][A[v]],c[b+3*m+19]=T[2-m][A[v]]*R+T[3+m][A[v]],c[b+3*m+11]=T[3+m][A[v]]*R-T[2-m][A[v]],c[b+3*m+20]=T[8-m][A[v]]*R+T[9+m][A[v]]}O(c,b)}else{for(var P=i1(18),m=-9;m<0;m++){var I,y;I=o[f][m+27]*T[m+9][A[v]]+o[f][m+36]*T[8-m][A[v]],y=o[f][m+9]*S[m+9][A[v]]-o[f][m+18]*S[8-m][A[v]],P[m+9]=I-y*r[3+m+9],P[m+18]=I*r[3+m+9]+y}L(c,b,P)}if(f!=M.SHORT_TYPE&&v!=0)for(var m=7;0<=m;--m){var w,x;w=c[b+m]*s[20+m]+c[b+-1-m]*g[28+m],x=c[b+m]*g[28+m]-c[b+-1-m]*s[20+m],c[b+-1-m]=w,c[b+m]=x}}}if(l=e,i=286,k.mode_gr==1)for(var D=0;D<18;D++)o1.arraycopy(k.sb_sample[a][1][D],0,k.sb_sample[a][0][D],0,32)}}};this.lame_encode_mp3_frame=function(n,o,r,p,s,g){var A,q=R1([2,2]);q[0][0]=new P1,q[0][1]=new P1,q[1][0]=new P1,q[1][1]=new P1;var O,L=R1([2,2]);L[0][0]=new P1,L[0][1]=new P1,L[1][0]=new P1,L[1][1]=new P1;var k,t,e,l=[null,null],i=n.internal_flags,a=T1([2,4]),_=[[0,0],[0,0]],v=[[0,0],[0,0]];if(l[0]=o,l[1]=r,i.lame_encode_frame_init==0&&function(S,T){var R,P,I=S.internal_flags;if(I.lame_encode_frame_init==0){var y,w,x=i1(2014),D=i1(2014);for(I.lame_encode_frame_init=1,w=y=0;y<286+576*(1+I.mode_gr);++y)y<576*I.mode_gr?(x[y]=0,I.channels_out==2&&(D[y]=0)):(x[y]=T[0][w],I.channels_out==2&&(D[y]=T[1][w]),++w);for(P=0;P<I.mode_gr;P++)for(R=0;R<I.channels_out;R++)I.l3_side.tt[P][R].block_type=M.SHORT_TYPE;f1.mdct_sub48(I,x,D)}}(n,l),i.padding=0,(i.slot_lag-=i.frac_SpF)<0&&(i.slot_lag+=n.out_samplerate,i.padding=1),i.psymodel!=0){var u,c=[null,null],b=0,h=l1(2);for(e=0;e<i.mode_gr;e++){for(t=0;t<i.channels_out;t++)c[t]=l[t],b=576+576*e-M.FFTOFFSET;if(n.VBR==Y.vbr_mtrh||n.VBR==Y.vbr_mt?a1():u=j.L3psycho_anal_ns(n,c,b,e,q,L,_[e],v[e],a[e],h),u!=0)return-4;for(n.mode==r1.JOINT_STEREO&&a1(),t=0;t<i.channels_out;t++){var d=i.l3_side.tt[e][t];d.block_type=h[t],d.mixed_block_flag=0}}}else a1();if(function(S){var T,R;if(S.ATH.useAdjust==0)return S.ATH.adjust=1;if(R=S.loudness_sq[0][0],T=S.loudness_sq[1][0],S.channels_out==2?a1():(R+=R,T+=T),S.mode_gr==2&&(R=Math.max(R,T)),R*=.5,.03125<(R*=S.ATH.aaSensitivityP))1<=S.ATH.adjust?S.ATH.adjust=1:S.ATH.adjust<S.ATH.adjustLimit&&(S.ATH.adjust=S.ATH.adjustLimit),S.ATH.adjustLimit=1;else{var P=31.98*R+625e-6;S.ATH.adjust>=P?(S.ATH.adjust*=.075*P+.925,S.ATH.adjust<P&&(S.ATH.adjust=P)):S.ATH.adjustLimit>=P?S.ATH.adjust=P:S.ATH.adjust<S.ATH.adjustLimit&&(S.ATH.adjust=S.ATH.adjustLimit),S.ATH.adjustLimit=P}}(i),f1.mdct_sub48(i,l[0],l[1]),i.mode_ext=M.MPG_MD_LR_LR,n.force_ms?i.mode_ext=M.MPG_MD_MS_LR:n.mode==r1.JOINT_STEREO&&a1(),i.mode_ext==V?(O=L,k=v):(O=q,k=_),n.analysis&&i.pinfo!=null&&a1(),n.VBR==Y.vbr_off||n.VBR==Y.vbr_abr){var m,f;for(m=0;m<18;m++)i.nsPsy.pefirbuf[m]=i.nsPsy.pefirbuf[m+1];for(e=f=0;e<i.mode_gr;e++)for(t=0;t<i.channels_out;t++)f+=k[e][t];for(i.nsPsy.pefirbuf[18]=f,f=i.nsPsy.pefirbuf[9],m=0;m<9;m++)f+=(i.nsPsy.pefirbuf[m]+i.nsPsy.pefirbuf[18-m])*M.fircoef[m];for(f=3350*i.mode_gr*i.channels_out/f,e=0;e<i.mode_gr;e++)for(t=0;t<i.channels_out;t++)k[e][t]*=f}return i.iteration_loop.iteration_loop(n,k,[.5,.5],O),$.format_bitstream(n),A=$.copy_buffer(i,p,s,g,1),n.bWriteVbrTag&&C.addVbrFrame(n),n.analysis&&i.pinfo!=null&&a1(),function(S){var T,R;for(S.bitrate_stereoMode_Hist[S.bitrate_index][4]++,S.bitrate_stereoMode_Hist[15][4]++,S.channels_out==2&&a1(),T=0;T<S.mode_gr;++T)for(R=0;R<S.channels_out;++R){var P=0|S.l3_side.tt[T][R].block_type;S.l3_side.tt[T][R].mixed_block_flag!=0&&(P=4),S.bitrate_blockType_Hist[S.bitrate_index][P]++,S.bitrate_blockType_Hist[S.bitrate_index][5]++,S.bitrate_blockType_Hist[15][P]++,S.bitrate_blockType_Hist[15][5]++}}(i),A}}function w1(){this.l=i1(M.SBMAX_l),this.s=T1([M.SBMAX_s,3]);var V=this;this.assign=function($){o1.arraycopy($.l,0,V.l,0,M.SBMAX_l);for(var j=0;j<M.SBMAX_s;j++)for(var C=0;C<3;C++)V.s[j][C]=$.s[j][C]}}function C1(){var V=40;function $(){this.write_timing=0,this.ptr=0,this.buf=S1(V)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=T1([2,C1.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new function(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[l1(4),l1(4)];for(var C=0;C<2;C++)for(var f1=0;f1<2;f1++)this.tt[C][f1]=new I1},this.ms_ratio=i1(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=l1(2),this.CurrentStep=l1(2),this.masking_lower=0,this.bv_scf=l1(576),this.pseudohalf=l1(m1.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*C1.BPC+1),this.itime=G(2),this.sideinfo_len=0,this.sb_sample=T1([2,2,18,M.SBLIMIT]),this.amp_filter=i1(32),this.header=new Array(C1.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new y1,this.minval_l=i1(M.CBANDS),this.minval_s=i1(M.CBANDS),this.nb_1=T1([4,M.CBANDS]),this.nb_2=T1([4,M.CBANDS]),this.nb_s1=T1([4,M.CBANDS]),this.nb_s2=T1([4,M.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=i1(4),this.loudness_sq=T1([2,2]),this.loudness_sq_save=i1(2),this.mld_l=i1(M.SBMAX_l),this.mld_s=i1(M.SBMAX_s),this.bm_l=l1(M.SBMAX_l),this.bo_l=l1(M.SBMAX_l),this.bm_s=l1(M.SBMAX_s),this.bo_s=l1(M.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=H1([M.CBANDS,2]),this.s3ind_s=H1([M.CBANDS,2]),this.numlines_s=l1(M.CBANDS),this.numlines_l=l1(M.CBANDS),this.rnumlines_l=i1(M.CBANDS),this.mld_cb_l=i1(M.CBANDS),this.mld_cb_s=i1(M.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=i1(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=l1(2),this.nsPsy=new function(){this.last_en_subshort=T1([4,9]),this.lastAttacks=l1(4),this.pefirbuf=i1(19),this.longfact=i1(M.SBMAX_l),this.shortfact=i1(M.SBMAX_s),this.attackthre=0,this.attackthre_s=0},this.VBR_seek_table=new function(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0},this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=H1([16,5]),this.bitrate_blockType_Hist=H1([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var j=0;j<this.en.length;j++)this.en[j]=new w1;for(var j=0;j<this.thm.length;j++)this.thm[j]=new w1;for(var j=0;j<this.header.length;j++)this.header[j]=new $}function x1(){var V=new function(){var y=i1(M.BLKSIZE),w=i1(M.BLKSIZE_s/2),x=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function D(B,E,H){var F,z,K,U=0,J=E+(H<<=1);F=4;do{var Z,e1,p1,W,t1,c1,Q;for(Q=F>>1,c1=(t1=(W=F)<<1)+W,F=t1<<1,K=(z=E)+Q;X1=B[z+0]-B[z+W],Q1=B[z+0]+B[z+W],U1=B[z+t1]-B[z+c1],G1=B[z+t1]+B[z+c1],B[z+t1]=Q1-G1,B[z+0]=Q1+G1,B[z+c1]=X1-U1,B[z+W]=X1+U1,X1=B[K+0]-B[K+W],Q1=B[K+0]+B[K+W],U1=v1.SQRT2*B[K+c1],G1=v1.SQRT2*B[K+t1],B[K+t1]=Q1-G1,B[K+0]=Q1+G1,B[K+c1]=X1-U1,B[K+W]=X1+U1,K+=F,(z+=F)<J;);for(e1=x[U+0],Z=x[U+1],p1=1;p1<Q;p1++){var B1,O1;B1=1-2*Z*Z,O1=2*Z*e1,z=E+p1,K=E+W-p1;do{var V1,F1,z1,Q1,X1,Z1,G1,ee,U1,te;F1=O1*B[z+W]-B1*B[K+W],V1=B1*B[z+W]+O1*B[K+W],X1=B[z+0]-V1,Q1=B[z+0]+V1,Z1=B[K+0]-F1,z1=B[K+0]+F1,F1=O1*B[z+c1]-B1*B[K+c1],V1=B1*B[z+c1]+O1*B[K+c1],U1=B[z+t1]-V1,G1=B[z+t1]+V1,te=B[K+t1]-F1,ee=B[K+t1]+F1,F1=Z*G1-e1*te,V1=e1*G1+Z*te,B[z+t1]=Q1-V1,B[z+0]=Q1+V1,B[K+c1]=Z1-F1,B[K+W]=Z1+F1,F1=e1*ee-Z*U1,V1=Z*ee+e1*U1,B[K+t1]=z1-V1,B[K+0]=z1+V1,B[z+c1]=X1-F1,B[z+W]=X1+F1,K+=F,z+=F}while(z<J);e1=(B1=e1)*x[U+0]-Z*x[U+1],Z=B1*x[U+1]+Z*x[U+0]}U+=2}while(F<H)}var N=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(B,E,H,F,z){for(var K=0;K<3;K++){var U=M.BLKSIZE_s/2,J=65535&192*(K+1),Z=M.BLKSIZE_s/8-1;do{var e1,p1,W,t1,c1,Q=255&N[Z<<2];e1=w[Q]*F[H][z+Q+J],c1=w[127-Q]*F[H][z+Q+J+128],p1=e1-c1,e1+=c1,W=w[Q+64]*F[H][z+Q+J+64],c1=w[63-Q]*F[H][z+Q+J+192],t1=W-c1,W+=c1,U-=4,E[K][U+0]=e1+W,E[K][U+2]=e1-W,E[K][U+1]=p1+t1,E[K][U+3]=p1-t1,e1=w[Q+1]*F[H][z+Q+J+1],c1=w[126-Q]*F[H][z+Q+J+129],p1=e1-c1,e1+=c1,W=w[Q+65]*F[H][z+Q+J+65],c1=w[62-Q]*F[H][z+Q+J+193],t1=W-c1,W+=c1,E[K][U+M.BLKSIZE_s/2+0]=e1+W,E[K][U+M.BLKSIZE_s/2+2]=e1-W,E[K][U+M.BLKSIZE_s/2+1]=p1+t1,E[K][U+M.BLKSIZE_s/2+3]=p1-t1}while(0<=--Z);D(E[K],U,M.BLKSIZE_s/2)}},this.fft_long=function(B,E,H,F,z){var K=M.BLKSIZE/8-1,U=M.BLKSIZE/2;do{var J,Z,e1,p1,W,t1=255&N[K];J=y[t1]*F[H][z+t1],W=y[t1+512]*F[H][z+t1+512],Z=J-W,J+=W,e1=y[t1+256]*F[H][z+t1+256],W=y[t1+768]*F[H][z+t1+768],p1=e1-W,e1+=W,E[0+(U-=4)]=J+e1,E[U+2]=J-e1,E[U+1]=Z+p1,E[U+3]=Z-p1,J=y[t1+1]*F[H][z+t1+1],W=y[t1+513]*F[H][z+t1+513],Z=J-W,J+=W,e1=y[t1+257]*F[H][z+t1+257],W=y[t1+769]*F[H][z+t1+769],p1=e1-W,e1+=W,E[U+M.BLKSIZE/2+0]=J+e1,E[U+M.BLKSIZE/2+2]=J-e1,E[U+M.BLKSIZE/2+1]=Z+p1,E[U+M.BLKSIZE/2+3]=Z-p1}while(0<=--K);D(E,U,M.BLKSIZE/2)},this.init_fft=function(B){for(var E=0;E<M.BLKSIZE;E++)y[E]=.42-.5*Math.cos(2*Math.PI*(E+.5)/M.BLKSIZE)+.08*Math.cos(4*Math.PI*(E+.5)/M.BLKSIZE);for(var E=0;E<M.BLKSIZE_s/2;E++)w[E]=.5*(1-Math.cos(2*Math.PI*(E+.5)/M.BLKSIZE_s))}},$=2.302585092994046,j=2,C=16,f1=.34,n=1/217621504/(M.BLKSIZE/2),o=.2302585093;function r(y,w,x,D,N,B,E,H,F,z,K){var U=y.internal_flags;F<2?(V.fft_long(U,D[N],F,z,K),V.fft_short(U,B[E],F,z,K)):F==2&&a1(),w[0]=D[N+0][0],w[0]*=w[0];for(var J=M.BLKSIZE/2-1;0<=J;--J){var Z=D[N+0][M.BLKSIZE/2-J],e1=D[N+0][M.BLKSIZE/2+J];w[M.BLKSIZE/2-J]=.5*(Z*Z+e1*e1)}for(var p1=2;0<=p1;--p1){x[p1][0]=B[E+0][p1][0],x[p1][0]*=x[p1][0];for(var J=M.BLKSIZE_s/2-1;0<=J;--J){var Z=B[E+0][p1][M.BLKSIZE_s/2-J],e1=B[E+0][p1][M.BLKSIZE_s/2+J];x[p1][M.BLKSIZE_s/2-J]=.5*(Z*Z+e1*e1)}}for(var W=0,J=11;J<M.HBLKSIZE;J++)W+=w[J];U.tot_ener[F]=W,y.analysis&&a1(),y.athaa_loudapprox==2&&F<2&&(U.loudness_sq[H][F]=U.loudness_sq_save[F],U.loudness_sq_save[F]=function(t1,c1){for(var Q=0,B1=0;B1<M.BLKSIZE/2;++B1)Q+=t1[B1]*c1.ATH.eql_w[B1];return Q*=n}(w,U))}var p,s,g,A=8,q=23,O=15,L=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],k=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],t=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],e=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function l(y,w,x,D,N,B){var E;if(y<w){if(!(w<y*s))return y+w;E=w/y}else{if(w*s<=y)return y+w;E=y/w}if(y+=w,D+3<=6){if(p<=E)return y;var z=0|v1.FAST_LOG10_X(E,16);return y*t[z]}var H,F,z=0|v1.FAST_LOG10_X(E,16);return w=N.ATH.cb_l[x]*N.ATH.adjust,y<g*w?w<y?(H=1,z<=13&&(H=e[z]),F=v1.FAST_LOG10_X(y/w,10/15),y*((k[z]-H)*F+H)):13<z?y:y*e[z]:y*k[z]}function i(y,w,x,D,N){var B,E,H=0,F=0;for(B=E=0;B<M.SBMAX_s;++E,++B){for(var z=y.bo_s[B],K=y.npart_s,U=z<K?z:K;E<U;)H+=w[E],F+=x[E],E++;if(y.en[D].s[B][N]=H,y.thm[D].s[B][N]=F,K<=E){++B;break}var J=y.PSY.bo_s_weight[B],Z=1-J;H=J*w[E],F=J*x[E],y.en[D].s[B][N]+=H,y.thm[D].s[B][N]+=F,H=Z*w[E],F=Z*x[E]}for(;B<M.SBMAX_s;++B)y.en[D].s[B][N]=0,y.thm[D].s[B][N]=0}function a(y,w,x,D){var N,B,E=0,H=0;for(N=B=0;N<M.SBMAX_l;++B,++N){for(var F=y.bo_l[N],z=y.npart_l,K=F<z?F:z;B<K;)E+=w[B],H+=x[B],B++;if(y.en[D].l[N]=E,y.thm[D].l[N]=H,z<=B){++N;break}var U=y.PSY.bo_l_weight[N],J=1-U;E=U*w[B],H=U*x[B],y.en[D].l[N]+=E,y.thm[D].l[N]+=H,E=J*w[B],H=J*x[B]}for(;N<M.SBMAX_l;++N)y.en[D].l[N]=0,y.thm[D].l[N]=0}function _(y,w,x,D,N,B){var E,H,F=y.internal_flags;for(H=E=0;H<F.npart_s;++H){for(var z=0,K=0,U=F.numlines_s[H],J=0;J<U;++J,++E){var Z=w[B][E];z+=Z,K<Z&&(K=Z)}x[H]=z}for(E=H=0;H<F.npart_s;H++){var e1=F.s3ind_s[H][0],p1=F.s3_ss[E++]*x[e1];for(++e1;e1<=F.s3ind_s[H][1];)p1+=F.s3_ss[E]*x[e1],++E,++e1;var W=j*F.nb_s1[N][H];if(D[H]=Math.min(p1,W),F.blocktype_old[1&N]==M.SHORT_TYPE){var W=C*F.nb_s2[N][H],t1=D[H];D[H]=Math.min(W,t1)}F.nb_s2[N][H]=F.nb_s1[N][H],F.nb_s1[N][H]=p1}for(;H<=M.CBANDS;++H)x[H]=0,D[H]=0}function v(y,w,x){return 1<=x?y:x<=0?w:0<w?Math.pow(y/w,x)*w:0}var u=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function c(y,w){for(var x=309.07,D=0;D<M.SBMAX_s-1;D++)for(var N=0;N<3;N++){var B=y.thm.s[D][N];if(0<B){var E=B*w,H=y.en.s[D][N];E<H&&(x+=1e10*E<H?u[D]*(10*$):u[D]*v1.FAST_LOG10(H/E))}}return x}var b=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function h(y,w){for(var x=281.0575,D=0;D<M.SBMAX_l-1;D++){var N=y.thm.l[D];if(0<N){var B=N*w,E=y.en.l[D];B<E&&(x+=1e10*B<E?b[D]*(10*$):b[D]*v1.FAST_LOG10(E/B))}}return x}function d(y,w,x,D,N){var B,E;for(B=E=0;B<y.npart_l;++B){var H,F=0,z=0;for(H=0;H<y.numlines_l[B];++H,++E){var K=w[E];F+=K,z<K&&(z=K)}x[B]=F,D[B]=z,N[B]=F*y.rnumlines_l[B]}}function m(y,w,x,D){var N=L.length-1,B=0,E=x[B]+x[B+1];if(0<E){var H=w[B];H<w[B+1]&&(H=w[B+1]);var F=0|(E=20*(2*H-E)/(E*(y.numlines_l[B]+y.numlines_l[B+1]-1)));N<F&&(F=N),D[B]=F}else D[B]=0;for(B=1;B<y.npart_l-1;B++)if(0<(E=x[B-1]+x[B]+x[B+1])){var H=w[B-1];H<w[B]&&(H=w[B]),H<w[B+1]&&(H=w[B+1]);var F=0|(E=20*(3*H-E)/(E*(y.numlines_l[B-1]+y.numlines_l[B]+y.numlines_l[B+1]-1)));N<F&&(F=N),D[B]=F}else D[B]=0;if(0<(E=x[B-1]+x[B])){var H=w[B-1];H<w[B]&&(H=w[B]);var F=0|(E=20*(2*H-E)/(E*(y.numlines_l[B-1]+y.numlines_l[B]-1)));N<F&&(F=N),D[B]=F}else D[B]=0}var f=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function S(y){return y<0&&(y=0),y*=.001,13*Math.atan(.76*y)+3.5*Math.atan(y*y/56.25)}function T(y,w,x,D,N,B,E,H,F,z,K,U){var J,Z=i1(M.CBANDS+1),e1=H/(15<U?1152:384),p1=l1(M.HBLKSIZE);H/=F;var W=0,t1=0;for(J=0;J<M.CBANDS;J++){var c1;for(Z1=S(H*W),Z[J]=H*W,c1=W;S(H*c1)-Z1<f1&&c1<=F/2;c1++);for(y[J]=c1-W,t1=J+1;W<c1;)p1[W++]=J;if(F/2<W){W=F/2,++J;break}}Z[J]=H*W;for(var Q=0;Q<U;Q++){var B1,O1,V1,F1,z1;V1=z[Q],F1=z[Q+1],(B1=0|Math.floor(.5+K*(V1-.5)))<0&&(B1=0),O1=0|Math.floor(.5+K*(F1-.5)),F/2<O1&&(O1=F/2),x[Q]=(p1[B1]+p1[O1])/2,w[Q]=p1[O1];var Q1=e1*F1;E[Q]=(Q1-Z[w[Q]])/(Z[w[Q]+1]-Z[w[Q]]),E[Q]<0?E[Q]=0:1<E[Q]&&(E[Q]=1),z1=S(H*z[Q]*K),z1=Math.min(z1,15.5)/15.5,B[Q]=Math.pow(10,1.25*(1-Math.cos(Math.PI*z1))-2.5)}for(var X1=W=0;X1<t1;X1++){var Z1,G1,ee=y[X1];Z1=S(H*W),G1=S(H*(W+ee-1)),D[X1]=.5*(Z1+G1),Z1=S(H*(W-.5)),G1=S(H*(W+ee-.5)),N[X1]=G1-Z1,W+=ee}return t1}function R(y,w,x,D,N,B){var E,H,F,z,K,U,J=T1([M.CBANDS,M.CBANDS]),Z=0;if(B)for(var e1=0;e1<w;e1++)for(E=0;E<w;E++){var p1=(H=x[e1]-x[E],U=K=z=F=void 0,F=H,z=.5<=(F*=0<=F?3:1.5)&&F<=2.5?8*((U=F-.5)*U-2*U):0,((K=15.811389+7.5*(F+=.474)-17.5*Math.sqrt(1+F*F))<=-60?0:(F=Math.exp((z+K)*o),F/=.6609193))*D[E]);J[e1][E]=p1*N[e1]}else a1();for(var e1=0;e1<w;e1++){for(E=0;E<w&&!(0<J[e1][E]);E++);for(y[e1][0]=E,E=w-1;0<E&&!(0<J[e1][E]);E--);y[e1][1]=E,Z+=y[e1][1]-y[e1][0]+1}for(var W=i1(Z),t1=0,e1=0;e1<w;e1++)for(E=y[e1][0];E<=y[e1][1];E++)W[t1++]=J[e1][E];return W}function P(y){var w=S(y);return w=Math.min(w,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*w))-2.5)}function I(y,w){y<-.3&&(y=3410),y/=1e3,y=Math.max(.1,y);var x=3.64*Math.pow(y,-.8)-6.8*Math.exp(-.6*Math.pow(y-3.4,2))+6*Math.exp(-.15*Math.pow(y-8.7,2))+.001*(.6+.04*w)*Math.pow(y,4);return x}this.L3psycho_anal_ns=function(y,w,x,D,N,B,E,H,F,z){var K,U,J,Z,e1,p1,W,t1,c1,Q=y.internal_flags,B1=T1([2,M.BLKSIZE]),O1=T1([2,3,M.BLKSIZE_s]),V1=i1(M.CBANDS+1),F1=i1(M.CBANDS+1),z1=i1(M.CBANDS+2),Q1=l1(2),X1=l1(2),Z1=T1([2,576]),G1=l1(M.CBANDS+2),ee=l1(M.CBANDS+2);for(N1.fill(ee,0),K=Q.channels_out,y.mode==r1.JOINT_STEREO&&(K=4),c1=y.VBR==Y.vbr_off?Q.ResvMax==0?0:Q.ResvSize/Q.ResvMax*.5:y.VBR==Y.vbr_rh||y.VBR==Y.vbr_mtrh||y.VBR==Y.vbr_mt?.6:1,U=0;U<Q.channels_out;U++){var U1=w[U],te=x+576-350-21+192;for(Z=0;Z<576;Z++){var he,pe;for(he=U1[te+Z+10],e1=pe=0;e1<9;e1+=2)he+=f[e1]*(U1[te+Z+e1]+U1[te+Z+21-e1]),pe+=f[e1+1]*(U1[te+Z+e1+1]+U1[te+Z+21-e1-1]);Z1[U][Z]=he+pe}N[D][U].en.assign(Q.en[U]),N[D][U].thm.assign(Q.thm[U]),2<K&&a1()}for(U=0;U<K;U++){var Se,$1=i1(12),ne=[0,0,0,0],ve=i1(12),ye=1,Me=i1(M.CBANDS),xe=i1(M.CBANDS),D1=[0,0,0,0],Ae=i1(M.HBLKSIZE),Te=T1([3,M.HBLKSIZE_s]);for(Z=0;Z<3;Z++)$1[Z]=Q.nsPsy.last_en_subshort[U][Z+6],ve[Z]=$1[Z]/Q.nsPsy.last_en_subshort[U][Z+4],ne[0]+=$1[Z];U==2&&a1();var ke=Z1[1&U],_e=0;for(Z=0;Z<9;Z++){for(var Ie=_e+64,j1=1;_e<Ie;_e++)j1<Math.abs(ke[_e])&&(j1=Math.abs(ke[_e]));Q.nsPsy.last_en_subshort[U][Z]=$1[Z+3]=j1,ne[1+Z/3]+=j1,j1>$1[Z+3-2]?j1/=$1[Z+3-2]:j1=$1[Z+3-2]>10*j1?$1[Z+3-2]/(10*j1):0,ve[Z+3]=j1}for(y.analysis&&a1(),Se=U==3?Q.nsPsy.attackthre_s:Q.nsPsy.attackthre,Z=0;Z<12;Z++)D1[Z/3]==0&&ve[Z]>Se&&(D1[Z/3]=Z%3+1);for(Z=1;Z<4;Z++)(ne[Z-1]>ne[Z]?ne[Z-1]/ne[Z]:ne[Z]/ne[Z-1])<1.7&&(D1[Z]=0,Z==1&&(D1[0]=0));for(D1[0]!=0&&Q.nsPsy.lastAttacks[U]!=0&&(D1[0]=0),Q.nsPsy.lastAttacks[U]!=3&&D1[0]+D1[1]+D1[2]+D1[3]==0||((ye=0)!=D1[1]&&D1[0]!=0&&(D1[1]=0),D1[2]!=0&&D1[1]!=0&&(D1[2]=0),D1[3]!=0&&D1[2]!=0&&(D1[3]=0)),U<2?X1[U]=ye:a1(),F[U]=Q.tot_ener[U],r(y,Ae,Te,B1,1&U,O1,1&U,D,U,w,x),d(Q,Ae,V1,Me,xe),m(Q,Me,xe,G1),t1=0;t1<3;t1++){var be,K1;for(_(y,Te,F1,z1,U,t1),i(Q,F1,z1,U,t1),W=0;W<M.SBMAX_s;W++){if(K1=Q.thm[U].s[W][t1],K1*=.8,2<=D1[t1]||D1[t1+1]==1){var fe=t1!=0?t1-1:2,j1=v(Q.thm[U].s[W][fe],K1,.6*c1);K1=Math.min(K1,j1)}if(D1[t1]==1){var fe=t1!=0?t1-1:2,j1=v(Q.thm[U].s[W][fe],K1,.3*c1);K1=Math.min(K1,j1)}else if(t1!=0&&D1[t1-1]==3||t1==0&&Q.nsPsy.lastAttacks[U]==3){var fe=t1!=2?t1+1:0,j1=v(Q.thm[U].s[W][fe],K1,.3*c1);K1=Math.min(K1,j1)}be=$1[3*t1+3]+$1[3*t1+4]+$1[3*t1+5],6*$1[3*t1+5]<be&&(K1*=.5,6*$1[3*t1+4]<be&&(K1*=.5)),Q.thm[U].s[W][t1]=K1}}for(Q.nsPsy.lastAttacks[U]=D1[2],J=p1=0;J<Q.npart_l;J++){for(var re=Q.s3ind[J][0],me=V1[re]*L[G1[re]],se=Q.s3_ll[p1++]*me;++re<=Q.s3ind[J][1];)me=V1[re]*L[G1[re]],se=l(se,Q.s3_ll[p1++]*me,re,re-J,Q);se*=.158489319246111,Q.blocktype_old[1&U]==M.SHORT_TYPE?z1[J]=se:z1[J]=v(Math.min(se,Math.min(2*Q.nb_1[U][J],16*Q.nb_2[U][J])),se,c1),Q.nb_2[U][J]=Q.nb_1[U][J],Q.nb_1[U][J]=se}for(;J<=M.CBANDS;++J)V1[J]=0,z1[J]=0;a(Q,V1,z1,U)}for(y.mode!=r1.STEREO&&y.mode!=r1.JOINT_STEREO||a1(),y.mode==r1.JOINT_STEREO&&a1(),function(ce,ie,Le,ue){var ae=ce.internal_flags;ce.short_blocks!=A1.short_block_coupled||ie[0]!=0&&ie[1]!=0||(ie[0]=ie[1]=0);for(var Y1=0;Y1<ae.channels_out;Y1++)ue[Y1]=M.NORM_TYPE,ce.short_blocks==A1.short_block_dispensed&&(ie[Y1]=1),ce.short_blocks==A1.short_block_forced&&(ie[Y1]=0),ie[Y1]!=0?ae.blocktype_old[Y1]==M.SHORT_TYPE&&(ue[Y1]=M.STOP_TYPE):(ue[Y1]=M.SHORT_TYPE,ae.blocktype_old[Y1]==M.NORM_TYPE&&(ae.blocktype_old[Y1]=M.START_TYPE),ae.blocktype_old[Y1]==M.STOP_TYPE&&(ae.blocktype_old[Y1]=M.SHORT_TYPE)),Le[Y1]=ae.blocktype_old[Y1],ae.blocktype_old[Y1]=ue[Y1]}(y,X1,z,Q1),U=0;U<K;U++){var de,Be,ge,we=0;1<U?a1():(de=E,we=0,Be=z[U],ge=N[D][U]),de[we+U]=Be==M.SHORT_TYPE?c(ge,Q.masking_lower):h(ge,Q.masking_lower),y.analysis&&(Q.pinfo.pe[D][U]=de[we+U])}return 0},this.psymodel_init=function(y){var w,x=y.internal_flags,D=!0,N=13,B=0,E=0,H=-8.25,F=-4.5,z=i1(M.CBANDS),K=i1(M.CBANDS),U=i1(M.CBANDS),J=y.out_samplerate;switch(y.experimentalZ){default:case 0:D=!0;break;case 1:D=y.VBR!=Y.vbr_mtrh&&y.VBR!=Y.vbr_mt;break;case 2:D=!1;break;case 3:N=8,B=-1.75,E=-.0125,H=-8.25,F=-2.25}for(x.ms_ener_ratio_old=.25,x.blocktype_old[0]=x.blocktype_old[1]=M.NORM_TYPE,w=0;w<4;++w){for(var W=0;W<M.CBANDS;++W)x.nb_1[w][W]=1e20,x.nb_2[w][W]=1e20,x.nb_s1[w][W]=x.nb_s2[w][W]=1;for(var Z=0;Z<M.SBMAX_l;Z++)x.en[w].l[Z]=1e20,x.thm[w].l[Z]=1e20;for(var W=0;W<3;++W){for(var Z=0;Z<M.SBMAX_s;Z++)x.en[w].s[Z][W]=1e20,x.thm[w].s[Z][W]=1e20;x.nsPsy.lastAttacks[w]=0}for(var W=0;W<9;W++)x.nsPsy.last_en_subshort[w][W]=10}for(x.loudness_sq_save[0]=x.loudness_sq_save[1]=0,x.npart_l=T(x.numlines_l,x.bo_l,x.bm_l,z,K,x.mld_l,x.PSY.bo_l_weight,J,M.BLKSIZE,x.scalefac_band.l,M.BLKSIZE/1152,M.SBMAX_l),w=0;w<x.npart_l;w++){var e1=B;z[w]>=N&&(e1=E*(z[w]-N)/(24-N)+B*(24-z[w])/(24-N)),U[w]=Math.pow(10,e1/10),0<x.numlines_l[w]?x.rnumlines_l[w]=1/x.numlines_l[w]:x.rnumlines_l[w]=0}x.s3_ll=R(x.s3ind,x.npart_l,z,K,U,D);var p1,W=0;for(w=0;w<x.npart_l;w++){Q=k1.MAX_VALUE;for(var t1=0;t1<x.numlines_l[w];t1++,W++){var c1=J*W/(1e3*M.BLKSIZE);B1=this.ATHformula(1e3*c1,y)-20,B1=Math.pow(10,.1*B1),(B1*=x.numlines_l[w])<Q&&(Q=B1)}x.ATH.cb_l[w]=Q,6<(Q=20*z[w]/10-20)&&(Q=100),Q<-15&&(Q=-15),Q-=8,x.minval_l[w]=Math.pow(10,Q/10)*x.numlines_l[w]}for(x.npart_s=T(x.numlines_s,x.bo_s,x.bm_s,z,K,x.mld_s,x.PSY.bo_s_weight,J,M.BLKSIZE_s,x.scalefac_band.s,M.BLKSIZE_s/384,M.SBMAX_s),w=W=0;w<x.npart_s;w++){var Q,e1=H;z[w]>=N&&(e1=F*(z[w]-N)/(24-N)+H*(24-z[w])/(24-N)),U[w]=Math.pow(10,e1/10),Q=k1.MAX_VALUE;for(var t1=0;t1<x.numlines_s[w];t1++,W++){var B1,c1=J*W/(1e3*M.BLKSIZE_s);B1=this.ATHformula(1e3*c1,y)-20,B1=Math.pow(10,.1*B1),(B1*=x.numlines_s[w])<Q&&(Q=B1)}x.ATH.cb_s[w]=Q,Q=7*z[w]/12-7,12<z[w]&&(Q*=1+3.1*Math.log(1+Q)),z[w]<12&&(Q*=1+2.3*Math.log(1-Q)),Q<-15&&(Q=-15),Q-=8,x.minval_s[w]=Math.pow(10,Q/10)*x.numlines_s[w]}x.s3_ss=R(x.s3ind_s,x.npart_s,z,K,U,D),p=Math.pow(10,(A+1)/16),s=Math.pow(10,(q+1)/16),g=Math.pow(10,O/10),V.init_fft(x),x.decay=Math.exp(-1*$/(.01*J/192)),p1=3.5,2&y.exp_nspsytune&&(p1=1),0<Math.abs(y.msfix)&&(p1=y.msfix),y.msfix=p1;for(var O1=0;O1<x.npart_l;O1++)x.s3ind[O1][1]>x.npart_l-1&&(x.s3ind[O1][1]=x.npart_l-1);var V1=576*x.mode_gr/J;if(x.ATH.decay=Math.pow(10,-1.2*V1),x.ATH.adjust=.01,-(x.ATH.adjustLimit=1)!=y.ATHtype){var F1=y.out_samplerate/M.BLKSIZE,z1=0;for(w=c1=0;w<M.BLKSIZE/2;++w)c1+=F1,x.ATH.eql_w[w]=1/Math.pow(10,this.ATHformula(c1,y)/10),z1+=x.ATH.eql_w[w];for(z1=1/z1,w=M.BLKSIZE/2;0<=--w;)x.ATH.eql_w[w]*=z1}for(var O1=W=0;O1<x.npart_s;++O1)for(w=0;w<x.numlines_s[O1];++w)++W;for(var O1=W=0;O1<x.npart_l;++O1)for(w=0;w<x.numlines_l[O1];++w)++W;for(w=W=0;w<x.npart_l;w++){var c1=J*(W+x.numlines_l[w]/2)/(1*M.BLKSIZE);x.mld_cb_l[w]=P(c1),W+=x.numlines_l[w]}for(;w<M.CBANDS;++w)x.mld_cb_l[w]=1;for(w=W=0;w<x.npart_s;w++){var c1=J*(W+x.numlines_s[w]/2)/(1*M.BLKSIZE_s);x.mld_cb_s[w]=P(c1),W+=x.numlines_s[w]}for(;w<M.CBANDS;++w)x.mld_cb_s[w]=1;return 0},this.ATHformula=function(y,w){var x;switch(w.ATHtype){case 0:x=I(y,9);break;case 1:x=I(y,-1);break;case 2:x=I(y,0);break;case 3:x=I(y,1)+6;break;case 4:x=I(y,w.ATHcurve);break;default:x=I(y,0)}return x}}function _1(){var V,$,j,C,f1,n=this;_1.V9=410,_1.V8=420,_1.V7=430,_1.V6=440,_1.V5=450,_1.V4=460,_1.V3=470,_1.V2=480,_1.V1=490,_1.V0=500,_1.R3MIX=1e3,_1.STANDARD=1001,_1.EXTREME=1002,_1.INSANE=1003,_1.STANDARD_FAST=1004,_1.EXTREME_FAST=1005,_1.MEDIUM=1006,_1.MEDIUM_FAST=1007,_1.LAME_MAXMP3BUFFER=147456;var o,r,p=new x1;function s(){this.lowerlimit=0}function g(t,e){this.lowpass=e}this.enc=new M,this.setModules=function(t,e,l,i,a,_,v,u,c){V=t,$=e,j=l,C=i,f1=a,o=_,r=u,this.enc.setModules($,p,C,o)};var A=4294479419;function q(t,e){var l=[new g(8,2e3),new g(16,3700),new g(24,3900),new g(32,5500),new g(40,7e3),new g(48,7500),new g(56,1e4),new g(64,11e3),new g(80,13500),new g(96,15100),new g(112,15600),new g(128,17e3),new g(160,17500),new g(192,18600),new g(224,19400),new g(256,19700),new g(320,20500)],i=n.nearestBitrateFullIndex(e);t.lowerlimit=l[i].lowpass}function O(t){var e=M.BLKSIZE+t.framesize-M.FFTOFFSET;return e=Math.max(e,512+t.framesize-32)}function L(){this.n_in=0,this.n_out=0}function k(t,e,l,i,a,_){var v=t.internal_flags;if(v.resample_ratio<.9999||1.0001<v.resample_ratio)a1();else{_.n_out=Math.min(t.framesize,a),_.n_in=_.n_out;for(var u=0;u<_.n_out;++u)e[0][v.mf_size+u]=l[0][i+u],v.channels_out==2&&(e[1][v.mf_size+u]=l[1][i+u])}}this.lame_init=function(){var t,e,l=new function(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=r1.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null},i=((t=l).class_id=A,e=t.internal_flags=new C1,t.mode=r1.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,e.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=Y.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,e.VBR_min_bitrate=1,e.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,e.resample_ratio=1,e.OldValue[0]=180,e.OldValue[1]=180,e.CurrentStep[0]=4,e.CurrentStep[1]=4,e.masking_lower=1,e.nsPsy.attackthre=-1,e.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,e.mf_samples_to_encode=M.ENCDELAY+M.POSTDELAY,t.encoder_padding=0,e.mf_size=M.ENCDELAY-M.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,e.decode_on_the_fly=!1,e.findReplayGain=!1,e.findPeakSample=!1,e.RadioGain=0,e.AudiophileGain=0,e.noclipGainChange=0,e.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0);return i!=0?null:(l.lame_allocated_gfp=1,l)},this.nearestBitrateFullIndex=function(t){var e=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],l=0,i=0,a=0,_=0;_=e[16],i=e[a=16],l=16;for(var v=0;v<16;v++)if(Math.max(t,e[v+1])!=t){_=e[v+1],a=v+1,i=e[v],l=v;break}return t-i<_-t?l:a},this.lame_init_params=function(t){var e,l,i=t.internal_flags;if(i.Class_ID=0,i.ATH==null&&(i.ATH=new function(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=i1(M.SBMAX_l),this.s=i1(M.SBMAX_s),this.psfb21=i1(M.PSFB21),this.psfb12=i1(M.PSFB12),this.cb_l=i1(M.CBANDS),this.cb_s=i1(M.CBANDS),this.eql_w=i1(M.BLKSIZE/2)}),i.PSY==null&&(i.PSY=new function(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=i1(M.SBMAX_l),this.bo_s_weight=i1(M.SBMAX_s)}),i.rgdata==null&&(i.rgdata=new function(){}),i.channels_in=t.num_channels,i.channels_in==1&&(t.mode=r1.MONO),i.channels_out=t.mode==r1.MONO?1:2,i.mode_ext=M.MPG_MD_MS_LR,t.mode==r1.MONO&&(t.force_ms=!1),t.VBR==Y.vbr_off&&t.VBR_mean_bitrate_kbps!=128&&t.brate==0&&(t.brate=t.VBR_mean_bitrate_kbps),t.VBR==Y.vbr_off||t.VBR==Y.vbr_mtrh||t.VBR==Y.vbr_mt||(t.free_format=!1),t.VBR==Y.vbr_off&&t.brate==0&&a1(),t.VBR==Y.vbr_off&&0<t.compression_ratio&&a1(),t.out_samplerate!=0&&(t.out_samplerate<16e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,64)):t.out_samplerate<32e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,160)):(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,32),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320))),t.lowpassfreq==0){var a=16e3;switch(t.VBR){case Y.vbr_off:var _=new s;q(_,t.brate),a=_.lowerlimit;break;case Y.vbr_abr:var _=new s;q(_,t.VBR_mean_bitrate_kbps),a=_.lowerlimit;break;case Y.vbr_rh:a1();default:a1()}t.mode!=r1.MONO||t.VBR!=Y.vbr_off&&t.VBR!=Y.vbr_abr||(a*=1.5),t.lowpassfreq=0|a}switch(t.out_samplerate==0&&a1(),t.lowpassfreq=Math.min(20500,t.lowpassfreq),t.lowpassfreq=Math.min(t.out_samplerate/2,t.lowpassfreq),t.VBR==Y.vbr_off&&(t.compression_ratio=16*t.out_samplerate*i.channels_out/(1e3*t.brate)),t.VBR==Y.vbr_abr&&a1(),t.bWriteVbrTag||(t.findReplayGain=!1,t.decode_on_the_fly=!1,i.findPeakSample=!1),i.findReplayGain=t.findReplayGain,i.decode_on_the_fly=t.decode_on_the_fly,i.decode_on_the_fly&&(i.findPeakSample=!0),i.findReplayGain&&a1(),i.decode_on_the_fly&&!t.decode_only&&a1(),i.mode_gr=t.out_samplerate<=24e3?1:2,t.framesize=576*i.mode_gr,t.encoder_delay=M.ENCDELAY,i.resample_ratio=t.in_samplerate/t.out_samplerate,t.VBR){case Y.vbr_mt:case Y.vbr_rh:case Y.vbr_mtrh:t.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][t.VBR_q];break;case Y.vbr_abr:t.compression_ratio=16*t.out_samplerate*i.channels_out/(1e3*t.VBR_mean_bitrate_kbps);break;default:t.compression_ratio=16*t.out_samplerate*i.channels_out/(1e3*t.brate)}t.mode==r1.NOT_SET&&(t.mode=r1.JOINT_STEREO),0<t.highpassfreq?a1():(i.highpass1=0,i.highpass2=0),0<t.lowpassfreq?(i.lowpass2=2*t.lowpassfreq,0<=t.lowpasswidth?a1():i.lowpass1=2*t.lowpassfreq,i.lowpass1/=t.out_samplerate,i.lowpass2/=t.out_samplerate):a1(),function(m){var f,S=m.internal_flags,T=32;if(0<S.lowpass1){for(var R=999,P=0;P<=31;P++){var I=P/31;I>=S.lowpass2&&(T=Math.min(T,P)),S.lowpass1<I&&I<S.lowpass2&&(R=Math.min(R,P))}S.lowpass1=R==999?(T-.75)/31:(R-.75)/31,S.lowpass2=T/31}0<S.highpass2&&a1(),0<S.highpass2&&a1();for(var P=0;P<32;P++){var y,w,I=P/31;S.highpass2>S.highpass1?a1():y=1,w=S.lowpass2>S.lowpass1?1<(f=(I-S.lowpass1)/(S.lowpass2-S.lowpass1+1e-20))?0:f<=0?1:Math.cos(Math.PI/2*f):1,S.amp_filter[P]=y*w}}(t),i.samplerate_index=function(m,f){switch(m){case 44100:return f.version=1,0;case 48e3:return f.version=1;case 32e3:return f.version=1,2;case 22050:return f.version=0;case 24e3:return f.version=0,1;case 16e3:return f.version=0,2;case 11025:return f.version=0;case 12e3:return f.version=0,1;case 8e3:return f.version=0,2;default:return f.version=0,-1}}(t.out_samplerate,t),i.samplerate_index<0&&a1(),t.VBR==Y.vbr_off?t.free_format?i.bitrate_index=0:(t.brate=function(m,f,S){S<16e3&&(f=2);for(var T=X.bitrate_table[f][1],R=2;R<=14;R++)0<X.bitrate_table[f][R]&&Math.abs(X.bitrate_table[f][R]-m)<Math.abs(T-m)&&(T=X.bitrate_table[f][R]);return T}(t.brate,t.version,t.out_samplerate),i.bitrate_index=function(m,f,S){S<16e3&&(f=2);for(var T=0;T<=14;T++)if(0<X.bitrate_table[f][T]&&X.bitrate_table[f][T]==m)return T;return-1}(t.brate,t.version,t.out_samplerate),i.bitrate_index<=0&&a1()):i.bitrate_index=1,t.analysis&&(t.bWriteVbrTag=!1),i.pinfo!=null&&(t.bWriteVbrTag=!1),$.init_bit_stream_w(i);for(var v,u=i.samplerate_index+3*t.version+6*(t.out_samplerate<16e3?1:0),c=0;c<M.SBMAX_l+1;c++)i.scalefac_band.l[c]=C.sfBandIndex[u].l[c];for(var c=0;c<M.PSFB21+1;c++){var b=(i.scalefac_band.l[22]-i.scalefac_band.l[21])/M.PSFB21,h=i.scalefac_band.l[21]+c*b;i.scalefac_band.psfb21[c]=h}i.scalefac_band.psfb21[M.PSFB21]=576;for(var c=0;c<M.SBMAX_s+1;c++)i.scalefac_band.s[c]=C.sfBandIndex[u].s[c];for(var c=0;c<M.PSFB12+1;c++){var b=(i.scalefac_band.s[13]-i.scalefac_band.s[12])/M.PSFB12,h=i.scalefac_band.s[12]+c*b;i.scalefac_band.psfb12[c]=h}for(i.scalefac_band.psfb12[M.PSFB12]=192,t.version==1?i.sideinfo_len=i.channels_out==1?21:36:i.sideinfo_len=i.channels_out==1?13:21,t.error_protection&&(i.sideinfo_len+=2),l=void 0,l=(e=t).internal_flags,e.frameNum=0,e.write_id3tag_automatic&&r.id3tag_write_v2(e),l.bitrate_stereoMode_Hist=H1([16,5]),l.bitrate_blockType_Hist=H1([16,6]),l.PeakSample=0,e.bWriteVbrTag&&o.InitVbrTag(e),i.Class_ID=A,v=0;v<19;v++)i.nsPsy.pefirbuf[v]=700*i.mode_gr*i.channels_out;switch(t.ATHtype==-1&&(t.ATHtype=4),t.VBR){case Y.vbr_mt:t.VBR=Y.vbr_mtrh;case Y.vbr_mtrh:t.useTemporal==null&&(t.useTemporal=!1),j.apply_preset(t,500-10*t.VBR_q,0),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),t.quality<5&&(t.quality=0),5<t.quality&&(t.quality=5),i.PSY.mask_adjust=t.maskingadjust,i.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?i.sfb21_extra=!1:i.sfb21_extra=44e3<t.out_samplerate,i.iteration_loop=new VBRNewIterationLoop(f1);break;case Y.vbr_rh:j.apply_preset(t,500-10*t.VBR_q,0),i.PSY.mask_adjust=t.maskingadjust,i.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?i.sfb21_extra=!1:i.sfb21_extra=44e3<t.out_samplerate,6<t.quality&&(t.quality=6),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),i.iteration_loop=new VBROldIterationLoop(f1);break;default:var d;i.sfb21_extra=!1,t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),(d=t.VBR)==Y.vbr_off&&(t.VBR_mean_bitrate_kbps=t.brate),j.apply_preset(t,t.VBR_mean_bitrate_kbps,0),t.VBR=d,i.PSY.mask_adjust=t.maskingadjust,i.PSY.mask_adjust_short=t.maskingadjust_short,d==Y.vbr_off?i.iteration_loop=new function(m){var f=m;this.quantize=f,this.iteration_loop=function(S,T,R,P){var I=S.internal_flags,y=i1(m1.SFBMAX),w=i1(576),x=l1(2),D=0,N=I.l3_side,B=new E1(D);this.quantize.rv.ResvFrameBegin(S,B),D=B.bits;for(var E=0;E<I.mode_gr;E++){this.quantize.qupvt.on_pe(S,T,x,D,E,E),I.mode_ext==M.MPG_MD_MS_LR&&a1();for(var H=0;H<I.channels_out;H++){var F,z,K=N.tt[E][H];K.block_type!=M.SHORT_TYPE?(F=0,z=I.PSY.mask_adjust-F):(F=0,z=I.PSY.mask_adjust_short-F),I.masking_lower=Math.pow(10,.1*z),this.quantize.init_outer_loop(I,K),this.quantize.init_xrpow(I,K,w)&&(this.quantize.qupvt.calc_xmin(S,P[E][H],K,y),this.quantize.outer_loop(S,K,y,w,H,x[H])),this.quantize.iteration_finish_one(I,E,H)}}this.quantize.rv.ResvFrameEnd(I,D)}}(f1):a1()}return t.VBR!=Y.vbr_off&&a1(),t.tune&&a1(),function(m){var f=m.internal_flags;switch(m.quality){default:case 9:f.psymodel=0,f.noise_shaping=0,f.noise_shaping_amp=0,f.noise_shaping_stop=0,f.use_best_huffman=0,f.full_outer_loop=0;break;case 8:m.quality=7;case 7:f.psymodel=1,f.noise_shaping=0,f.noise_shaping_amp=0,f.noise_shaping_stop=0,f.use_best_huffman=0,f.full_outer_loop=0;break;case 6:case 5:f.psymodel=1,f.noise_shaping==0&&(f.noise_shaping=1),f.noise_shaping_amp=0,f.noise_shaping_stop=0,f.subblock_gain==-1&&(f.subblock_gain=1),f.use_best_huffman=0,f.full_outer_loop=0;break;case 4:f.psymodel=1,f.noise_shaping==0&&(f.noise_shaping=1),f.noise_shaping_amp=0,f.noise_shaping_stop=0,f.subblock_gain==-1&&(f.subblock_gain=1),f.use_best_huffman=1,f.full_outer_loop=0;break;case 3:f.psymodel=1,f.noise_shaping==0&&(f.noise_shaping=1),f.noise_shaping_amp=1,-(f.noise_shaping_stop=1)==f.subblock_gain&&(f.subblock_gain=1),f.use_best_huffman=1,f.full_outer_loop=0;break;case 2:f.psymodel=1,f.noise_shaping==0&&(f.noise_shaping=1),f.substep_shaping==0&&(f.substep_shaping=2),f.noise_shaping_amp=1,-(f.noise_shaping_stop=1)==f.subblock_gain&&(f.subblock_gain=1),f.use_best_huffman=1,f.full_outer_loop=0;break;case 1:case 0:f.psymodel=1,f.noise_shaping==0&&(f.noise_shaping=1),f.substep_shaping==0&&(f.substep_shaping=2),f.noise_shaping_amp=2,-(f.noise_shaping_stop=1)==f.subblock_gain&&(f.subblock_gain=1),f.use_best_huffman=1,f.full_outer_loop=0}}(t),t.athaa_type<0?i.ATH.useAdjust=3:i.ATH.useAdjust=t.athaa_type,i.ATH.aaSensitivityP=Math.pow(10,t.athaa_sensitivity/-10),t.short_blocks==null&&(t.short_blocks=A1.short_block_allowed),t.short_blocks!=A1.short_block_allowed||t.mode!=r1.JOINT_STEREO&&t.mode!=r1.STEREO||(t.short_blocks=A1.short_block_coupled),t.quant_comp<0&&(t.quant_comp=1),t.quant_comp_short<0&&(t.quant_comp_short=0),t.msfix<0&&(t.msfix=0),t.exp_nspsytune=1|t.exp_nspsytune,t.internal_flags.nsPsy.attackthre<0&&(t.internal_flags.nsPsy.attackthre=x1.NSATTACKTHRE),t.internal_flags.nsPsy.attackthre_s<0&&(t.internal_flags.nsPsy.attackthre_s=x1.NSATTACKTHRE_S),t.scale<0&&(t.scale=1),t.ATHtype<0&&(t.ATHtype=4),t.ATHcurve<0&&(t.ATHcurve=4),t.athaa_loudapprox<0&&(t.athaa_loudapprox=2),t.interChRatio<0&&(t.interChRatio=0),t.useTemporal==null&&(t.useTemporal=!0),i.slot_lag=i.frac_SpF=0,t.VBR==Y.vbr_off&&(i.slot_lag=i.frac_SpF=72e3*(t.version+1)*t.brate%t.out_samplerate|0),C.iteration_init(t),p.psymodel_init(t),0},this.lame_encode_flush=function(t,e,l,i){var a,_,v,u,c=t.internal_flags,b=d1([2,1152]),h=0,d=c.mf_samples_to_encode-M.POSTDELAY,m=O(t);if(c.mf_samples_to_encode<1)return 0;for(a=0,t.in_samplerate!=t.out_samplerate&&a1(),(v=t.framesize-d%t.framesize)<576&&(v+=t.framesize),t.encoder_padding=v,u=(d+v)/t.framesize;0<u&&0<=h;){var f=m-c.mf_size,S=t.frameNum;f*=t.in_samplerate,1152<(f/=t.out_samplerate)&&(f=1152),f<1&&(f=1),_=i-a,i==0&&(_=0),h=this.lame_encode_buffer(t,b[0],b[1],f,e,l,_),l+=h,a+=h,u-=S!=t.frameNum?1:0}return c.mf_samples_to_encode=0,h<0?h:(_=i-a,i==0&&(_=0),$.flush_bitstream(t),(h=$.copy_buffer(c,e,l,_,1))<0?h:(l+=h,_=i-(a+=h),i==0&&(_=0),t.write_id3tag_automatic&&a1(),a))},this.lame_encode_buffer=function(t,e,l,i,a,_,v){var u,c,b=t.internal_flags,h=[null,null];if(b.Class_ID!=A)return-3;if(i==0)return 0;c=i,((u=b).in_buffer_0==null||u.in_buffer_nsamples<c)&&(u.in_buffer_0=i1(c),u.in_buffer_1=i1(c),u.in_buffer_nsamples=c),h[0]=b.in_buffer_0,h[1]=b.in_buffer_1;for(var d=0;d<i;d++)h[0][d]=e[d],1<b.channels_in&&(h[1][d]=l[d]);return function(m,f,S,T,R,P,I){var y,w,x,D,N,B=m.internal_flags,E=0,H=[null,null],F=[null,null];if(B.Class_ID!=A)return-3;if(T==0)return 0;if((N=$.copy_buffer(B,R,P,I,0))<0)return N;if(P+=N,E+=N,F[0]=f,F[1]=S,b1.NEQ(m.scale,0)&&b1.NEQ(m.scale,1))for(w=0;w<T;++w)F[0][w]*=m.scale,B.channels_out==2&&(F[1][w]*=m.scale);if(b1.NEQ(m.scale_left,0)&&b1.NEQ(m.scale_left,1))for(w=0;w<T;++w)F[0][w]*=m.scale_left;if(b1.NEQ(m.scale_right,0)&&b1.NEQ(m.scale_right,1))for(w=0;w<T;++w)F[1][w]*=m.scale_right;m.num_channels==2&&B.channels_out==1&&a1(),D=O(m),H[0]=B.mfbuf[0],H[1]=B.mfbuf[1];for(var z,K,U,J,Z,e1,p1,W=0;0<T;){var t1=[null,null],c1=0,Q=0;t1[0]=F[0],t1[1]=F[1];var B1=new L;if(k(m,H,t1,W,T,B1),c1=B1.n_in,Q=B1.n_out,B.findReplayGain&&!B.decode_on_the_fly&&V.AnalyzeSamples(B.rgdata,H[0],B.mf_size,H[1],B.mf_size,Q,B.channels_out)==h1.GAIN_ANALYSIS_ERROR)return-6;if(T-=c1,W+=c1,B.channels_out,B.mf_size+=Q,B.mf_samples_to_encode<1&&a1(),B.mf_samples_to_encode+=Q,B.mf_size>=D){var O1=I-E;if(I==0&&(O1=0),z=m,K=H[0],U=H[1],J=R,Z=P,e1=O1,p1=n.enc.lame_encode_mp3_frame(z,K,U,J,Z,e1),z.frameNum++,(y=p1)<0)return y;for(P+=y,E+=y,B.mf_size-=m.framesize,B.mf_samples_to_encode-=m.framesize,x=0;x<B.channels_out;x++)for(w=0;w<B.mf_size;w++)H[x][w]=H[x][w+m.framesize]}}return E}(t,h[0],h[1],i,a,_,v)}}m1.SFBMAX=3*M.SBMAX_s,M.ENCDELAY=576,M.POSTDELAY=1152,M.FFTOFFSET=224+(M.MDCTDELAY=48),M.DECDELAY=528,M.SBLIMIT=32,M.CBANDS=64,M.SBPSY_l=21,M.SBPSY_s=12,M.SBMAX_l=22,M.SBMAX_s=13,M.PSFB21=6,M.PSFB12=6,M.HBLKSIZE=(M.BLKSIZE=1024)/2+1,M.HBLKSIZE_s=(M.BLKSIZE_s=256)/2+1,M.NORM_TYPE=0,M.START_TYPE=1,M.SHORT_TYPE=2,M.STOP_TYPE=3,M.MPG_MD_LR_LR=0,M.MPG_MD_LR_I=1,M.MPG_MD_MS_LR=2,M.MPG_MD_MS_I=3,M.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],C1.MFSIZE=3456+M.ENCDELAY-M.MDCTDELAY,C1.MAX_HEADER_BUF=256,C1.MAX_BITS_PER_CHANNEL=4095,C1.MAX_BITS_PER_GRANULE=7680,C1.BPC=320,m1.SFBMAX=3*M.SBMAX_s,W1.Mp3Encoder=function(V,$,j){V!=1&&a1("fix cc: only supports mono");var C=new _1,f1=new function(){this.setModules=function(_,v){}},n=new h1,o=new b1,r=new function(){function _(h,d,m,f,S,T,R,P,I,y,w,x,D,N){this.quant_comp=d,this.quant_comp_s=m,this.safejoint=f,this.nsmsfix=S,this.st_lrm=T,this.st_s=R,this.nsbass=P,this.scale=I,this.masking_adj=y,this.ath_lower=w,this.ath_curve=x,this.interch=D,this.sfscale=N}var v;function u(h,d,m){a1()}this.setModules=function(h){v=h};var c=[new _(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new _(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new _(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new _(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new _(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new _(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new _(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new _(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new _(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new _(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new _(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new _(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new _(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new _(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new _(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new _(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new _(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function b(h,d,m){var f=d,S=v.nearestBitrateFullIndex(d);if(h.VBR=Y.vbr_abr,h.VBR_mean_bitrate_kbps=f,h.VBR_mean_bitrate_kbps=Math.min(h.VBR_mean_bitrate_kbps,320),h.VBR_mean_bitrate_kbps=Math.max(h.VBR_mean_bitrate_kbps,8),h.brate=h.VBR_mean_bitrate_kbps,320<h.VBR_mean_bitrate_kbps&&(h.disable_reservoir=!0),0<c[S].safejoint&&(h.exp_nspsytune=2|h.exp_nspsytune),0<c[S].sfscale&&(h.internal_flags.noise_shaping=2),0<Math.abs(c[S].nsbass)){var T=int(4*c[S].nsbass);T<0&&(T+=64),h.exp_nspsytune=h.exp_nspsytune|T<<2}return m!=0?h.quant_comp=c[S].quant_comp:0<Math.abs(h.quant_comp- -1)||(h.quant_comp=c[S].quant_comp),m!=0?h.quant_comp_short=c[S].quant_comp_s:0<Math.abs(h.quant_comp_short- -1)||(h.quant_comp_short=c[S].quant_comp_s),m!=0?h.msfix=c[S].nsmsfix:0<Math.abs(h.msfix- -1)||(h.msfix=c[S].nsmsfix),m!=0?h.internal_flags.nsPsy.attackthre=c[S].st_lrm:0<Math.abs(h.internal_flags.nsPsy.attackthre- -1)||(h.internal_flags.nsPsy.attackthre=c[S].st_lrm),m!=0?h.internal_flags.nsPsy.attackthre_s=c[S].st_s:0<Math.abs(h.internal_flags.nsPsy.attackthre_s- -1)||(h.internal_flags.nsPsy.attackthre_s=c[S].st_s),m!=0?h.scale=c[S].scale:0<Math.abs(h.scale- -1)||(h.scale=c[S].scale),m!=0?h.maskingadjust=c[S].masking_adj:0<Math.abs(h.maskingadjust-0)||(h.maskingadjust=c[S].masking_adj),0<c[S].masking_adj?m!=0?h.maskingadjust_short=.9*c[S].masking_adj:0<Math.abs(h.maskingadjust_short-0)||(h.maskingadjust_short=.9*c[S].masking_adj):m!=0?h.maskingadjust_short=1.1*c[S].masking_adj:0<Math.abs(h.maskingadjust_short-0)||(h.maskingadjust_short=1.1*c[S].masking_adj),m!=0?h.ATHlower=-c[S].ath_lower/10:0<Math.abs(10*-h.ATHlower-0)||(h.ATHlower=-c[S].ath_lower/10),m!=0?h.ATHcurve=c[S].ath_curve:0<Math.abs(h.ATHcurve- -1)||(h.ATHcurve=c[S].ath_curve),m!=0?h.interChRatio=c[S].interch:0<Math.abs(h.interChRatio- -1)||(h.interChRatio=c[S].interch),d}this.apply_preset=function(h,d,m){switch(d){case _1.R3MIX:d=_1.V3,h.VBR=Y.vbr_mtrh;break;case _1.MEDIUM:d=_1.V4,h.VBR=Y.vbr_rh;break;case _1.MEDIUM_FAST:d=_1.V4,h.VBR=Y.vbr_mtrh;break;case _1.STANDARD:d=_1.V2,h.VBR=Y.vbr_rh;break;case _1.STANDARD_FAST:d=_1.V2,h.VBR=Y.vbr_mtrh;break;case _1.EXTREME:d=_1.V0,h.VBR=Y.vbr_rh;break;case _1.EXTREME_FAST:d=_1.V0,h.VBR=Y.vbr_mtrh;break;case _1.INSANE:return d=320,h.preset=d,b(h,d,m),h.VBR=Y.vbr_off,d}switch(h.preset=d){case _1.V9:return u(),d;case _1.V8:return u(),d;case _1.V7:return u(),d;case _1.V6:return u(),d;case _1.V5:return u(),d;case _1.V4:return u(),d;case _1.V3:return u(),d;case _1.V2:return u(),d;case _1.V1:return u(),d;case _1.V0:return u(),d}return 8<=d&&d<=320?b(h,d,m):(h.preset=0,d)}},p=new M1,s=new n1,g=new g1,A=new function(){this.getLameShortVersion=function(){return"3.98.4"}},q=new function(){this.setModules=function(_,v){}},O=new function(){var _;this.setModules=function(v){_=v},this.ResvFrameBegin=function(v,u){var c,b=v.internal_flags,h=b.l3_side,d=_.getframebits(v);u.bits=(d-8*b.sideinfo_len)/b.mode_gr;var m=2048*b.mode_gr-8;320<v.brate?a1():(c=11520,v.strict_ISO&&a1()),b.ResvMax=c-d,b.ResvMax>m&&(b.ResvMax=m),(b.ResvMax<0||v.disable_reservoir)&&(b.ResvMax=0);var f=u.bits*b.mode_gr+Math.min(b.ResvSize,b.ResvMax);return c<f&&(f=c),h.resvDrain_pre=0,b.pinfo!=null&&a1(),f},this.ResvMaxBits=function(v,u,c,b){var h,d=v.internal_flags,m=d.ResvSize,f=d.ResvMax;b!=0&&(m+=u),1&d.substep_shaping&&(f*=.9),c.bits=u,9*f<10*m?(h=m-9*f/10,c.bits+=h,d.substep_shaping|=128):(h=0,d.substep_shaping&=127,v.disable_reservoir||1&d.substep_shaping||(c.bits-=.1*u));var S=m<6*d.ResvMax/10?m:6*d.ResvMax/10;return(S-=h)<0&&(S=0),S},this.ResvAdjust=function(v,u){v.ResvSize-=u.part2_3_length+u.part2_length},this.ResvFrameEnd=function(v,u){var c,b=v.l3_side;v.ResvSize+=u*v.mode_gr;var h=0;b.resvDrain_post=0,(b.resvDrain_pre=0)!=(c=v.ResvSize%8)&&(h+=c),0<(c=v.ResvSize-h-v.ResvMax)&&(h+=c);var d=Math.min(8*b.main_data_begin,h)/8;b.resvDrain_pre+=8*d,h-=8*d,v.ResvSize-=8*d,b.main_data_begin-=d,b.resvDrain_post+=h,v.ResvSize-=h}},L=new u1,k=new function(){this.setModules=function(_,v,u){}},t=new function(){};C.setModules(n,o,r,p,s,g,A,q,t),o.setModules(n,t,A,g),q.setModules(o,A),r.setModules(C),s.setModules(o,O,p,L),p.setModules(L,O,C.enc.psy),O.setModules(o),L.setModules(p),g.setModules(C,o,A),f1.setModules(k,t),k.setModules(A,q,r);var e=C.lame_init();e.num_channels=V,e.in_samplerate=$,e.out_samplerate=$,e.brate=j,e.mode=r1.STEREO,e.quality=3,e.bWriteVbrTag=!1,e.disable_reservoir=!0,e.write_id3tag_automatic=!1,C.lame_init_params(e);var l=1152,i=0|1.25*l+7200,a=S1(i);this.encodeBuffer=function(_,v){V==1&&(v=_),_.length>l&&(l=_.length,a=S1(i=0|1.25*l+7200));var u=C.lame_encode_buffer(e,_,v,_.length,a,0,i);return new Int8Array(a.subarray(0,u))},this.flush=function(){var _=C.lame_encode_flush(e,a,0,i);return new Int8Array(a.subarray(0,_))}}}W1(),le.lamejs=W1}((typeof window=="object"&&window.document?window:Object).Recorder)})(Ce);var Pe=Ce.exports;const He=Re(Pe);var Ee={exports:{}};(function(oe){(function(le){var W1=typeof window=="object"&&!!window.document,q1=W1?window:Object;(function(a1,S1){var J1=function(){},l1=function(n){return typeof n=="number"},i1=function(n){return JSON.stringify(n)},G=function(n){return new w1(n)},T1=G.LM="2025-01-11 09:28",H1="https://github.com/xiangyuecn/Recorder",d1="Recorder",R1="getUserMedia",N1="srcSampleRate",o1="sampleRate",v1="bitRate",A1="catch",k1=a1[d1];if(k1&&k1.LM==T1)return k1.CLog(k1.i18n.$T("K8zP::重复导入{1}",0,d1),3);G.IsOpen=function(){var n=G.Stream;if(n){var o=m1(n),r=o[0];if(r){var p=r.readyState;return p=="live"||p==r.LIVE}}return!1},G.BufferSize=4096,G.Destroy=function(){for(var n in n1(d1+" Destroy"),M1(),Y)Y[n]()};var Y={};G.BindDestroy=function(n,o){Y[n]=o},G.Support=function(){if(!S1)return!1;var n=navigator.mediaDevices||{};return n[R1]||(n=navigator)[R1]||(n[R1]=n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia),!!n[R1]&&(G.Scope=n,!!G.GetContext())},G.GetContext=function(n){if(!S1)return null;var o=window.AudioContext;if(o||(o=window.webkitAudioContext),!o)return null;var r=G.Ctx,p=0;return r||(r=G.Ctx=new o,p=1,G.NewCtxs=G.NewCtxs||[],G.BindDestroy("Ctx",function(){var s=G.Ctx;s&&s.close&&(r1(s),G.Ctx=0);var g=G.NewCtxs;G.NewCtxs=[];for(var A=0;A<g.length;A++)r1(g[A])})),n&&r.close&&(p||(r._useC||r1(r),r=new o),r._useC=1,G.NewCtxs.push(r)),r},G.CloseNewCtx=function(n){if(n&&n.close){r1(n);for(var o=G.NewCtxs||[],r=o.length,p=0;p<o.length;p++)if(o[p]==n){o.splice(p,1);break}n1(C("mSxV::剩{1}个GetContext未close",0,r+"-1="+o.length),o.length?3:0)}};var r1=function(n){if(n&&n.close&&!n._isC&&(n._isC=1,n.state!="closed"))try{n.close()}catch(o){n1("ctx close err",1,o)}},u1=G.ResumeCtx=function(n,o,r,p){var s=0,g=0,A=0,q=0,O="EventListener",L="ResumeCtx ",k=function(l,i){g&&t(),s||(s=1,l&&p(l,q),i&&r(q)),i&&(!n._LsSC&&n["add"+O]&&n["add"+O]("statechange",e),n._LsSC=1,A=1)},t=function(l){if(!l||!g){g=l?1:0;for(var i=["focus","mousedown","mouseup","touchstart","touchend"],a=0;a<i.length;a++)window[(l?"add":"remove")+O](i[a],e,!0)}},e=function(){var l=n.state,i=h1(l);if(!s&&!o(i?++q:q))return k();i?(A&&n1(L+"sc "+l,3),t(1),n.resume().then(function(){A&&n1(L+"sc "+n.state),k(0,1)})[A1](function(a){n1(L+"error",1,a),h1(n.state)||k(a.message||"error")})):l=="closed"?(A&&!n._isC&&n1(L+"sc "+l,1),k("ctx closed")):k(0,1)};e()},h1=G.CtxSpEnd=function(n){return n=="suspended"||n=="interrupted"},g1=function(n){var o=n.state,r="ctx.state="+o;return h1(o)&&(r+=C("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),r},b1="ConnectEnableWebM";G[b1]=!0;var s1="ConnectEnableWorklet";G[s1]=!1;var X=function(n){var o=n.BufferSize||G.BufferSize,r=n.Stream,p=r._c,s=p[o1],g={},A=m1(r),q=A[0],O=null,L="";if(q&&q.getSettings){var k=(O=q.getSettings())[o1];k&&k!=s&&(L=C("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,k,s))}r._ts=O,n1(L+"Stream TrackSet: "+i1(O),L?3:0);var t,e,l,i=function(P){var I=r._m=p.createMediaStreamSource(r),y=p.destination,w="createMediaStreamDestination";p[w]&&(y=r._d=p[w]()),I.connect(P),P.connect(y)},a="",_=r._call,v=function(P,I){for(var y in _){if(I!=s){g.index=0;var w=(g=G.SampleData([P],I,s,g,{_sum:1})).data,x=g._sum}else{g={};for(var D=P.length,w=new Int16Array(D),x=0,N=0;N<D;N++){var B=Math.max(-1,Math.min(1,P[N]));B=B<0?32768*B:32767*B,w[N]=B,x+=Math.abs(B)}}for(var E in _)_[E](w,x);return}},u="ScriptProcessor",c="audioWorklet",b=d1+" "+c,h="RecProc",d="MediaRecorder",m=d+".WebM.PCM",f=p.createScriptProcessor||p.createJavaScriptNode,S=C("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,c),T=function(){e=r.isWorklet=!1,L1(r),n1(C("7TU0::Connect采用老的{1}，",0,u)+j.get(C(G[s1]?"JwCL::但已设置{1}尝试启用{2}":"VGjB::可设置{1}尝试启用{2}",2),[d1+"."+s1+"=true",c])+a+S,3);var P=r._p=f.call(p,o,1,1);i(P),P.onaudioprocess=function(I){var y=I.inputBuffer.getChannelData(0);v(y,s)}},R=function(){t=r.isWebM=!1,y1(r),e=r.isWorklet=!f||G[s1];var P=window.AudioWorkletNode;if(e&&p[c]&&P){var I=function(){return e&&r._na},y=r._na=function(){l!==""&&(clearTimeout(l),l=setTimeout(function(){l=0,I()&&(n1(C("MxX1::{1}未返回任何音频，恢复使用{2}",0,c,u),3),f&&T())},500))},w=function(){if(I()){var D=r._n=new P(p,h,{processorOptions:{bufferSize:o}});i(D),D.port.onmessage=function(N){l&&(clearTimeout(l),l=""),I()?v(N.data.val,s):e||n1(C("XUap::{1}多余回调",0,c),3)},n1(C("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,c,d1+"."+s1+"=false",u)+a+S,3)}},x=function(){if(I())if(p[h])w();else{var D,N,B=(N="class "+h+" extends AudioWorkletProcessor{",N+="constructor "+(D=function(E){return E.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,b)})(function(E){DEL_super(E);var H=this,F=E.processorOptions.bufferSize;H.bufferSize=F,H.buffer=new Float32Array(2*F),H.pos=0,H.port.onmessage=function(z){z.data.kill&&(H.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",E)}),N+="process "+D(function(E,H,F){var z=this,K=z.bufferSize,U=z.buffer,J=z.pos;if((E=(E[0]||[])[0]||[]).length){U.set(E,J);var Z=~~((J+=E.length)/K)*K;if(Z){this.port.postMessage({val:U.slice(0,Z)});var e1=U.subarray(Z,J);(U=new Float32Array(2*K)).set(e1),J=e1.length,z.buffer=U}z.pos=J}return!z.kill}),N=(N+='}try{registerProcessor("'+h+'", '+h+')}catch(e){$C.error("'+b+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(N))));p[c].addModule(B).then(function(E){I()&&(p[h]=1,w(),l&&y())})[A1](function(E){n1(c+".addModule Error",1,E),I()&&T()})}};u1(p,function(){return I()},x,x)}else T()};(function(){var P=window[d],I="ondataavailable",y="audio/webm; codecs=pcm";t=r.isWebM=G[b1];var w=P&&I in P.prototype&&P.isTypeSupported(y);if(a=w?"":C("VwPd::（此浏览器不支持{1}）",0,m),!t||!w)return R();var x=function(){return t&&r._ra};r._ra=function(){l!==""&&(clearTimeout(l),l=setTimeout(function(){x()&&(n1(C("vHnb::{1}未返回任何音频，降级使用{2}",0,d,c),3),R())},500))};var D=Object.assign({mimeType:y},G.ConnectWebMOptions),N=r._r=new P(r,D),B=r._rd={};N[I]=function(E){var H=new FileReader;H.onloadend=function(){if(x()){var F=C1(new Uint8Array(H.result),B);if(!F)return;if(F==-1)return void R();l&&(clearTimeout(l),l=""),v(F,B.webmSR)}else t||n1(C("O9P7::{1}多余回调",0,d),3)},H.readAsArrayBuffer(E.data)};try{N.start(~~(o/48)),n1(C("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,m,d1+"."+b1+"=false",c,u))}catch(E){n1("mr start err",1,E),R()}})()},E1=function(n){n._na&&n._na(),n._ra&&n._ra()},L1=function(n){n._na=null,n._n&&(n._n.port.postMessage({kill:!0}),n._n.disconnect(),n._n=null)},y1=function(n){if(n._ra=null,n._r){try{n._r.stop()}catch(o){n1("mr stop err",1,o)}n._r=null}},M1=function(n){var o=(n=n||G)==G,r=n.Stream;r&&(r._m&&(r._m.disconnect(),r._m=null),!r._RC&&r._c&&G.CloseNewCtx(r._c),r._RC=null,r._c=null,r._d&&(I1(r._d.stream),r._d=null),r._p&&(r._p.disconnect(),r._p.onaudioprocess=r._p=null),L1(r),y1(r),o&&I1(r)),n.Stream=0},I1=G.StopS_=function(n){for(var o=m1(n),r=0;r<o.length;r++){var p=o[r];p.stop&&p.stop()}n.stop&&n.stop()},m1=function(n){var o=0,r=0,p=[];n.getAudioTracks&&(o=n.getAudioTracks(),r=n.getVideoTracks()),o||(o=n.audioTracks,r=n.videoTracks);for(var s=0,g=o?o.length:0;s<g;s++)p.push(o[s]);for(var s=0,g=r?r.length:0;s<g;s++)p.push(r[s]);return p};G.SampleData=function(n,o,r,p,s){var g="SampleData";p||(p={});var A=p.index||0,q=p.offset||0,O=p.raisePrev||0,L=p.filter;if(L&&L.fn&&(L.sr&&L.sr!=o||L.srn&&L.srn!=r)&&(L=null,n1(C("d48C::{1}的filter采样率变了，重设滤波",0,g),3)),!L)if(r<=o){var k=3*o/4<r?0:r/2*3/4;L={fn:k?G.IIRFilter(!0,o,k):0}}else{var k=3*r/4<o?0:o/2*3/4;L={fn:k?G.IIRFilter(!0,r,k):0}}L.sr=o,L.srn=r;var t=L.fn,e=p.frameNext||[];s||(s={});var l=s.frameSize||1;s.frameType&&(l=s.frameType=="mp3"?1152:1);var i=s._sum,a=0,_=n.length;_+1<A&&n1(C("tlbC::{1}似乎传入了未重置chunk {2}",0,g,A+">"+_),3);for(var v=0,u=A;u<_;u++)v+=n[u].length;var c=o/r;if(1<c)v=Math.max(0,v-Math.floor(q)),v=Math.floor(v/c);else if(c<1){var b=1/c;v=Math.floor(v*b)}v+=e.length;for(var h=new Int16Array(v),d=0,u=0;u<e.length;u++)h[d]=e[u],d++;for(;A<_;A++){var m=n[A],f=m instanceof Float32Array,u=q,S=m.length,T=t&&t.Embed,R=0,P=0,I=0,y=0;if(c<1){for(var w=d+u,x=O,D=0;D<S;D++){var N=m[D];f&&(N=(N=Math.max(-1,Math.min(1,N)))<0?32768*N:32767*N);var B=Math.floor(w);w+=b;for(var E=Math.floor(w),H=(N-x)/(E-B),F=1;B<E;B++,F++){var z=Math.floor(x+F*H);T?(I=z,y=T.b0*I+T.b1*T.x1+T.b0*T.x2-T.a1*T.y1-T.a2*T.y2,T.x2=T.x1,T.x1=I,T.y2=T.y1,T.y1=y,z=y):z=t?t(z):z,32767<z?z=32767:z<-32768&&(z=-32768),i&&(a+=Math.abs(z)),h[B]=z,d++}x=O=N,u+=b}q=u%1}else{for(var D=0,K=0;D<S;D++,K++){if(K<S){var N=m[K];f&&(N=(N=Math.max(-1,Math.min(1,N)))<0?32768*N:32767*N),T?(I=N,y=T.b0*I+T.b1*T.x1+T.b0*T.x2-T.a1*T.y1-T.a2*T.y2,T.x2=T.x1,T.x1=I,T.y2=T.y1,T.y1=y):y=t?t(N):N}if(R=P,P=y,K!=0){var U=Math.floor(u);if(D==U){var J=Math.ceil(u),Z=u-U,e1=R,p1=J<S?P:e1,W=e1+(p1-e1)*Z;32767<W?W=32767:W<-32768&&(W=-32768),i&&(a+=Math.abs(W)),h[d]=W,d++,u+=c}}else D--}q=Math.max(0,u-S)}}c<1&&d+1==v&&(v--,h=new Int16Array(h.buffer.slice(0,2*v))),d-1!=v&&d!=v&&n1(g+" idx:"+d+" != size:"+v,3),e=null;var t1=v%l;if(0<t1){var c1=2*(v-t1);e=new Int16Array(h.buffer.slice(c1)),h=new Int16Array(h.buffer.slice(0,c1))}var Q={index:A,offset:q,raisePrev:O,filter:L,frameNext:e,sampleRate:r,data:h};return i&&(Q._sum=a),Q},G.IIRFilter=function(n,o,r){var p=2*Math.PI*r/o,s=Math.sin(p),g=Math.cos(p),A=s/2,q=1+A,O=-2*g/q,L=(1-A)/q;if(n)var k=(1-g)/2/q,t=(1-g)/q;else var k=(1+g)/2/q,t=-(1+g)/q;var e=0,l=0,i=0,a=0,_=0,v=function(u){return i=k*u+t*e+k*l-O*a-L*_,l=e,e=u,_=a,a=i};return v.Embed={x1:0,x2:0,y1:0,y2:0,b0:k,b1:t,a1:O,a2:L},v},G.PowerLevel=function(n,o){var r=n/o||0;return r<1251?Math.round(r/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(r/1e4)/Math.log(10)))))},G.PowerDBFS=function(n){var o=Math.max(.1,n||0);return o=Math.min(o,32767),o=20*Math.log(o/32767)/Math.log(10),Math.max(-100,Math.round(o))},G.CLog=function(n,o){if(typeof console=="object"){var r=new Date,p=("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3),s=this&&this.envIn&&this.envCheck&&this.id,g=["["+p+" "+d1+(s?":"+s:"")+"]"+n],A=arguments,q=G.CLog,O=2,L=q.log||console.log;for(l1(o)?L=o==1?q.error||console.error:o==3?q.warn||console.warn:L:O=1;O<A.length;O++)g.push(A[O]);P1?L&&L("[IsLoser]"+g[0],1<g.length?g:""):L.apply(console,g)}};var n1=function(){G.CLog.apply(this,arguments)},P1=!0;try{P1=!console.log.apply}catch{}var M=0;function w1(n){var o=this;o.id=++M,f1();var r={type:"mp3",onProcess:J1};for(var p in n)r[p]=n[p];var s=(o.set=r)[v1],g=r[o1];(s&&!l1(s)||g&&!l1(g))&&o.CLog(C.G("IllegalArgs-1",[C("VtS4::{1}和{2}必须是数值",0,o1,v1)]),1,n),r[v1]=+s||16,r[o1]=+g||16e3,o.state=0,o._S=9,o.Sync={O:9,C:9}}G.Sync={O:9,C:9},G.prototype=w1.prototype={CLog:n1,_streamStore:function(){return this.set.sourceStream?this:G},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var n=this._streamGet();return n&&n._c},open:function(n,o){var r=this,p=r.set,s=r._streamStore(),g=0;n=n||J1;var A=function(m,f){f=!!f,r.CLog(C("5tWi::录音open失败：")+m+",isUserNotAllow:"+f,1),g&&G.CloseNewCtx(g),o&&o(m,f)};r._streamTag=R1;var q=function(){r.CLog("open ok, id:"+r.id+" stream:"+r._streamTag),n(),r._SO=0},O=s.Sync,L=++O.O,k=O.C;if(r._O=r._O_=L,r._SO=r._S,S1){var t=r.envCheck({envName:"H5",canProcess:!0});if(t)A(C("A5bm::不能录音：")+t);else{var e,l=function(){(e=p.runningContext)||(e=g=G.GetContext(!0))};if(p.sourceStream){if(r._streamTag="set.sourceStream",!G.GetContext())return void A(C("1iU7::不支持此浏览器从流中获取录音"));l(),M1(s);var i=r.Stream=p.sourceStream;i._c=e,i._RC=p.runningContext,i._call={};try{X(s)}catch(m){return M1(s),void A(C("BTW2::从流中打开录音失败：")+m.message)}q()}else{var a=function(m,f){try{window.top.a}catch{return void A(C("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'))}_(1,m)&&(/Found/i.test(m)?A(f+C("jBa9::，无可用麦克风")):A(f))},_=function(m,f){if(/Permission|Allow/i.test(f))m&&A(C("gyO5::用户拒绝了录音权限"),!0);else{if(window.isSecureContext!==!1)return 1;m&&A(C("oWNo::浏览器禁止不安全页面录音，可开启https解决"))}};if(G.IsOpen())q();else if(G.Support()){l();var v,u,c=function(m){setTimeout(function(){m._call={};var f=G.Stream;f&&(M1(),m._call=f._call),(G.Stream=m)._c=e,m._RC=p.runningContext,function(){if(k!=O.C||!r._O){var S=C("dFm8::open被取消");return L==O.O?r.close():S=C("VtJO::open被中断"),A(S),!0}}()||(G.IsOpen()?(f&&r.CLog(C("upb8::发现同时多次调用open"),1),X(s),q()):A(C("Q1GA::录音功能无效：无音频流")))},100)},b=function(m){var f=m.name||m.message||m.code+":"+m,S="";h==1&&_(0,f)&&(S=C("KxE2::，将尝试禁用回声消除后重试"));var T=C("xEQR::请求录音权限错误"),R=C("bDOG::无法录音：");r.CLog(T+S+"|"+m,S||u?3:1,m),S?(v=f,u=m,d(1)):u?(r.CLog(T+"|"+u,1,u),a(v,R+u)):a(f,R+m)},h=0,d=function(m){h++;var f="audioTrackSet",S="autoGainControl",T="echoCancellation",R="noiseSuppression",P=JSON.parse(i1(p[f]||!0));r.CLog("open... "+h+" "+f+":"+i1(P)),m&&(typeof P!="object"&&(P={}),P[S]=!1,P[T]=!1,P[R]=!1),P[o1]&&r.CLog(C("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,f+"."+o1),3);var I={audio:P,video:p.videoTrackSet||!1};try{var y=G.Scope[R1](I,c,b)}catch(w){r.CLog(R1,3,w),I={audio:!0,video:!1},y=G.Scope[R1](I,c,b)}r.CLog(R1+"("+i1(I)+") "+g1(e)+C("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,"audioTrackSet:{echoCancellation,noiseSuppression,autoGainControl}",f)+"("+H1+") LM:"+T1+" UA:"+navigator.userAgent),y&&y.then&&y.then(c)[A1](b)};d()}else a("",C("COxc::此浏览器不支持录音"))}}}else A(C.G("NonBrowser-1",["open"])+C("EMJq::，可尝试使用RecordApp解决方案")+"("+H1+"/tree/master/app-support-sample)")},close:function(n){n=n||J1;var o=this,r=o._streamStore();o._stop();var p=" stream:"+o._streamTag,s=r.Sync;if(o._O=0,o._O_!=s.O)return o.CLog(C("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+p,3),void n();s.C++,M1(r),o.CLog("close,"+p),n()},mock:function(n,o){var r=this;return r._stop(),r.isMock=1,r.mockEnvInfo=null,r.buffers=[n],r.recSize=n.length,r._setSrcSR(o),r._streamTag="mock",r},_setSrcSR:function(n){var o=this.set,r=o[o1];n<r?o[o1]=n:r=0,this[N1]=n,this.CLog(N1+": "+n+" set."+o1+": "+o[o1]+(r?" "+C("UHvm::忽略")+": "+r:""),r?3:0)},envCheck:function(n){var o,r=this.set,p="CPU_BE";if(o||G[p]||typeof Int8Array!="function"||new Int8Array(new Int32Array([1]).buffer)[0]||(f1(p),o=C("Essp::不支持{1}架构",0,p)),!o){var s=r.type,g=this[s+"_envCheck"];r.takeoffEncodeChunk&&(g?n.canProcess||(o=C("7uMV::{1}环境不支持实时处理",0,n.envName)):o=C("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,s)+(this[s]?"":C("LG7e::(未加载编码器)"))),!o&&g&&(o=this[s+"_envCheck"](n,r))}return o||""},envStart:function(n,o){var r=this,p=r.set;if(r.isMock=n?1:0,r.mockEnvInfo=n,r.buffers=[],r.recSize=0,n&&(r._streamTag="env$"+n.envName),r.state=1,r.envInLast=0,r.envInFirst=0,r.envInFix=0,r.envInFixTs=[],r._setSrcSR(o),r.engineCtx=0,r[p.type+"_start"]){var s=r.engineCtx=r[p.type+"_start"](p);s&&(s.pcmDatas=[],s.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(n,o){var r=this,p=r.set,s=r.engineCtx;if(r.state==1){var g=r[N1],A=n.length,q=G.PowerLevel(o,A),O=r.buffers,L=O.length;O.push(n);var k=O,t=L,e=Date.now(),l=Math.round(A/g*1e3);r.envInLast=e,r.buffers.length==1&&(r.envInFirst=e-l);var i=r.envInFixTs;i.splice(0,0,{t:e,d:l});for(var a=e,_=0,v=0;v<i.length;v++){var u=i[v];if(3e3<e-u.t){i.length=v;break}a=u.t,_+=u.d}var c=i[1],b=e-a,h=b-_;if(b/3<h&&(c&&1e3<b||6<=i.length)){var d=e-c.t-l;if(l/5<d){var m=!p.disableEnvInFix;if(r.CLog("["+e+"]"+j.get(C(m?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[d]),3),r.envInFix+=d,m){var f=new Int16Array(d*g/1e3);A+=f.length,O.push(f)}}}var S=r.recSize,T=A,R=S+T;if(r.recSize=R,s){var P=G.SampleData(O,g,p[o1],s.chunkInfo);s.chunkInfo=P,S=s.pcmSize,T=P.data.length,R=S+T,s.pcmSize=R,O=s.pcmDatas,L=O.length,O.push(P.data),g=P[o1]}var I=Math.round(R/g*1e3),y=O.length,w=k.length,x=function(){for(var H=D?0:-T,F=O[0]==null,z=L;z<y;z++){var K=O[z];K==null?F=1:(H+=K.length,s&&K.length&&r[p.type+"_encode"](s,K))}if(F&&s){var z=t;for(k[0]&&(z=0);z<w;z++)k[z]=null}F&&(H=D?T:0,O[0]=null),s?s.pcmSize+=H:r.recSize+=H},D=0,N="rec.set.onProcess";try{D=(D=p.onProcess(O,q,I,g,L,x))===!0}catch{}var B=Date.now()-e;if(10<B&&1e3<r.envInFirst-e&&r.CLog(N+C("2ghS::低性能，耗时{1}ms",0,B),3),D){for(var E=0,v=L;v<y;v++)O[v]==null?E=1:O[v]=new Int16Array(0);E?r.CLog(C("ufqH::未进入异步前不能清除buffers"),3):s?s.pcmSize-=T:r.recSize-=T}else x()}else r.state||r.CLog("envIn at state=0",3)},start:function(){var n=this,o=1;if(n.set.sourceStream?n.Stream||(o=0):G.IsOpen()||(o=0),o){var r=n._streamCtx();if(n.CLog(C("kLDN::start 开始录音，")+g1(r)+" stream:"+n._streamTag),n._stop(),n.envStart(null,r[o1]),n.state=3,n._SO&&n._SO+1!=n._S)n.CLog(C("Bp2y::start被中断"),3);else{n._SO=0;var p=function(){n.state==3&&(n.state=1,n.resume())},s="AudioContext resume: ",g=n._streamGet();g._call[n.id]=function(){n.CLog(s+r.state+"|stream ok"),p()},u1(r,function(A){return A&&n.CLog(s+"wait..."),n.state==3},function(A){A&&n.CLog(s+r.state),p()},function(A){n.CLog(s+r.state+C("upkE::，可能无法录音：")+A,1),p()})}}else n.CLog(C("6WmN::start失败：未open"),1)},pause:function(){var n=this,o=n._streamGet();n.state&&(n.state=2,n.CLog("pause"),o&&delete o._call[n.id])},resume:function(){var n=this,o=n._streamGet(),r="resume(wait ctx)";if(n.state==3)n.CLog(r);else if(n.state){n.state=1,n.CLog("resume"),n.envResume(),o&&(o._call[n.id]=function(s,g){n.state==1&&n.envIn(s,g)},E1(o));var p=n._streamCtx();p&&u1(p,function(s){return s&&n.CLog(r+"..."),n.state==1},function(s){s&&n.CLog(r+p.state),E1(o)},function(s){n.CLog(r+p.state+"[err]"+s,1)})}},_stop:function(n){var o=this,r=o.set;o.isMock||o._S++,o.state&&(o.pause(),o.state=0),!n&&o[r.type+"_stop"]&&(o[r.type+"_stop"](o.engineCtx),o.engineCtx=0)},stop:function(n,o,r){var p,s=this,g=s.set,A=s.envInLast-s.envInFirst,q=A&&s.buffers.length;s.CLog(C("Xq4s::stop 和start时差:")+(A?A+"ms "+C("3CQP::补偿:")+s.envInFix+"ms envIn:"+q+" fps:"+(q/A*1e3).toFixed(1):"-")+" stream:"+s._streamTag+" ("+H1+") LM:"+T1);var O=function(){s._stop(),r&&s.close()},L=function(u){s.CLog(C("u8JG::结束录音失败：")+u,1),o&&o(u),O()},k=function(u,c,b){var h="arraybuffer",d="dataType",m="DefaultDataType",f=s[d]||G[m]||"blob",S=d+"="+f,T=u instanceof ArrayBuffer,R=0,P=T?u.byteLength:u.size;if(f==h?T||(R=1):f=="blob"?typeof Blob!="function"?R=C.G("NonBrowser-1",[S])+C("1skY::，请设置{1}",0,d1+"."+m+'="'+h+'"'):(T&&(u=new Blob([u],{type:c})),u instanceof Blob||(R=1),c=u.type||c):R=C.G("NotSupport-1",[S]),s.CLog(C("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-p,b,P)+" "+S+","+c),R)L(R!=1?R:C("Vkbd::{1}编码器返回的不是{2}",0,g.type,f)+", "+S);else{if(g.takeoffEncodeChunk)s.CLog(C("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(P<Math.max(50,b/5))return void L(C("Sz2H::生成的{1}无效",0,g.type));n&&n(u,b,c),O()}};if(!s.isMock){var t=s.state==3;if(!s.state||t)return void L(C("wf9t::未开始录音")+(t?C("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""))}s._stop(!0);var e=s.recSize;if(e)if(s[g.type]){if(s.isMock){var l=s.envCheck(s.mockEnvInfo||{envName:"mock",canProcess:!1});if(l)return void L(C("AxOH::录音错误：")+l)}var i=s.engineCtx;if(s[g.type+"_complete"]&&i){var a=Math.round(i.pcmSize/g[o1]*1e3);return p=Date.now(),void s[g.type+"_complete"](i,function(u,c){k(u,c,a)},L)}if(p=Date.now(),s.buffers[0]){var _=G.SampleData(s.buffers,s[N1],g[o1]);g[o1]=_[o1];var v=_.data,a=Math.round(v.length/g[o1]*1e3);s.CLog(C("CxeT::采样:{1} 花:{2}ms",0,e+"->"+v.length,Date.now()-p)),setTimeout(function(){p=Date.now(),s[g.type](v,function(c,b){k(c,b,a)},function(c){L(c)})})}else L(C("xkKd::音频buffers被释放"))}else L(C("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,g.type,d1));else L(C("Ltz3::未采集到录音"))}};var C1=function(n,o){o.pos||(o.pos=[0],o.tracks={},o.bytes=[]);var r=o.tracks,p=[o.pos[0]],s=function(){o.pos[0]=p[0]},g=o.bytes.length,A=new Uint8Array(g+n.length);if(A.set(o.bytes),A.set(n,g),o.bytes=A,!o._ht){if(V(A,p),$(A,p),!x1(V(A,p),[24,83,128,103]))return;for(V(A,p);p[0]<A.length;){var q=V(A,p),O=$(A,p),L=[0],k=0;if(!O)return;if(x1(q,[22,84,174,107])){for(;L[0]<O.length;){var t=V(O,L),e=$(O,L),l=[0],i={channels:0,sampleRate:0};if(x1(t,[174]))for(;l[0]<e.length;){var a=V(e,l),_=$(e,l),v=[0];if(x1(a,[215])){var u=_1(_);i.number=u,r[u]=i}else if(x1(a,[131])){var u=_1(_);u==1?i.type="video":u==2?(i.type="audio",k||(o.track0=i),i.idx=k++):i.type="Type-"+u}else if(x1(a,[134])){for(var c="",b=0;b<_.length;b++)c+=String.fromCharCode(_[b]);i.codec=c}else if(x1(a,[225]))for(;v[0]<_.length;){var h=V(_,v),d=$(_,v);if(x1(h,[181])){var u=0,m=new Uint8Array(d.reverse()).buffer;d.length==4?u=new Float32Array(m)[0]:d.length==8?u=new Float64Array(m)[0]:n1("WebM Track !Float",1,d),i[o1]=Math.round(u)}else x1(h,[98,100])?i.bitDepth=_1(d):x1(h,[159])&&(i.channels=_1(d))}}}o._ht=1,n1("WebM Tracks",r),s();break}}}var f=o.track0;if(f){var S=f[o1];if(o.webmSR=S,f.bitDepth==16&&/FLOAT/i.test(f.codec)&&(f.bitDepth=32,n1("WebM 16->32 bit",3)),S<8e3||f.bitDepth!=32||f.channels<1||!/(\b|_)PCM\b/i.test(f.codec))return o.bytes=[],o.bad||n1("WebM Track Unexpected",3,o),-(o.bad=1);for(var T=[],R=0;p[0]<A.length;){var t=V(A,p),e=$(A,p);if(!e)break;if(x1(t,[163])){var P=15&e[0],i=r[P];if(!i)return n1("WebM !Track"+P,1,r),-1;if(i.idx===0){for(var I=new Uint8Array(e.length-4),b=4;b<e.length;b++)I[b-4]=e[b];T.push(I),R+=I.length}}s()}if(R){var y=new Uint8Array(A.length-o.pos[0]);y.set(A.subarray(o.pos[0])),o.bytes=y,o.pos[0]=0;for(var I=new Uint8Array(R),b=0,w=0;b<T.length;b++)I.set(T[b],w),w+=T[b].length;var m=new Float32Array(I.buffer);if(1<f.channels){for(var x=[],b=0;b<m.length;)x.push(m[b]),b+=f.channels;m=new Float32Array(x)}return m}}},x1=function(n,o){if(!n||n.length!=o.length)return!1;if(n.length==1)return n[0]==o[0];for(var r=0;r<n.length;r++)if(n[r]!=o[r])return!1;return!0},_1=function(n){for(var o="",r=0;r<n.length;r++){var p=n[r];o+=(p<16?"0":"")+p.toString(16)}return parseInt(o,16)||0},V=function(n,o,r){var p=o[0];if(!(p>=n.length)){var s=n[p],g=("0000000"+s.toString(2)).substr(-8),A=/^(0*1)(\d*)$/.exec(g);if(A){var q=A[1].length,O=[];if(!(p+q>n.length)){for(var L=0;L<q;L++)O[L]=n[p],p++;return r&&(O[0]=parseInt(A[2]||"0",2)),o[0]=p,O}}}},$=function(n,o){var r=V(n,o,1);if(r){var p=_1(r),s=o[0],g=[];if(p<2147483647){if(s+p>n.length)return;for(var A=0;A<p;A++)g[A]=n[s],s++}return o[0]=s,g}},j=G.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(n,o){var r=d1+".i18n.put: ",p=n.overwrite;p=p==null||p;var s=n.lang;if(!(s=j.alias[s]||s))throw new Error(r+"set.lang?");var g=j.locales[s];g||(g={},j.locales[s]=g);for(var A,q=/^([\w\-]+):/,O=0;O<o.length;O++){var L=o[O];if(A=q.exec(L)){var k=A[1],L=L.substr(k.length+1);!p&&g[k]||(g[k]=L)}else n1(r+"'key:'? "+L,3,n)}},get:function(){return j.v_G.apply(null,arguments)},v_G:function(n,o,r){o=o||[],r=r||j.lang,r=j.alias[r]||r;var p=j.locales[r],s=p&&p[n]||"";return s||r=="zh"?(j.lastLang=r,s=="=Empty"?"":s.replace(/\{(\d+)(\!?)\}/g,function(g,A,q){return g=o[(A=+A||0)-1],(A<1||A>o.length)&&(g="{?}",n1("i18n["+n+"] no {"+A+"}: "+s,3)),q?"":g})):r=="en"?j.v_G(n,o,"zh"):j.v_G(n,o,"en")},$T:function(){return j.v_T.apply(null,arguments)},v_T:function(){for(var n,o=arguments,r="",p=[],s=0,g=d1+".i18n.$T:",A=/^([\w\-]*):/,q=0;q<o.length;q++){var O=o[q];if(q==0){if(n=A.exec(O),!(r=n&&n[1]))throw new Error(g+"0 'key:'?");O=O.substr(r.length+1)}if(s===-1)p.push(O);else{if(s)throw new Error(g+" bad args");if(O===0)s=-1;else if(l1(O)){if(O<1)throw new Error(g+" bad args");s=O}else{var L=q==1?"en":q?"":"zh";if((n=A.exec(O))&&(L=n[1]||L,O=O.substr(n[1].length+1)),!n||!L)throw new Error(g+q+" 'lang:'?");j.put({lang:L,overwrite:!1},[r+":"+O])}}}return r?0<s?r:j.v_G(r,p):""}},C=j.$T;C.G=j.get,C("NonBrowser-1::非浏览器环境，不支持{1}",1),C("IllegalArgs-1::参数错误：{1}",1),C("NeedImport-2::调用{1}需要先导入{2}",2),C("NotSupport-1::不支持：{1}",1),G.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var f1=G.Traffic=function(n){if(S1){n=n?"/"+d1+"/Report/"+n:"";var o=G.TrafficImgUrl;if(o){var r=G.Traffic,p=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],s=p[1]||"http://file/",g=(p[0]||s)+n;if(o.indexOf("//")==0&&(o=/^https:/i.test(g)?"https:"+o:"http:"+o),n&&(o=o+"&cu="+encodeURIComponent(s+n)),!r[g]){r[g]=1;var A=new Image;A.src=o,n1("Traffic Analysis Image: "+(n||d1+".TrafficImgUrl="+G.TrafficImgUrl))}}}};k1&&(n1(C("8HO5::覆盖导入{1}",0,d1),1),k1.Destroy()),a1[d1]=G})(q1,W1),oe.exports&&(oe.exports=q1.Recorder)})(),function(le){var W1=typeof window=="object"&&!!window.document,q1=(W1?window:Object).Recorder,a1=q1.i18n;(function(S1,J1,l1,i1){S1.prototype.enc_wav={stable:!0,fast:!0,getTestMsg:function(){return l1("gPSE::支持位数8位、16位（填在比特率里面），采样率取值无限制；此编码器仅在pcm数据前加了一个44字节的wav头，编码出来的16位wav文件去掉开头的44字节即可得到pcm（注：其他wav编码器可能不是44字节）")}},S1.prototype.wav=function(G,T1,H1){var d1=this.set;(function(h1){var g1=h1.bitRate,b1=g1==8?8:16;g1!=b1&&S1.CLog(l1("wyw9::WAV Info: 不支持{1}位，已更新成{2}位",0,g1,b1),3),h1.bitRate=b1})(d1);var R1=G.length,N1=d1.sampleRate,o1=d1.bitRate,v1=R1*(o1/8),A1=S1.wav_header(1,1,N1,o1,v1),k1=A1.length,Y=new Uint8Array(k1+v1);if(Y.set(A1),o1==8)for(var r1=0;r1<R1;r1++){var u1=128+(G[r1]>>8);Y[k1++]=u1}else(Y=new Int16Array(Y.buffer)).set(G,k1/2);T1(Y.buffer,"audio/wav")},S1.wav_header=function(G,T1,H1,d1,R1){var N1=G==1?0:2,o1=new ArrayBuffer(44+N1),v1=new DataView(o1),A1=0,k1=function(u1){for(var h1=0;h1<u1.length;h1++,A1++)v1.setUint8(A1,u1.charCodeAt(h1))},Y=function(u1){v1.setUint16(A1,u1,!0),A1+=2},r1=function(u1){v1.setUint32(A1,u1,!0),A1+=4};return k1("RIFF"),r1(36+N1+R1),k1("WAVE"),k1("fmt "),r1(16+N1),Y(G),Y(T1),r1(H1),r1(H1*(T1*d1/8)),Y(T1*d1/8),Y(d1),G!=1&&Y(0),k1("data"),r1(R1),new Uint8Array(o1)}})(q1,0,a1.$T)}()})(Ee);var Oe=Ee.exports;const De=Re(Oe);export{He as R,De as a};
