import{s as F,u as T,e as W}from"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import{u as A}from"./index-BDeQYItE.js";import"./store@2.0.12-i6xqVJod.js";import{d as z,P as h,c as r,o as s,y as b,F as N,a as i,H as v,J as D,W as H,v as J,e as R,w as q,z as w,i as m,L as I}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{O as V,p as G}from"./@vue_shared@3.5.16-UwmvJIHj.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as S}from"./lodash-es@4.17.21-BYk7DlcU.js";import{v as K,u as Q,y as t}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";const X={class:"form-model-text"},Y={class:"supplier"},Z={class:"model"},ee=z({name:"undefined"}),le=z({...ee,name:"node-llm-form-model-text",props:{data:{type:Object,default:()=>({})}},setup(k){return(P,g)=>{var U,C;const $=h("el-text");return s(),r("div",X,[(C=(U=k.data)==null?void 0:U.params)!=null&&C.model?(s(),r(N,{key:0},[i("span",Y,V(k.data.supplierName),1),i("span",Z,V(k.data.params.model),1)],64)):(s(),b($,{key:1,color:"info",size:"small"},{default:v(()=>g[0]||(g[0]=[D("未选择模型")])),_:1,__:[0]}))])}}}),oe=O(le,[["__scopeId","data-v-f1c02abe"]]),se={class:"cl-flow__inner-item"},ae={key:0,class:"form-model"},te={class:"model"},ne={class:"inner"},de={key:0},re={key:1,class:"placeholder"},ce={class:"search"},ie={class:"label"},pe=["onClick"],ue={key:0,class:"empty"},me={key:0,class:"params"},fe={class:"label"},_e=z({name:"undefined"}),ve=z({..._e,name:"node-llm-form-model",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(k,{emit:P}){const g=k,{refs:$,setRefs:U,service:C}=A(),l=H(g,"modelValue"),B=K(""),f=Q({list:[],get(){C.flow.config.getByNode({node:"llm"}).then(u=>{var _,p;f.list=u.map(a=>{var y,x;const d={options:[],title:a.name,type:a.type,id:a.id,select:[],comm:(y=a.options)==null?void 0:y.comm};return(((x=a.options)==null?void 0:x.options)||[]).forEach(e=>{e.field=="model"?d.select=e.select:d.options.push(e)}),d});let o=(p=(_=l.value)==null?void 0:_.params)==null?void 0:p.model,n=f.list.find(a=>{var d;return a.select.includes(o)&&a.id==((d=l.value)==null?void 0:d.configId)});n?n.options.forEach(a=>{const d=l.value.options.find(y=>a.field==y.field);d&&(a.value=d.value,a.enable=d.enable)}):(n=f.list[0],n&&(o=n.select[0])),n&&f.select(o,n)})},select(u,o){var n,_;if(!u||!((n=l.value)!=null&&n.params))return!1;l.value.params.model=u,l.value.supplier=o.type,l.value.supplierName=o.title,l.value.configId=o.id,l.value.comm=o.comm,l.value.options=o.options.map(p=>(p.value===void 0&&p.default!==void 0&&(p.value=p.default),p)),(_=$.modelPopover)==null||_.hide()}}),L=J(()=>f.list.filter(u=>u.title.includes(B.value)));function j(){f.get()}return R(()=>{f.get(),q(()=>l.value.options,u=>{u.forEach(o=>{o.enable?l.value.params[o.field]=o.value:delete l.value.params[o.field]})},{deep:!0})}),(u,o)=>{const n=h("el-icon"),_=h("el-input"),p=h("el-scrollbar"),a=h("el-popover"),d=h("el-switch"),y=h("el-slider");return s(),b(a,{trigger:"click",teleported:!1,offset:5,"popper-class":"cl-flow__popper",width:"100%",onShow:j},{reference:v(()=>[i("div",se,[m(oe,{data:t(l)},null,8,["data"])])]),default:v(()=>{var x;return[(x=t(l))!=null&&x.params?(s(),r("div",ae,[i("div",te,[o[1]||(o[1]=i("p",{class:"title"},"模型",-1)),m(a,{ref:t(U)("modelPopover"),trigger:"click",teleported:!1,offset:5,"popper-class":"cl-flow__popper","popper-style":{padding:0},placement:"bottom-end",width:"300px"},{reference:v(()=>{var e;return[i("div",ne,[(e=t(l))!=null&&e.params.model?(s(),r("span",de,V(t(l).params.model),1)):(s(),r("span",re,"选择模型")),m(n,{class:"arrow"},{default:v(()=>[m(t(W))]),_:1})])]}),default:v(()=>[i("div",ce,[m(_,{placeholder:"搜索模型","prefix-icon":t(F),modelValue:B.value,"onUpdate:modelValue":o[0]||(o[0]=e=>B.value=e),clearable:""},null,8,["prefix-icon","modelValue"])]),m(p,{"max-height":"400px"},{default:v(()=>[(s(!0),r(N,null,I(L.value,(e,E)=>(s(),r("div",{class:"list",key:E},[i("p",ie,V(e.title),1),(s(!0),r(N,null,I(e.select,c=>{var M;return s(),r("div",{class:G(["item",{"is-check":((M=t(l).params)==null?void 0:M.model)==c&&t(l).configId==e.id}]),key:c,onClick:he=>f.select(c,e)},[i("span",null,V(c),1),m(n,{class:"check"},{default:v(()=>[m(t(T))]),_:1})],10,pe)}),128))]))),128))]),_:1}),t(S)(L.value)?(s(),r("div",ue,"未找到匹配项")):w("",!0)]),_:1},512)]),t(S)(t(l).options)?w("",!0):(s(),r("div",me,[o[2]||(o[2]=i("p",{class:"title"},"参数",-1)),(s(!0),r(N,null,I(t(l).options,(e,E)=>(s(),r("view",{class:"row",key:E},[i("span",fe,V(e.title),1),m(d,{size:"small",modelValue:e.enable,"onUpdate:modelValue":c=>e.enable=c},null,8,["modelValue","onUpdate:modelValue"]),e.type=="number"?(s(),b(y,{key:0,class:"slider",modelValue:e.value,"onUpdate:modelValue":c=>e.value=c,"show-input":"",size:"small",max:e.max||1,min:e.min||0,step:(e.max||1)/10,"show-input-controls":!1},null,8,["modelValue","onUpdate:modelValue","max","min","step"])):e.type=="string"?(s(),b(_,{key:1,class:"string",modelValue:e.value,"onUpdate:modelValue":c=>e.value=c,clearable:"",size:"small",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])):w("",!0),e.type=="boolean"?(s(),b(d,{key:2,class:"boolean",modelValue:e.value,"onUpdate:modelValue":c=>e.value=c},null,8,["modelValue","onUpdate:modelValue"])):w("",!0)]))),128))]))])):w("",!0)]}),_:1})}}}),Ce=O(ve,[["__scopeId","data-v-ea195737"]]);export{oe as M,Ce as S};
