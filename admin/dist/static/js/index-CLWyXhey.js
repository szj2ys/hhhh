import{u as F,d as O}from"./comm-Ba3vmJ1R.js";import{u as k,y as w,e as I}from"./index-BDeQYItE.js";import{C as D}from"./index-l1IOnGdE.js";import{e as N,x as V,D as P,A as $}from"./lodash-es@4.17.21-BYk7DlcU.js";import{d as q,v as K,W as M,e as T,Y as U,i as m,P as d}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{u as _}from"./vue-i18n@11.1.5_vue@3.5.16_typescript@5.5.4_-Bqjl69Su.js";import{v as j,D as A}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";import"./@vue_runtime-dom@3.5.16-DriBzn4z.js";import"./@vue_shared@3.5.16-UwmvJIHj.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import"./element-plus@2.9.11_vue@3.5.16_typescript@5.5.4_-BTKo5Rtv.js";import"./@vueuse_shared@9.13.0_vue@3.5.16_typescript@5.5.4_-4q0MSQPl.js";import"./@vueuse_core@9.13.0_vue@3.5.16_typescript@5.5.4_-DmiypGF2.js";import"./@sxzz_popperjs-es@2.11.7-D_chPuIy.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./dayjs@1.11.13-DUxgsv0d.js";import"./chardet@2.1.0-CTPPlwpv.js";import"./async-validator@4.2.5-CDKkdPIV.js";import"./memoize-one@6.0.0-BdPwpGay.js";import"./normalize-wheel-es@1.2.0-BQoi3Ox2.js";import"./@floating-ui_dom@1.7.1-Ba-2EiSn.js";import"./@floating-ui_core@1.7.1-C83JrwzW.js";import"./@floating-ui_utils@0.2.9-CBkBHzV8.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-7kYVjNRB.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-CuUdMqkw.js";import"./store@2.0.12-i6xqVJod.js";import"./mitt@3.0.1-C1z4c41a.js";import"./@codemirror_language-data@6.5.1-Blx1hvTn.js";import"./@codemirror_language@6.11.1-BYrSuhr8.js";import"./@lezer_common@1.2.3-CP7NCNqd.js";import"./@codemirror_state@6.5.2-DQ6R6BiX.js";import"./@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./@codemirror_view@6.37.1-Bd3_Yh4F.js";import"./style-mod@4.1.2-Bc2inJdb.js";import"./w3c-keyname@2.2.8-Vcq4gwWv.js";import"./@lezer_highlight@1.2.1-DwVMghhY.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.16_typescript@5.5.4_-BZ2tmr1d.js";import"./vue-router@4.5.1_vue@3.5.16_typescript@5.5.4_-ODt3CAxp.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.16_echarts@5.6.0_vue@3.5.16_typescript@5.5.4_-Dhz4IGE5.js";import"./echarts@5.6.0-DvAKqd2B.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.1-DcQm8NwP.js";import"./axios@1.9.0-D--XfsWq.js";import"./nprogress@0.2.0-dOd6e7EG.js";import"./@intlify_core-base@11.1.5-rFPZQXdu.js";import"./@intlify_shared@11.1.5-CY44FrR8.js";import"./@intlify_message-compiler@11.1.5-CZ-uatfp.js";const $e=q({name:"cl-select",props:{...D,modelValue:[String,Number,Array],options:{type:[Array,Object],default:()=>[]},prop:String,labelKey:{type:String,default:"label"},valueKey:{type:String,default:"value"},width:[String,Number],tree:Boolean,allLevelsId:Boolean,checkStrictly:Boolean,defaultExpandAll:Boolean,topLabel:String,current:Boolean,api:[String,Function],refreshOnChange:{type:Boolean,default:!0},refreshOnActivated:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(e,{emit:p,expose:x}){const{refs:v,setRefs:h}=k(),{t:y}=_(),s=F(),n=O(),b=K(()=>{var t;return!n.value||((t=n.value)==null?void 0:t.name)==="search"}),g=j(),c=M(e,"modelValue"),f=K(()=>{var l,a;let t=[];if(e.current){let o=function(r,i){var u;r.id&&r.id==((u=n.value)==null?void 0:u.getForm("id"))&&(i=!0),i&&(r.disabled=!0),r.children&&r.children.forEach(L=>{o(L,i)})};t=N(A((a=(l=s.value)==null?void 0:l["cl-table"])==null?void 0:a.data)),o({children:t},!1)}else t=A(g.value||e.options)||[];return e.topLabel?[{[e.labelKey]:e.topLabel,[e.valueKey]:0,children:t}]:t});function B(t){if(e.allLevelsId){const l=[],a=(o,r)=>{o.forEach(i=>{const u=i[e.valueKey]==t;(r||u)&&l.push(i[e.valueKey]),i.children&&a(i.children,r||u)})};return a(f.value,!1),$(l)?void 0:l}else return t===""?void 0:t}function S(t){var a;const l=B(t);p("update:modelValue",l),p("change",l),b.value&&e.prop&&e.refreshOnChange&&((a=s.value)==null||a.refresh({page:1,[e.prop]:l}))}function E(){var t,l,a,o;(t=v.select)==null||t.focus(),(o=(a=(l=v.select)==null?void 0:l.$.proxy.$el)==null?void 0:a.querySelector(".el-select__wrapper"))==null||o.click()}function C(){var l;let t=null;V(e.api)&&(t=(l=s.value)==null?void 0:l.service[e.api]()),P(e.api)&&(t=e.api()),t&&t.then(a=>{g.value=I(a)})}return T(()=>{e.api&&(C(),U(()=>{var t;e.refreshOnActivated&&(!n.value||((t=n.value)==null?void 0:t.name)=="search")&&C()}))}),x({focus:E}),()=>{const t={width:w(e.width)},l=b.value?y("全部"):y("请选择"),a=m(d("el-tree-select"),{modelValue:c.value,"onUpdate:modelValue":r=>c.value=r,clearable:!0,filterable:!0,placeholder:l,data:f.value,checkStrictly:e.allLevelsId||e.checkStrictly,defaultExpandAll:e.defaultExpandAll,props:{label:e.labelKey,value:e.valueKey},style:t,onChange:S,ref:h("select")},null),o=m(d("el-select"),{modelValue:c.value,"onUpdate:modelValue":r=>c.value=r,clearable:!0,filterable:!0,placeholder:l,style:t,onChange:S,ref:h("select")},{default:()=>{var r;return[(r=f.value)==null?void 0:r.map(i=>V(i)?m(d("el-option"),{label:i,value:i},null):m(d("el-option"),{disabled:i.disabled,label:i[e.labelKey],value:i[e.valueKey]},null))]}});return e.tree?a:o}}});export{$e as default};
