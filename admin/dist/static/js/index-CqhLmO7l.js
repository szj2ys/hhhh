import{w as _,v as A}from"./@vue_runtime-dom@3.5.16-DriBzn4z.js";import{$ as F,a0 as O,D as j,T as H}from"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import{b as K}from"./comm-Ba3vmJ1R.js";import{u as D,w as L}from"./index-BDeQYItE.js";import{a as G,g as J}from"./index-BFkfIWv_.js";import{b as Q}from"./@vueuse_core@12.8.2_typescript@5.5.4-7kYVjNRB.js";import"./store@2.0.12-i6xqVJod.js";import{d as x,P as g,V as W,c as r,o,F as I,a as n,i as u,y as v,z as w,H as b,U as R,n as X,v as T,w as Y,e as Z,a9 as ee}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{u as P,y as p}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as te}from"./element-plus@2.9.11_vue@3.5.16_typescript@5.5.4_-BTKo5Rtv.js";import{u as oe}from"./vue-i18n@11.1.5_vue@3.5.16_typescript@5.5.4_-Bqjl69Su.js";import{p as z,O as C,q as ie}from"./@vue_shared@3.5.16-UwmvJIHj.js";import"./lodash-es@4.17.21-BYk7DlcU.js";import"./mitt@3.0.1-C1z4c41a.js";import"./@codemirror_language-data@6.5.1-Blx1hvTn.js";import"./@codemirror_language@6.11.1-BYrSuhr8.js";import"./@lezer_common@1.2.3-CP7NCNqd.js";import"./@codemirror_state@6.5.2-DQ6R6BiX.js";import"./@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./@codemirror_view@6.37.1-Bd3_Yh4F.js";import"./style-mod@4.1.2-Bc2inJdb.js";import"./w3c-keyname@2.2.8-Vcq4gwWv.js";import"./@lezer_highlight@1.2.1-DwVMghhY.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.16_typescript@5.5.4_-BZ2tmr1d.js";import"./vue-router@4.5.1_vue@3.5.16_typescript@5.5.4_-ODt3CAxp.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.16_echarts@5.6.0_vue@3.5.16_typescript@5.5.4_-Dhz4IGE5.js";import"./echarts@5.6.0-DvAKqd2B.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.1-DcQm8NwP.js";import"./axios@1.9.0-D--XfsWq.js";import"./nprogress@0.2.0-dOd6e7EG.js";import"./chardet@2.1.0-CTPPlwpv.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-CuUdMqkw.js";import"./@vueuse_shared@9.13.0_vue@3.5.16_typescript@5.5.4_-4q0MSQPl.js";import"./@vueuse_core@9.13.0_vue@3.5.16_typescript@5.5.4_-DmiypGF2.js";import"./@sxzz_popperjs-es@2.11.7-D_chPuIy.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./dayjs@1.11.13-DUxgsv0d.js";import"./async-validator@4.2.5-CDKkdPIV.js";import"./memoize-one@6.0.0-BdPwpGay.js";import"./normalize-wheel-es@1.2.0-BQoi3Ox2.js";import"./@floating-ui_dom@1.7.1-Ba-2EiSn.js";import"./@floating-ui_core@1.7.1-C83JrwzW.js";import"./@floating-ui_utils@0.2.9-CBkBHzV8.js";import"./@intlify_core-base@11.1.5-rFPZQXdu.js";import"./@intlify_shared@11.1.5-CY44FrR8.js";import"./@intlify_message-compiler@11.1.5-CZ-uatfp.js";const se={class:"viewer-image"},ae={class:"viewer-doc"},le=["src"],re=x({name:"undefined"}),ne=x({...re,name:"file-viewer",setup(e,{expose:$}){const{refs:i,setRefs:M}=D(),c=P({visible:!1,url:""}),a=P({visible:!1,loading:!1,url:""});function V(l){if(l!=null&&l.type){const m=l.url||"",f=G(m);if(f=="image")return c.visible=!0,c.url=m,!0;if(["word","excel","ppt","pdf"].includes(f))return a.visible=!0,a.loading=!0,a.url=`https://view.officeapps.live.com/op/view.aspx?src=${decodeURIComponent(m)}`,X(()=>{i.docIframe.onload=()=>{a.loading=!1}}),!0;window.open(l.url)}}function y(){c.visible=!1}return $({open:V}),(l,m)=>{const f=g("el-image-viewer"),k=g("cl-dialog"),B=W("loading");return o(),r(I,null,[n("div",se,[c.visible?(o(),v(f,{key:0,"url-list":[c.url],infinite:"",teleported:"",onClose:y},null,8,["url-list"])):w("",!0)]),u(k,{modelValue:a.visible,"onUpdate:modelValue":m[0]||(m[0]=d=>a.visible=d),title:l.$t("文档预览"),height:"70vh",width:"80%",scrollbar:!1},{default:b(()=>[R((o(),r("div",ae,[n("iframe",{ref:p(M)("docIframe"),src:a.url},null,8,le)])),[[B,a.loading]])]),_:1},8,["modelValue","title"])],64)}}}),me=U(ne,[["__scopeId","data-v-ceba9158"]]),ce={class:"cl-upload-item__wrap"},de=["src"],ue={class:"cl-upload-item__icon"},pe={class:"cl-upload-item__name"},fe=["src"],ve={class:"cl-upload-item__progress-bar"},ge={class:"cl-upload-item__progress-value"},ye={key:5,class:"cl-upload-item__actions"},_e=x({name:"undefined"}),we=x({..._e,name:"cl-upload-item",props:{item:{type:Object,required:!0},list:{type:Array,default:()=>[]},disabled:Boolean,deletable:Boolean,showTag:{type:Boolean,default:!0}},emits:["remove"],setup(e,{emit:$}){const i=e,M=$,{refs:c,setRefs:a}=D(),{copy:V}=Q(),{t:y}=oe(),l=T(()=>i.item.url||""),m=T(()=>({color:J(i.item.type).color,name:L(i.item.name||l.value)}));function f(){M("remove",i.item)}function k(){c.viewer.open(i.item)}function B(t){K.open(t,{hover:{target:"cl-upload-item__wrap"},list:[{label:y("预览"),callback(s){k(),s()}},{label:y("复制链接"),callback(s){i.item.url&&(V(i.item.url),te.success("复制成功")),s()}},{label:y("删除"),callback(s){f(),s()}}]})}const d=P({isMedia:["video","audio"].includes(i.item.type),play(){i.list.forEach(t=>{t.isPlay=t.uid?i.item.uid==t.uid:i.item.id==t.id})},pause(){i.item.isPlay=!1},create(){if(!d.isMedia)return!1;let t;Y(()=>i.item.isPlay,s=>{t||(t=c[i.item.type],t==null||t.addEventListener("ended",()=>{d.pause()})),s?t==null||t.play():t==null||t.pause()})}});return Z(()=>{d.create()}),(t,s)=>{const N=g("el-image"),S=g("cl-svg"),q=g("el-progress"),h=g("el-icon");return o(),r("div",ce,[(o(),v(ee,null,[n("div",{class:z(["cl-upload-item",[{"is-play":e.item.isPlay}]]),onContextmenu:_(B,["stop","prevent"])},[e.item.type==="image"&&!e.item.error?(o(),v(N,{key:0,class:"cl-upload-item__image-cover",fit:"contain",src:e.item.preload||l.value,onError:s[0]||(s[0]=E=>e.item.error=t.$t("加载失败"))},null,8,["src"])):e.item.type==="video"?(o(),r("video",{ref:p(a)("video"),key:e.item.url,src:e.item.url},null,8,de)):(o(),r(I,{key:2},[n("div",ue,[u(S,{name:"upload-"+e.item.type},null,8,["name"])]),n("div",pe,[n("span",null,C(e.item.name||l.value),1),R(n("span",{class:"error"},C(e.item.error),513),[[A,e.item.error]])])],64)),e.item.type==="audio"?(o(),r("audio",{key:3,ref:p(a)("audio"),controls:""},[(o(),r("source",{key:e.item.url,src:e.item.url,type:"audio/mpeg"},null,8,fe))],512)):w("",!0),n("div",{class:z(["cl-upload-item__progress",{"is-show":e.item.progress>=0&&e.item.progress<100,"is-hide":e.item.progress==100}])},[n("div",ve,[u(q,{percentage:e.item.progress,"show-text":!1},null,8,["percentage"])]),n("span",ge,C(e.item.progress),1)],2),e.showTag?(o(),r("span",{key:4,class:"cl-upload-item__tag",style:ie({backgroundColor:m.value.color})},C(m.value.name),5)):w("",!0),l.value?(o(),r("div",ye,[d.isMedia?(o(),r(I,{key:0},[e.item.isPlay?(o(),v(h,{key:0,class:"action-pause",onClick:s[1]||(s[1]=_(E=>d.pause(),["stop"]))},{default:b(()=>[u(p(F))]),_:1})):(o(),v(h,{key:1,class:"action-play",onClick:s[2]||(s[2]=_(E=>d.play(),["stop"]))},{default:b(()=>[u(p(O))]),_:1}))],64)):(o(),v(h,{key:1,class:"action-preview",onClick:_(k,["stop"])},{default:b(()=>[u(p(j))]),_:1})),!e.disabled||e.deletable?(o(),v(h,{key:2,class:"action-delete",onClick:_(f,["stop"])},{default:b(()=>[u(p(H))]),_:1})):w("",!0)])):w("",!0)],34)],1024)),u(me,{ref:p(a)("viewer")},null,512)])}}}),ft=U(we,[["__scopeId","data-v-db8dbed7"]]);export{ft as default};
