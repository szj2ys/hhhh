import{S as j,C as S,j as T,k as M,l as I,m as L,n as B,W as A,o as U,E as D,p as G,F as V,O as z,q as _,M as F,r as N,P as W,s as H,t as $,V as Q,f as X}from"./three@0.175.0-DVJ6AaYR.js";import{p as q,c as Y}from"./polished@4.3.1-3tv_O2IJ.js";import{G as K,T as x,E as k}from"./@tweenjs_tween.js@25.0.0-nuASKez8.js";import{i as J}from"./accessor-fn@1.5.3-Dh2lNxUP.js";import{i as Z}from"./kapsule@1.16.3-C41LLEgf.js";import{i as ee}from"./float-tooltip@1.7.5-nMUy4Ccf.js";function re(n,e){e===void 0&&(e={});var r=e.insertAt;if(!(typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",r==="top"&&o.firstChild?o.insertBefore(t,o.firstChild):o.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}}var ne=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;re(ne);function C(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,o=Array(e);r<e;r++)o[r]=n[r];return o}function oe(n){if(Array.isArray(n))return n}function ie(n){if(Array.isArray(n))return C(n)}function te(n,e,r){return(e=fe(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function ae(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function ce(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var o,t,i,a,s=[],d=!0,p=!1;try{if(i=(r=r.call(n)).next,e!==0)for(;!(d=(o=i.call(r)).done)&&(s.push(o.value),s.length!==e);d=!0);}catch(m){p=!0,t=m}finally{try{if(!d&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(p)throw t}}return s}}function le(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function se(n,e){return oe(n)||ce(n,e)||R(n,e)||le()}function v(n){return ie(n)||ae(n)||R(n)||ue()}function de(n,e){if(typeof n!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var o=r.call(n,e);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function fe(n){var e=de(n,"string");return typeof e=="symbol"?e:e+""}function R(n,e){if(n){if(typeof n=="string")return C(n,e);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(n,e):void 0}}var u=window.THREE?window.THREE:{WebGLRenderer:U,Scene:H,PerspectiveCamera:W,Raycaster:$,SRGBColorSpace:M,TextureLoader:T,Vector2:B,Vector3:Q,Box3:X,Color:S,Mesh:F,SphereGeometry:j,MeshBasicMaterial:I,BackSide:L,Clock:N},be=Z({props:{width:{default:window.innerWidth,onChange:function(e,r,o){isNaN(e)&&(r.width=o)}},height:{default:window.innerHeight,onChange:function(e,r,o){isNaN(e)&&(r.height=o)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,r){r.hoverObj=null,r.tooltip&&r.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(a){return a.render(e.scene,e.camera)});var r=+new Date;if(e.enablePointerInteraction&&r-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=r;var o=null;if(e.hoverDuringDrag||!e.isPointerDragging){var t=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&t.sort(function(a,s){return e.hoverOrderComparator(a.object,s.object)});var i=t.find(function(a){return e.hoverFilter(a.object)})||null;o=i?i.object:null,e.intersection=i||null}o!==e.hoverObj&&(e.onHover(o,e.hoverObj,e.intersection),e.tooltip.content(o&&J(e.tooltipContent)(o,e.intersection)||null),e.hoverObj=o)}e.tweenGroup.update()}return this},getPointerPos:function(e){var r=e.pointerPos,o=r.x,t=r.y;return{x:o,y:t}},cameraPosition:function(e,r,o,t){var i=e.camera;if(r&&e.initialised){var a=r,s=o||{x:0,y:0,z:0};if(!t)m(a),g(s);else{var d=Object.assign({},i.position),p=h();e.tweenGroup.add(new x(d).to(a,t).easing(k.Quadratic.Out).onUpdate(m).start()),e.tweenGroup.add(new x(p).to(s,t/3).easing(k.Quadratic.Out).onUpdate(g).start())}return this}return Object.assign({},i.position,{lookAt:h()});function m(c){var l=c.x,f=c.y,y=c.z;l!==void 0&&(i.position.x=l),f!==void 0&&(i.position.y=f),y!==void 0&&(i.position.z=y)}function g(c){var l=new u.Vector3(c.x,c.y,c.z);e.controls.target?e.controls.target=l:i.lookAt(l)}function h(){return Object.assign(new u.Vector3(0,0,-1e3).applyQuaternion(i.quaternion).add(i.position))}},zoomToFit:function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,t=arguments.length,i=new Array(t>3?t-3:0),a=3;a<t;a++)i[a-3]=arguments[a];return this.fitToBbox(this.getBbox.apply(this,i),r,o)},fitToBbox:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,i=e.camera;if(r){var a=new u.Vector3(0,0,0),s=Math.max.apply(Math,v(Object.entries(r).map(function(c){var l=se(c,2),f=l[0],y=l[1];return Math.max.apply(Math,v(y.map(function(b){return Math.abs(a[f]-b)})))})))*2,d=(1-t*2/e.height)*i.fov,p=s/Math.atan(d*Math.PI/180),m=p/i.aspect,g=Math.max(p,m);if(g>0){var h=a.clone().sub(i.position).normalize().multiplyScalar(-g);this.cameraPosition(h,a,o)}}return this},getBbox:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},o=new u.Box3(new u.Vector3(0,0,0),new u.Vector3(0,0,0)),t=e.objects.filter(r);return t.length?(t.forEach(function(i){return o.expandByObject(i)}),Object.assign.apply(Object,v(["x","y","z"].map(function(i){return te({},i,[o.min[i],o.max[i]])})))):null},getScreenCoords:function(e,r,o,t){var i=new u.Vector3(r,o,t);return i.project(this.camera()),{x:(i.x+1)*e.width/2,y:-(i.y-1)*e.height/2}},getSceneCoords:function(e,r,o){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=new u.Vector2(r/e.width*2-1,-(o/e.height)*2+1),a=new u.Raycaster;return a.setFromCamera(i,e.camera),Object.assign({},a.ray.at(t,new u.Vector3))},intersectingObjects:function(e,r,o){var t=new u.Vector2(r/e.width*2-1,-(o/e.height)*2+1),i=new u.Raycaster;return i.params.Line.threshold=e.lineHoverPrecision,i.params.Points.threshold=e.pointsHoverPrecision,i.setFromCamera(t,e.camera),i.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new u.Scene,camera:new u.PerspectiveCamera,clock:new u.Clock,tweenGroup:new K,lastRaycasterCheck:0}},init:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=o.controlType,i=t===void 0?"trackball":t,a=o.useWebGPU,s=a===void 0?!1:a,d=o.rendererConfig,p=d===void 0?{}:d,m=o.extraRenderers,g=m===void 0?[]:m,h=o.waitForLoadComplete,c=h===void 0?!0:h;e.innerHTML="",e.appendChild(r.container=document.createElement("div")),r.container.className="scene-container",r.container.style.position="relative",r.container.appendChild(r.navInfo=document.createElement("div")),r.navInfo.className="scene-nav-info",r.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[i]||"",r.navInfo.style.display=r.showNavInfo?null:"none",r.tooltip=new ee(r.container),r.pointerPos=new u.Vector2,r.pointerPos.x=-2,r.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(l){return r.container.addEventListener(l,function(f){if(l==="pointerdown"&&(r.isPointerPressed=!0),!r.isPointerDragging&&f.type==="pointermove"&&(f.pressure>0||r.isPointerPressed)&&(f.pointerType!=="touch"||f.movementX===void 0||[f.movementX,f.movementY].some(function(w){return Math.abs(w)>1}))&&(r.isPointerDragging=!0),r.enablePointerInteraction){var y=b(r.container);r.pointerPos.x=f.pageX-y.left,r.pointerPos.y=f.pageY-y.top}function b(w){var P=w.getBoundingClientRect(),O=window.pageXOffset||document.documentElement.scrollLeft,E=window.pageYOffset||document.documentElement.scrollTop;return{top:P.top+E,left:P.left+O}}},{passive:!0})}),r.container.addEventListener("pointerup",function(l){r.isPointerPressed&&(r.isPointerPressed=!1,!(r.isPointerDragging&&(r.isPointerDragging=!1,!r.clickAfterDrag))&&requestAnimationFrame(function(){l.button===0&&r.onClick(r.hoverObj||null,l,r.intersection),l.button===2&&r.onRightClick&&r.onRightClick(r.hoverObj||null,l,r.intersection)}))},{passive:!0,capture:!0}),r.container.addEventListener("contextmenu",function(l){r.onRightClick&&l.preventDefault()}),r.renderer=new(s?A:u.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},p)),r.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),r.container.appendChild(r.renderer.domElement),r.extraRenderers=g,r.extraRenderers.forEach(function(l){l.domElement.style.position="absolute",l.domElement.style.top="0px",l.domElement.style.pointerEvents="none",r.container.appendChild(l.domElement)}),r.postProcessingComposer=new D(r.renderer),r.postProcessingComposer.addPass(new G(r.scene,r.camera)),r.controls=new{trackball:_,orbit:z,fly:V}[i](r.camera,r.renderer.domElement),i==="fly"&&(r.controls.movementSpeed=300,r.controls.rollSpeed=Math.PI/6,r.controls.dragToLook=!0),(i==="trackball"||i==="orbit")&&(r.controls.minDistance=.1,r.controls.maxDistance=r.skyRadius,r.controls.addEventListener("start",function(){r.controlsEngaged=!0}),r.controls.addEventListener("change",function(){r.controlsEngaged&&(r.controlsDragging=!0)}),r.controls.addEventListener("end",function(){r.controlsEngaged=!1,r.controlsDragging=!1})),[r.renderer,r.postProcessingComposer].concat(v(r.extraRenderers)).forEach(function(l){return l.setSize(r.width,r.height)}),r.camera.aspect=r.width/r.height,r.camera.updateProjectionMatrix(),r.camera.position.z=1e3,r.scene.add(r.skysphere=new u.Mesh),r.skysphere.visible=!1,r.loadComplete=r.scene.visible=!c,window.scene=r.scene},update:function(e,r){if(e.width&&e.height&&(r.hasOwnProperty("width")||r.hasOwnProperty("height"))){var o,t=e.width,i=e.height;e.container.style.width="".concat(t,"px"),e.container.style.height="".concat(i,"px"),[e.renderer,e.postProcessingComposer].concat(v(e.extraRenderers)).forEach(function(c){return c.setSize(t,i)}),e.camera.aspect=t/i;var a=e.viewOffset.slice(0,2);a.some(function(c){return c})&&(o=e.camera).setViewOffset.apply(o,[t,i].concat(v(a),[t,i])),e.camera.updateProjectionMatrix()}if(r.hasOwnProperty("viewOffset")){var s,d=e.width,p=e.height,m=e.viewOffset.slice(0,2);m.some(function(c){return c})?(s=e.camera).setViewOffset.apply(s,[d,p].concat(v(m),[d,p])):e.camera.clearViewOffset()}if(r.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&r.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new u.SphereGeometry(e.skyRadius)),r.hasOwnProperty("backgroundColor")){var g=q(e.backgroundColor).alpha;g===void 0&&(g=1),e.renderer.setClearColor(new u.Color(Y(1,e.backgroundColor)),g)}r.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new u.TextureLoader().load(e.backgroundImageUrl,function(c){c.colorSpace=u.SRGBColorSpace,e.skysphere.material=new u.MeshBasicMaterial({map:c,side:u.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&h()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&h())),r.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),r.hasOwnProperty("lights")&&((r.lights||[]).forEach(function(c){return e.scene.remove(c)}),e.lights.forEach(function(c){return e.scene.add(c)})),r.hasOwnProperty("objects")&&((r.objects||[]).forEach(function(c){return e.scene.remove(c)}),e.objects.forEach(function(c){return e.scene.add(c)}));function h(){e.loadComplete=e.scene.visible=!0}}});export{be as t};
