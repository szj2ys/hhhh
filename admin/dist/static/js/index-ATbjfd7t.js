import{a as H}from"./@vue_runtime-dom@3.5.16-DriBzn4z.js";import{_ as N}from"./logo-CxXS7KxG.js";import{u as I,a as D,s as x}from"./index-C5WS2hJt.js";import{n as K}from"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import"./store@2.0.12-i6xqVJod.js";import{b as w,a as C}from"./element-plus@2.9.11_vue@3.5.16_typescript@5.5.4_-BTKo5Rtv.js";import{d as v,e as z,P as d,c as _,o as u,y as J,H as m,i as s,a as r,J as O}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{u as M}from"./vue-i18n@11.1.5_vue@3.5.16_typescript@5.5.4_-Bqjl69Su.js";import{v as $,y as k,u as R}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{O as B}from"./@vue_shared@3.5.16-UwmvJIHj.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-7kYVjNRB.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-CuUdMqkw.js";import"./lodash-es@4.17.21-BYk7DlcU.js";import"./mitt@3.0.1-C1z4c41a.js";import"./@codemirror_language-data@6.5.1-Blx1hvTn.js";import"./@codemirror_language@6.11.1-BYrSuhr8.js";import"./@lezer_common@1.2.3-CP7NCNqd.js";import"./@codemirror_state@6.5.2-DQ6R6BiX.js";import"./@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./@codemirror_view@6.37.1-Bd3_Yh4F.js";import"./style-mod@4.1.2-Bc2inJdb.js";import"./w3c-keyname@2.2.8-Vcq4gwWv.js";import"./@lezer_highlight@1.2.1-DwVMghhY.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.16_typescript@5.5.4_-BZ2tmr1d.js";import"./vue-router@4.5.1_vue@3.5.16_typescript@5.5.4_-ODt3CAxp.js";import"./comm-Ba3vmJ1R.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.16_echarts@5.6.0_vue@3.5.16_typescript@5.5.4_-Dhz4IGE5.js";import"./echarts@5.6.0-DvAKqd2B.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.1-DcQm8NwP.js";import"./axios@1.9.0-D--XfsWq.js";import"./nprogress@0.2.0-dOd6e7EG.js";import"./chardet@2.1.0-CTPPlwpv.js";import"./@vueuse_shared@9.13.0_vue@3.5.16_typescript@5.5.4_-4q0MSQPl.js";import"./@vueuse_core@9.13.0_vue@3.5.16_typescript@5.5.4_-DmiypGF2.js";import"./@sxzz_popperjs-es@2.11.7-D_chPuIy.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./dayjs@1.11.13-DUxgsv0d.js";import"./async-validator@4.2.5-CDKkdPIV.js";import"./memoize-one@6.0.0-BdPwpGay.js";import"./normalize-wheel-es@1.2.0-BQoi3Ox2.js";import"./@floating-ui_dom@1.7.1-Ba-2EiSn.js";import"./@floating-ui_core@1.7.1-C83JrwzW.js";import"./@floating-ui_utils@0.2.9-CBkBHzV8.js";import"./@intlify_core-base@11.1.5-rFPZQXdu.js";import"./@intlify_shared@11.1.5-CY44FrR8.js";import"./@intlify_message-compiler@11.1.5-CZ-uatfp.js";const S=["innerHTML"],j=["src"],q=v({name:"undefined"}),A=v({...q,name:"pic-captcha",emits:["update:modelValue","change"],setup(L,{expose:g,emit:h}){const f=h,{service:y}=I(),{t:c}=M(),l=$(""),a=$("");async function i(){a.value="",l.value="",await y.base.open.captcha({height:45,width:150,color:"#2c3142"}).then(({captchaId:e,data:n})=>{n?(n.includes(";base64,")?l.value=n:a.value=n,f("update:modelValue",e),f("change",{base64:l,svg:a,captchaId:e})):w.alert(c("验证码获取失败"),{title:c("提示"),type:"error"})}).catch(e=>{w.alert(e.message,{title:c("提示"),type:"error"})})}return z(()=>{i()}),g({refresh:i}),(e,n)=>{const t=d("el-icon");return u(),_("div",{class:"pic-captcha",onClick:i},[a.value?(u(),_("div",{key:0,class:"svg",innerHTML:a.value},null,8,S)):l.value?(u(),_("img",{key:1,class:"base64",src:l.value,alt:""},null,8,j)):(u(),J(t,{key:2,class:"is-loading",size:18},{default:m(()=>[s(k(K))]),_:1}))])}}}),F=T(A,[["__scopeId","data-v-99da335b"]]),G={class:"page-login"},Q={class:"box"},W={class:"logo"},X={class:"form"},Y={class:"op"},Z={class:"bg"},ee=v({name:"undefined"}),oe=v({...ee,name:"login",setup(L){const{refs:g,setRefs:h,router:f,service:y}=I(),{user:c,app:l}=D(),{t:a}=M(),i=$(!1),e=R({username:x.get("username")||"",password:"",captchaId:"",verifyCode:""});async function n(){if(!e.username)return C.error(a("用户名不能为空"));if(!e.password)return C.error(a("密码不能为空"));if(!e.verifyCode)return C.error(a("图片验证码不能为空"));i.value=!0;try{await y.base.open.login(e).then(c.setToken),await Promise.all(l.events.hasToken.map(t=>t())),x.set("username",e.username),f.push("/")}catch(t){g.picCaptcha.refresh(),w.alert(t.message,{title:a("提示"),type:"error"})}i.value=!1}return(t,o)=>{const b=d("el-input"),V=d("el-form-item"),P=d("el-button"),U=d("el-form"),E=d("cl-svg");return u(),_("div",G,[r("div",Q,[r("div",W,[o[5]||(o[5]=r("div",{class:"icon"},[r("img",{src:N,alt:"Logo"})],-1)),r("span",null,B(k(l).info.name),1)]),r("div",X,[s(U,{"label-position":"top",class:"form",disabled:i.value},{default:m(()=>[s(V,{label:t.$t("用户名")},{default:m(()=>[s(b,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=p=>e.username=p),placeholder:t.$t("请输入用户名"),maxlength:"20"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(V,{label:t.$t("密码")},{default:m(()=>[s(b,{modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=p=>e.password=p),type:"password",placeholder:t.$t("请输入密码"),maxlength:"20","show-password":"",autocomplete:"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(V,{label:t.$t("验证码")},{default:m(()=>[s(b,{modelValue:e.verifyCode,"onUpdate:modelValue":o[4]||(o[4]=p=>e.verifyCode=p),placeholder:t.$t("验证码"),maxlength:"4",onKeyup:H(n,["enter"])},{suffix:m(()=>[s(F,{ref:k(h)("picCaptcha"),modelValue:e.captchaId,"onUpdate:modelValue":o[2]||(o[2]=p=>e.captchaId=p),onChange:o[3]||(o[3]=()=>{e.verifyCode=""})},null,8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r("div",Y,[s(P,{type:"primary",loading:i.value,onClick:n},{default:m(()=>[O(B(t.$t("登录")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled"])])]),r("div",Z,[s(E,{name:"bg"})]),o[6]||(o[6]=r("a",{href:"",class:"copyright"}," Copyright © 厦钨IPD ",-1))])}}}),We=T(oe,[["__scopeId","data-v-40d3f684"]]);export{We as default};
