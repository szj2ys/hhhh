import{u as g,p as l}from"./index-BDeQYItE.js";import"./store@2.0.12-i6xqVJod.js";import{A as w,u as y}from"./dev-DhcUcz92.js";import{b as T}from"./element-plus@2.9.11_vue@3.5.16_typescript@5.5.4_-BTKo5Rtv.js";import{M as m}from"./lodash-es@4.17.21-BYk7DlcU.js";import{d as u,c as k,o as M,a as n,i as P,F as B}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{u as N}from"./vue-i18n@11.1.5_vue@3.5.16_typescript@5.5.4_-Bqjl69Su.js";import{u as D,y as F}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";import{O as I,p as O}from"./@vue_shared@3.5.16-UwmvJIHj.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./@vue_runtime-dom@3.5.16-DriBzn4z.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-7kYVjNRB.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-CuUdMqkw.js";import"./mitt@3.0.1-C1z4c41a.js";import"./@codemirror_language-data@6.5.1-Blx1hvTn.js";import"./@codemirror_language@6.11.1-BYrSuhr8.js";import"./@lezer_common@1.2.3-CP7NCNqd.js";import"./@codemirror_state@6.5.2-DQ6R6BiX.js";import"./@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./@codemirror_view@6.37.1-Bd3_Yh4F.js";import"./style-mod@4.1.2-Bc2inJdb.js";import"./w3c-keyname@2.2.8-Vcq4gwWv.js";import"./@lezer_highlight@1.2.1-DwVMghhY.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.16_typescript@5.5.4_-BZ2tmr1d.js";import"./vue-router@4.5.1_vue@3.5.16_typescript@5.5.4_-ODt3CAxp.js";import"./comm-Ba3vmJ1R.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.16_echarts@5.6.0_vue@3.5.16_typescript@5.5.4_-Dhz4IGE5.js";import"./echarts@5.6.0-DvAKqd2B.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.1-DcQm8NwP.js";import"./axios@1.9.0-D--XfsWq.js";import"./nprogress@0.2.0-dOd6e7EG.js";import"./chardet@2.1.0-CTPPlwpv.js";import"./@vueuse_shared@9.13.0_vue@3.5.16_typescript@5.5.4_-4q0MSQPl.js";import"./@vueuse_core@9.13.0_vue@3.5.16_typescript@5.5.4_-DmiypGF2.js";import"./@sxzz_popperjs-es@2.11.7-D_chPuIy.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./dayjs@1.11.13-DUxgsv0d.js";import"./async-validator@4.2.5-CDKkdPIV.js";import"./memoize-one@6.0.0-BdPwpGay.js";import"./normalize-wheel-es@1.2.0-BQoi3Ox2.js";import"./@floating-ui_dom@1.7.1-Ba-2EiSn.js";import"./@floating-ui_core@1.7.1-C83JrwzW.js";import"./@floating-ui_utils@0.2.9-CBkBHzV8.js";import"./@intlify_core-base@11.1.5-rFPZQXdu.js";import"./@intlify_shared@11.1.5-CY44FrR8.js";import"./@intlify_message-compiler@11.1.5-CZ-uatfp.js";const V={class:"loader__text"},q=u({name:"undefined"}),z=u({...q,setup(A){const{router:d,service:a,refs:f,setRefs:_}=g(),p=y(),{t:r}=N(),t=D({visible:!1,text:"",setText(i){t.text=i},open(){t.visible=!0},close(){t.visible=!1}});function v(){T.confirm(r("确定要退出编码吗？"),r("提示")).then(()=>{d.replace("/")}).catch(()=>{})}async function x({name:i,data:o}){i==="aiCode.create"&&(t.open(),await Promise.all(o.menu.map(async e=>{e.type==0&&e.router&&(await p.del(e.router),t.setText(r("创建目录：{name}",{name:e.name})),await a.base.sys.menu.add(e).then(async C=>{const b=o.menu.map(s=>{var c;if(s.router&&((c=s.router)==null?void 0:c.indexOf(e.router+"/"))>=0)return t.setText(r("创建菜单：{name}",{name:s.name})),p.create({...s,parentId:C.id,module:e.router.replace("/",""),prefix:s.router.slice(1)})});await Promise.all(b)}))})),l.serviceLang=="Java"&&(t.setText(r("创建 Java 文件")),await a.base.coding.createCode({codes:o.files.filter(e=>m(e.path,"java"))})),l.serviceLang=="Node"&&(t.setText(r("创建 Node 文件")),await a.base.coding.createCode({codes:o.files.filter(e=>m(e.path,"node")).map(e=>({path:e.path.replace(/^node\//,"src/modules/"),content:e.content}))})),t.setText(r("正在重启服务")),await h(),t.setText(r("创建 Vue 文件")),await Promise.all(o.files.map(e=>{if(m(e.path,"vue"))return a.request({url:"/__cool_createFile",method:"POST",proxy:!1,data:{path:e.path.replace(/^vue\//,"modules/"),code:e.content}})})),t.close(),location.reload()),i==="aiCode.loaded"&&a.base.coding.getModuleTree().then(e=>{f.aiCode.send("aiCode.setDir",e)})}async function h(){return new Promise(i=>{const o=()=>{setTimeout(()=>{a.base.open.eps().then(()=>{i(1)}).catch(()=>{o()})},3e3)};o()})}return(i,o)=>(M(),k(B,null,[n("div",{class:"back",onClick:v},o[0]||(o[0]=[n("i",{class:"iconfont icon-zuo"},null,-1)])),n("div",{class:O(["loader",{"is-show":t.visible}])},[o[1]||(o[1]=n("div",{class:"preload__loading"},null,-1)),n("p",V,I(t.text),1)],2),P(w,{path:"/ai/code",ref:F(_)("aiCode"),onMessage:x},null,512)],64))}}),Oe=S(z,[["__scopeId","data-v-f09aedac"]]);export{Oe as default};
