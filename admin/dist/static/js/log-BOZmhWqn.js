import{u as D}from"./index-BDeQYItE.js";import"./store@2.0.12-i6xqVJod.js";import{u as M,c as $}from"./comm-Ba3vmJ1R.js";import{a as s,b as B}from"./element-plus@2.9.11_vue@3.5.16_typescript@5.5.4_-BTKo5Rtv.js";import{d,e as I,P as t,V as N,y as u,o as _,H as n,i as o,U as E,J as K}from"./@vue_runtime-core@3.5.16-Cn8z-kNe.js";import{u as O}from"./vue-i18n@11.1.5_vue@3.5.16_typescript@5.5.4_-Bqjl69Su.js";import{v as U,y as j}from"./@vue_reactivity@3.5.16-Dqy0TPbS.js";import{O as H}from"./@vue_shared@3.5.16-UwmvJIHj.js";import"./@vue_runtime-dom@3.5.16-DriBzn4z.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-7kYVjNRB.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-CuUdMqkw.js";import"./lodash-es@4.17.21-BYk7DlcU.js";import"./mitt@3.0.1-C1z4c41a.js";import"./@codemirror_language-data@6.5.1-Blx1hvTn.js";import"./@codemirror_language@6.11.1-BYrSuhr8.js";import"./@lezer_common@1.2.3-CP7NCNqd.js";import"./@codemirror_state@6.5.2-DQ6R6BiX.js";import"./@marijn_find-cluster-break@1.0.2-DXwl3gUT.js";import"./@codemirror_view@6.37.1-Bd3_Yh4F.js";import"./style-mod@4.1.2-Bc2inJdb.js";import"./w3c-keyname@2.2.8-Vcq4gwWv.js";import"./@lezer_highlight@1.2.1-DwVMghhY.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.16_typescript@5.5.4_-BZ2tmr1d.js";import"./vue-router@4.5.1_vue@3.5.16_typescript@5.5.4_-ODt3CAxp.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.16_echarts@5.6.0_vue@3.5.16_typescript@5.5.4_-Dhz4IGE5.js";import"./echarts@5.6.0-DvAKqd2B.js";import"./tslib@2.3.0-BDyQ-Jie.js";import"./zrender@5.6.1-DcQm8NwP.js";import"./axios@1.9.0-D--XfsWq.js";import"./nprogress@0.2.0-dOd6e7EG.js";import"./chardet@2.1.0-CTPPlwpv.js";import"./@vueuse_shared@9.13.0_vue@3.5.16_typescript@5.5.4_-4q0MSQPl.js";import"./@vueuse_core@9.13.0_vue@3.5.16_typescript@5.5.4_-DmiypGF2.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.16_typescript@5.5.4_-CeLFb4Nw.js";import"./@sxzz_popperjs-es@2.11.7-D_chPuIy.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./dayjs@1.11.13-DUxgsv0d.js";import"./async-validator@4.2.5-CDKkdPIV.js";import"./memoize-one@6.0.0-BdPwpGay.js";import"./normalize-wheel-es@1.2.0-BQoi3Ox2.js";import"./@floating-ui_dom@1.7.1-Ba-2EiSn.js";import"./@floating-ui_core@1.7.1-C83JrwzW.js";import"./@floating-ui_utils@0.2.9-CBkBHzV8.js";import"./@intlify_core-base@11.1.5-rFPZQXdu.js";import"./@intlify_shared@11.1.5-CY44FrR8.js";import"./@intlify_message-compiler@11.1.5-CZ-uatfp.js";const J=d({name:"undefined"}),Ee=d({...J,name:"sys-log",setup(P){const{service:l}=D(),{t:r}=O(),i=U(1),a=M({service:l.base.sys.log},e=>{e.refresh()}),f=$({contextMenu:["refresh"],columns:[{type:"index",label:"#",width:60},{prop:"userId",label:r("用户ID"),minWidth:100},{prop:"name",label:r("用户昵称"),minWidth:120},{prop:"action",label:r("请求地址"),minWidth:200,showOverflowTooltip:!0},{prop:"params",label:r("参数"),minWidth:200,component:{name:"cl-code-json",props:{popover:!0}}},{prop:"ip",label:"ip",minWidth:150,dict:[],dictColor:!0,formatter(e){return e.ip.split(",")}},{prop:"createTime",label:r("请求时间"),minWidth:170,sortable:"desc"}]});function b(){l.base.sys.log.setKeep({value:i.value}).then(()=>{s.success(r("保存成功"))}).catch(e=>{s.error(e.message)})}function h(){B.confirm(r("是否要清空日志？"),r("提示"),{type:"warning"}).then(()=>{l.base.sys.log.clear().then(()=>{var e;s.success(r("清空成功")),(e=a.value)==null||e.refresh()}).catch(e=>{s.error(e.message)})}).catch(()=>null)}return I(()=>{l.base.sys.log.getKeep().then(e=>{i.value=Number(e)})}),(e,m)=>{const g=t("cl-refresh-btn"),y=t("el-button"),v=t("el-input-number"),C=t("cl-filter"),c=t("cl-flex1"),w=t("cl-search-key"),p=t("cl-row"),k=t("cl-table"),x=t("cl-pagination"),T=t("cl-crud"),V=N("permission");return _(),u(T,{ref_key:"Crud",ref:a},{default:n(()=>[o(p,null,{default:n(()=>[o(g),E((_(),u(y,{type:"danger",onClick:h},{default:n(()=>[K(H(e.$t("清空")),1)]),_:1})),[[V,j(l).base.sys.log.permission.clear]]),o(C,{label:e.$t("日志保存天数")},{default:n(()=>[o(v,{modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=W=>i.value=W),"controls-position":"right",max:1e4,min:1,onChange:b},null,8,["modelValue"])]),_:1},8,["label"]),o(c),o(w,{placeholder:e.$t("搜索请求地址、用户昵称、ip")},null,8,["placeholder"])]),_:1}),o(p,null,{default:n(()=>[o(k,{ref_key:"Table",ref:f},null,512)]),_:1}),o(p,null,{default:n(()=>[o(c),o(x)]),_:1})]),_:1},512)}}});export{Ee as default};
